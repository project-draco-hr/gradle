{
  Clock clock=new Clock();
  Map<String,TestClassResult> results=testResultsProvider.getResults();
  for (  Map.Entry<String,TestClassResult> entry : results.entrySet()) {
    String className=entry.getKey();
    TestClassResult result=entry.getValue();
    File file=new File(testResultsDir,"TEST-" + className + ".xml");
    OutputStream output=null;
    try {
      output=new BufferedOutputStream(new FileOutputStream(file));
      saxWriter.write(className,result,output);
      output.close();
    }
 catch (    Exception e) {
      throw new GradleException(String.format("Could not write XML test results for %s to file %s.",className,file),e);
    }
 finally {
      IOUtils.closeQuietly(output);
    }
  }
  LOG.info("Finished generating test XML results (" + clock.getTime() + ")");
}
