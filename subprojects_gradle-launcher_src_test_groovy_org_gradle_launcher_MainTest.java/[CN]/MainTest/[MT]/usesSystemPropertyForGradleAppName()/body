{
  System.setProperty("org.gradle.appname","gradle-app");
  final CommandLine2StartParameterConverter commandLine2StartParameterConverterMock=context.mock(CommandLine2StartParameterConverter.class,"helpMock");
  Main main=new Main(TEST_ARGS);
  final StartParameter startParameter=new StartParameter();
  startParameter.setShowHelp(true);
  setUpMain(main,startParameter);
  main.setParameterConverter(commandLine2StartParameterConverterMock);
  context.checking(new Expectations(){
{
      one(commandLine2StartParameterConverterMock).convert(TEST_ARGS);
      will(returnValue(startParameter));
      one(commandLine2StartParameterConverterMock).showHelp(System.out);
    }
  }
);
  try {
    main.execute();
    fail();
  }
 catch (  BuildCompletedError e) {
    assertThat(e.getCause(),nullValue());
  }
  assertThat(outputs.getStdOut(),containsString("USAGE: gradle-app [option...] [task...]"));
}
