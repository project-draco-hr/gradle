{
  final CommandLine2StartParameterConverter commandLine2StartParameterConverterMock=context.mock(CommandLine2StartParameterConverter.class,"exceptionMock");
  Main main=new Main(TEST_ARGS);
  final CommandLineArgumentException conversionException=new CommandLineArgumentException("fail");
  final StartParameter startParameter=new StartParameter();
  setUpMain(main,startParameter);
  main.setParameterConverter(commandLine2StartParameterConverterMock);
  context.checking(new Expectations(){
{
      allowing(commandLine2StartParameterConverterMock).convert(TEST_ARGS);
      will(throwException(conversionException));
      one(commandLine2StartParameterConverterMock).showHelp(System.err);
    }
  }
);
  try {
    main.execute();
    fail();
  }
 catch (  BuildCompletedError e) {
    assertThat((CommandLineArgumentException)e.getCause(),sameInstance(conversionException));
  }
  assertThat(outputs.getStdErr(),containsString("USAGE: gradle [option...] [task...]"));
}
