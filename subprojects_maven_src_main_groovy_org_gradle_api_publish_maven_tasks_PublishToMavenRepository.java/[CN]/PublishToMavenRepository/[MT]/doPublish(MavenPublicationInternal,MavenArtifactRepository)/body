{
  new PublishOperation(publication,repository){
    @Override protected void publish() throws Exception {
      Factory<Configuration> configurationFactory=new Factory<Configuration>(){
        public Configuration create(){
          return getProject().getConfigurations().detachedConfiguration();
        }
      }
;
      MavenPublisher publisher=new MavenPublisher(createDeployerFactory(),configurationFactory,new Transformer<ArtifactPublisher,DependencyResolver>(){
        public ArtifactPublisher transform(        DependencyResolver resolver){
          return artifactPublicationServices.createArtifactPublisher(Collections.singleton(resolver));
        }
      }
);
      MavenNormalizedPublication normalizedPublication=publication.asNormalisedPublication();
      publisher.publish(normalizedPublication,repository);
    }
  }
.run();
}
