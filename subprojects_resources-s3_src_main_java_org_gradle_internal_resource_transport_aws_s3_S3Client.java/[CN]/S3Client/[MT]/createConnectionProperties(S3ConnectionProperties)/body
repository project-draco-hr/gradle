{
  ClientConfiguration clientConfiguration=new ClientConfiguration();
  Optional<HttpProxySettings.HttpProxy> proxyOptional=props.getProxy();
  if (proxyOptional.isPresent()) {
    HttpProxySettings.HttpProxy proxy=props.getProxy().get();
    clientConfiguration.setProxyHost(proxy.host);
    clientConfiguration.setProxyPort(proxy.port);
    PasswordCredentials credentials=proxy.credentials;
    if (credentials != null) {
      clientConfiguration.setProxyUsername(credentials.getUsername());
      clientConfiguration.setProxyPassword(credentials.getPassword());
    }
  }
  Optional<Integer> maxErrorRetryCount=props.getMaxErrorRetryCount();
  if (maxErrorRetryCount.isPresent()) {
    clientConfiguration.setMaxErrorRetry(maxErrorRetryCount.get());
  }
  return clientConfiguration;
}
