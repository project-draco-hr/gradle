{
  try {
    String bucketName=getBucketName(destination);
    String s3BucketKey=getS3BucketKey(destination);
    ObjectMetadata objectMetadata=new ObjectMetadata();
    objectMetadata.setContentLength(contentLength);
    PutObjectRequest putObjectRequest=new PutObjectRequest(bucketName,s3BucketKey,inputStream,objectMetadata);
    LOGGER.debug("Attempting to put resource:[{}] into s3 bucket [{}]",s3BucketKey,bucketName);
    amazonS3Client.putObject(putObjectRequest);
  }
 catch (  AmazonClientException e) {
    throw new S3Exception(String.format("Could not put s3 resource: [%s]. %s",destination.toString(),e.getMessage()),e);
  }
}
