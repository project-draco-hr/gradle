{
  if (lockMode == FileLockManager.LockMode.Shared) {
    throw new UnsupportedOperationException("Not implemented yet.");
  }
  takeOwnership(operationDisplayName);
  try {
    boolean wasStarted=onStartWork();
    try {
      return factory.create();
    }
  finally {
      if (wasStarted) {
        onEndWork();
      }
    }
  }
  finally {
    releaseOwnership(operationDisplayName);
  }
}
