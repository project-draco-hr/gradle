{
  try {
    if (originalStdOutState != null) {
      stdOutLoggingSystem.restore(originalStdOutState);
    }
    if (originalLoggingState != null) {
      loggingSystem.restore(originalLoggingState);
    }
    for (    StandardOutputListener stdoutListener : stdoutListeners) {
      loggingOutput.removeStandardOutputListener(stdoutListener);
    }
    for (    StandardOutputListener stderrListener : stderrListeners) {
      loggingOutput.removeStandardErrorListener(stderrListener);
    }
  }
  finally {
    originalStdOutState=null;
    originalLoggingState=null;
    started=false;
  }
  return this;
}
