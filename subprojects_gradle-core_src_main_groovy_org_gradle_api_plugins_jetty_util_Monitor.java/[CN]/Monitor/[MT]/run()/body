{
  while (_serverSocket != null) {
    Socket socket=null;
    try {
      socket=_serverSocket.accept();
      socket.setSoLinger(false,0);
      LineNumberReader lin=new LineNumberReader(new InputStreamReader(socket.getInputStream()));
      String key=lin.readLine();
      if (!_key.equals(key))       continue;
      String cmd=lin.readLine();
      if ("stop".equals(cmd)) {
        try {
          socket.close();
        }
 catch (        Exception e) {
          logger.debug("Exception when stopping server",e);
        }
        try {
          socket.close();
        }
 catch (        Exception e) {
          logger.debug("Exception when stopping server",e);
        }
        try {
          _serverSocket.close();
        }
 catch (        Exception e) {
          logger.debug("Exception when stopping server",e);
        }
        _serverSocket=null;
        if (_kill) {
          logger.info("Killing Jetty");
          System.exit(0);
        }
 else {
          for (int i=0; _servers != null && i < _servers.length; i++) {
            try {
              logger.info("Stopping server " + i);
              _servers[i].stop();
            }
 catch (            Exception e) {
              logger.error("Exception when stopping server",e);
            }
          }
        }
      }
 else       logger.info("Unsupported monitor operation");
    }
 catch (    Exception e) {
      logger.error("Exception during monitoring Server",e);
    }
 finally {
      if (socket != null) {
        try {
          socket.close();
        }
 catch (        Exception e) {
          logger.debug("Exception when stopping server",e);
        }
      }
      socket=null;
    }
  }
}
