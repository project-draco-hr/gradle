{
  TestFile buildFile=testFile("build.gradle");
  buildFile.writelns("import org.gradle.integtests.TaskExecutionIntegrationTest","task a(dependsOn: 'b') << { task ->","    assertTrue(gradle.taskGraph.hasTask(task))","    assertTrue(gradle.taskGraph.hasTask(':a'))","    assertTrue(gradle.taskGraph.hasTask(a))","    assertTrue(gradle.taskGraph.hasTask(':b'))","    assertTrue(gradle.taskGraph.hasTask(b))","    assertTrue(gradle.taskGraph.allTasks.contains(task))","    assertTrue(gradle.taskGraph.allTasks.contains(tasks.getByName('b')))","}","task b","gradle.taskGraph.whenReady { graph ->","    assertTrue(graph.hasTask(':a'))","    assertTrue(graph.hasTask(a))","    assertTrue(graph.hasTask(':b'))","    assertTrue(graph.hasTask(b))","    assertTrue(graph.allTasks.contains(a))","    assertTrue(graph.allTasks.contains(b))","    TaskExecutionIntegrationTest.graphListenerNotified = true","}");
  usingBuildFile(buildFile).withTasks("a").run().assertTasksExecuted(":b",":a");
  assertTrue(graphListenerNotified);
}
