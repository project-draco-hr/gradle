{
  Map<String,Object> mutableOptions=new HashMap<String,Object>(options);
  Object replaceStr=mutableOptions.remove(Task.TASK_OVERWRITE);
  boolean replace=replaceStr != null && "true".equals(replaceStr.toString());
  Task task=taskFactory.createTask(project,mutableOptions);
  String name=task.getName();
  if (!replace && findByNameWithoutRules(name) != null) {
    throw new InvalidUserDataException(String.format("Cannot add %s as a task with that name already exists.",task));
  }
  addObject(name,task);
  return task;
}
