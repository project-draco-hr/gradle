{
  ModelSchemaExtractionContext<T> context=ModelSchemaExtractionContext.root(type);
  List<ModelSchemaExtractionContext<?>> validations=Lists.newLinkedList();
  Queue<ModelSchemaExtractionContext<?>> unsatisfiedDependencies=Lists.newLinkedList();
  ModelSchemaExtractionContext<?> extractionContext=context;
  validations.add(extractionContext);
  while (extractionContext != null) {
    ModelSchemaExtractionResult<?> nextSchema=extractSchema(extractionContext,store,cache);
    Iterable<? extends ModelSchemaExtractionContext<?>> dependencies=nextSchema.getDependencies();
    Iterables.addAll(validations,dependencies);
    pushUnsatisfiedDependencies(dependencies,unsatisfiedDependencies,cache);
    extractionContext=unsatisfiedDependencies.poll();
  }
  for (  ModelSchemaExtractionContext<?> validationContext : Lists.reverse(validations)) {
    validationContext.validate();
  }
  return cache.get(context.getType());
}
