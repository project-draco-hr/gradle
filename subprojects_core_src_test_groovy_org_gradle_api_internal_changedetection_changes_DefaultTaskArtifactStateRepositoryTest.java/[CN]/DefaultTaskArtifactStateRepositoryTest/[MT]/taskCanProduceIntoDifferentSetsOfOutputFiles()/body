{
  TestFile outputDir2=tmpDir.createDir("output-dir-2");
  TestFile outputDirFile2=outputDir2.file("output-file-2");
  TaskInternal instance1=builder().withOutputFiles(outputDir).createsFiles(outputDirFile).task();
  TaskInternal instance2=builder().withOutputFiles(outputDir2).createsFiles(outputDirFile2).task();
  execute(instance1,instance2);
  TaskArtifactState state=repository.getStateFor(instance1);
  assertTrue(state.isUpToDate());
  assertThat(state.getExecutionHistory().getOutputFiles().getFiles(),equalTo(toLinkedSet((File)outputDirFile)));
  state=repository.getStateFor(instance2);
  assertTrue(state.isUpToDate());
  assertThat(state.getExecutionHistory().getOutputFiles().getFiles(),equalTo(toLinkedSet((File)outputDirFile2)));
}
