{
  task.setDescription("Run CodeNarc analysis for " + sourceSet.getName() + " classes");
  task.getConventionMapping().map("source",new Callable<SourceDirectorySet>(){
    @Override public SourceDirectorySet call() throws Exception {
      Convention sourceSetConvention=new DslObject(sourceSet).getConvention();
      GroovySourceSet groovySourceSet=sourceSetConvention.findPlugin(GroovySourceSet.class);
      if (groovySourceSet == null) {
        return null;
      }
      return groovySourceSet.getAllGroovy();
    }
  }
);
}
