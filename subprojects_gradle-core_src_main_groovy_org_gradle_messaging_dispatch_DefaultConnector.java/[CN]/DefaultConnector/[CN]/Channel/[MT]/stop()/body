{
  requestStop();
  incomingDispatch.stop();
  incomingQueue.requestStop();
  outgoingQueue.requestStop();
  Connection<Message> connection=this.connection.getAndSet(null);
  if (connection != null) {
    connection.requestStop();
  }
  incomingQueue.stop();
  outgoingQueue.stop();
  if (connection != null) {
    connection.stop();
  }
}
