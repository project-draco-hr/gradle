{
  final Map<String,?> options=GUtil.map("option","value");
  final TaskAction action=context.mock(TaskAction.class);
  final Task task=context.mock(Task.class);
  context.checking(new Expectations(){
{
      one(taskFactory).createTask(project,container.getAsMap(),options,"task");
      will(returnValue(task));
      one(task).doFirst(action);
    }
  }
);
  assertThat(container.add(options,"task",action),sameInstance(task));
  assertThat(container.get("task"),sameInstance(task));
}
