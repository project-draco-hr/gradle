{
  if (!visited.add(classDetails)) {
    return;
  }
  if (classDetails.visited) {
    writer.println(prefix + classDetails.className);
    String fileName=classDetails.outputClassName.concat(".class");
    jarOutputStream.putNextEntry(new ZipEntry(fileName));
    File classFile=new File(classesDir,fileName);
    InputStream inputStream=new BufferedInputStream(new FileInputStream(classFile));
    try {
      ByteStreams.copy(inputStream,jarOutputStream);
    }
  finally {
      inputStream.close();
    }
    for (    ClassDetails dependency : classDetails.dependencies) {
      String childPrefix="  " + prefix;
      visitTree(dependency,classesDir,jarOutputStream,writer,childPrefix,visited);
    }
  }
 else {
    writer.println(prefix + classDetails.className + " (not included)");
  }
}
