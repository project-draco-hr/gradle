{
  if (state == State.PUB) {
    String artName=elvis(substitute(attributes.getValue("name")),getMd().getModuleRevisionId().getName());
    String type=elvis(substitute(attributes.getValue("type")),"jar");
    String ext=elvis(substitute(attributes.getValue("ext")),type);
    String url=substitute(attributes.getValue("url"));
    Map extraAttributes=getExtraAttributes(attributes,new String[]{"ext","type","name","conf"});
    artifact=new MDArtifact(getMd(),artName,type,ext,url == null ? null : new URL(url),extraAttributes);
    String confs=substitute(attributes.getValue("conf"));
    if (confs != null && confs.length() > 0) {
      String[] conf;
      if ("*".equals(confs)) {
        conf=getMd().getConfigurationsNames();
      }
 else {
        conf=confs.split(",");
      }
      for (      String confName : conf) {
        artifact.addConfiguration(confName.trim());
        getMd().addArtifact(confName.trim(),artifact);
      }
    }
  }
 else   if (state == State.DEP) {
    addDependencyArtifacts(qName,attributes);
  }
 else   if (validate) {
    addError("artifact tag found in invalid tag: " + state);
  }
}
