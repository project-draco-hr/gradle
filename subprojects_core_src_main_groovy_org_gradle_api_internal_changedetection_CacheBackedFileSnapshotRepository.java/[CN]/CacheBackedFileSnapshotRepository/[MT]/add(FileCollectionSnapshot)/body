{
  open();
  Long id=(Long)cache.get("nextId");
  if (id == null) {
    id=1L;
  }
 else {
    id++;
  }
  cache.put("nextId",id);
  cache.put(id,snapshot);
  return id;
}
