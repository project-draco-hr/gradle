{
  return new ModelView<M>(){
    private boolean closed;
    public ModelType<M> getType(){
      return ManagedModelProjection.this.getType();
    }
    public M getInstance(){
      Class<M> clazz=getType().getConcreteClass();
      return proxyFactory.createProxy(new State(),clazz.getClassLoader(),clazz,ManagedInstance.class);
    }
    public void close(){
      closed=true;
    }
class State implements ModelElementState {
      public <T>T get(      ModelType<T> modelType,      String name){
        return modelNode.getLinks().get(name).getPrivateData(modelType);
      }
      public <T>void set(      ModelType<T> propertyType,      String name,      T value){
        if (!writable) {
          throw new IllegalStateException("object is not mutable!");
        }
        if (closed) {
          throw new IllegalStateException("no more mutation!");
        }
        ModelSchema<T> schema=schemaStore.getSchema(propertyType);
        if (schema.getKind().equals(ModelSchema.Kind.STRUCT) && !ManagedInstance.class.isInstance(value)) {
          throw new IllegalArgumentException(String.format("Only managed model instances can be set as property '%s' of class '%s'",name,getType()));
        }
        modelNode.getLinks().get(name).setPrivateData(propertyType,value);
      }
    }
  }
;
}
