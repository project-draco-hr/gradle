{
  String debugLayout="%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n";
  String infoLayout="%msg%n";
  LoggerContext lc=(LoggerContext)LoggerFactory.getILoggerFactory();
  lc.shutdownAndReset();
  ch.qos.logback.classic.Logger rootLogger=lc.getLogger(LoggerContext.ROOT_NAME);
  ConsoleAppender errorConsoleAppender=new ConsoleAppender();
  errorConsoleAppender.setContext(lc);
  errorConsoleAppender.setTarget("System.err");
  errorConsoleAppender.setLayout(createPatternLayout(lc,infoLayout));
  errorConsoleAppender.addFilter(createLevelFilter(lc,Level.ERROR,FilterReply.ACCEPT,FilterReply.DENY));
  Level level=Level.INFO;
  if (!options.has(QUIET)) {
    ConsoleAppender nonErrorConsoleAppender=new ConsoleAppender();
    nonErrorConsoleAppender.setContext(lc);
    if (options.has(DEBUG)) {
      level=Level.DEBUG;
      nonErrorConsoleAppender.setLayout(createPatternLayout(lc,debugLayout));
      errorConsoleAppender.setLayout(createPatternLayout(lc,debugLayout));
      nonErrorConsoleAppender.addFilter(createLevelFilter(lc,Level.INFO,FilterReply.ACCEPT,FilterReply.NEUTRAL));
      nonErrorConsoleAppender.addFilter(createLevelFilter(lc,Level.DEBUG,FilterReply.ACCEPT,FilterReply.NEUTRAL));
    }
 else {
      nonErrorConsoleAppender.setLayout(createPatternLayout(lc,infoLayout));
      if (options.has(INFO)) {
        level=Level.INFO;
        nonErrorConsoleAppender.addFilter(createLevelFilter(lc,Level.INFO,FilterReply.ACCEPT,FilterReply.NEUTRAL));
      }
 else {
        nonErrorConsoleAppender.addFilter(new HighLevelFilter());
      }
    }
    nonErrorConsoleAppender.addFilter(createLevelFilter(lc,Level.WARN,FilterReply.ACCEPT,FilterReply.DENY));
    rootLogger.addAppender(nonErrorConsoleAppender);
    nonErrorConsoleAppender.start();
  }
  rootLogger.addAppender(errorConsoleAppender);
  errorConsoleAppender.start();
  Message.setDefaultLogger(new IvyLoggingAdaper());
  rootLogger.setLevel(level);
}
