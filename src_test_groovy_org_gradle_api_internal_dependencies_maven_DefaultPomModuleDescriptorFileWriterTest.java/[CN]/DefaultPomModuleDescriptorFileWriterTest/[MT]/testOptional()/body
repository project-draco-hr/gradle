{
  final PomModuleDescriptorWriter moduleDescriptorWriterMock=context.mock(PomModuleDescriptorWriter.class);
  final MavenPom testPom=context.mock(MavenPom.class);
  final String expectedPomText="somePomXml";
  context.checking(new Expectations(){
{
      one(moduleDescriptorWriterMock).convert(with(same(testPom)),with(any(PrintWriter.class)));
      will(new WriteAction(expectedPomText));
    }
  }
);
  new DefaultPomModuleDescriptorFileWriter(moduleDescriptorWriterMock).write(testPom,_dest);
  assertTrue(_dest.exists());
  String wrote=FileUtils.readFileToString(_dest);
  assertEquals(expectedPomText + System.getProperty("line.separator"),wrote);
}
