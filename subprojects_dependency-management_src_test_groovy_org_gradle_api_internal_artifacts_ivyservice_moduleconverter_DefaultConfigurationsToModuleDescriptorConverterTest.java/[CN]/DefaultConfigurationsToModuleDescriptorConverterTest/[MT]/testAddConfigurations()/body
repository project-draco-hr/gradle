{
  Configuration configurationStub1=createNamesAndExtendedConfigurationStub("conf1");
  Configuration configurationStub2=createNamesAndExtendedConfigurationStub("conf2",configurationStub1);
  MutableLocalComponentMetaData metaData=new DefaultLocalComponentMetaData(id,componentId,"status");
  configurationsToModuleDescriptorConverter.addConfigurations(metaData,WrapUtil.toSet(configurationStub1,configurationStub2));
  ModuleDescriptor moduleDescriptor=metaData.toPublishMetaData().getModuleDescriptor();
  assertIvyConfigurationIsCorrect(moduleDescriptor.getConfiguration(configurationStub1.getName()),expectedIvyConfiguration(configurationStub1));
  assertIvyConfigurationIsCorrect(moduleDescriptor.getConfiguration(configurationStub2.getName()),expectedIvyConfiguration(configurationStub2));
  assertThat(moduleDescriptor.getConfigurations().length,equalTo(2));
}
