{
  if (!isStopping()) {
    LOGGER.lifecycle(DAEMON_WILL_STOP_MESSAGE + reason);
    lock.lock();
    try {
      if (isBusy()) {
        LOGGER.debug("Stop as soon as idle requested. The daemon is busy: {}",isBusy());
        beginStopping();
      }
 else {
        stopNow(reason);
      }
    }
  finally {
      lock.unlock();
    }
  }
}
