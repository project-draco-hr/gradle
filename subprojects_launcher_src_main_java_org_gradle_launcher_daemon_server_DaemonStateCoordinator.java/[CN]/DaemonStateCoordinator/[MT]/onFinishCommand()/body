{
  lock.lock();
  try {
    String execution=currentCommandExecution;
    LOGGER.debug("onFinishCommand() called while execution = {}",execution);
    currentCommandExecution=null;
    updateActivityTimestamp();
switch (state) {
case Running:
      onFinishCommand.run();
    condition.signalAll();
  break;
case StopRequested:
case Stopped:
stop();
break;
default :
throw new IllegalStateException("Daemon is in unexpected state: " + state);
}
}
  finally {
lock.unlock();
}
}
