{
  executor.execute(new Runnable(){
    public void run(){
      requestStop();
      incomingDispatch.stop();
      incomingReceive.requestStop();
      outgoingQueue.requestStop();
      new CompositeStoppable(outgoingQueue,connection,incomingReceive,incomingDemux).stop();
    }
  }
);
  try {
    executor.stop(120,TimeUnit.SECONDS);
  }
 catch (  Throwable e) {
    throw new GradleException("Could not stop connection.",e);
  }
}
