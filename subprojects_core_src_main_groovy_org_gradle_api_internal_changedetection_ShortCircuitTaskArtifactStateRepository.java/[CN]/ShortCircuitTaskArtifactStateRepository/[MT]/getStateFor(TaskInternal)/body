{
  final TaskArtifactState state=repository.getStateFor(task);
  return new TaskArtifactState(){
    public boolean isUpToDate(){
      return !startParameter.isNoOpt() && task.getOutputs().getUpToDateSpec().isSatisfiedBy(task) && state.isUpToDate();
    }
    public TaskExecutionHistory getExecutionHistory(){
      return state.getExecutionHistory();
    }
    public void beforeTask(){
      state.beforeTask();
    }
    public void afterTask(){
      state.afterTask();
    }
    public void finished(){
      state.finished();
    }
  }
;
}
