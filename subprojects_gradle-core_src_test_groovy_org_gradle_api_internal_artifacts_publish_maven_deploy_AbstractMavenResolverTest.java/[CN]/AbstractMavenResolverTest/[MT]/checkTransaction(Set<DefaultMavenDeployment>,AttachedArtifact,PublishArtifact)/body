{
  final GrabSettingsFileAction grabSettingsFileAction=new GrabSettingsFileAction();
  context.checking(new Expectations(){
{
      one(getInstallDeployTask()).setProject(with(any(Project.class)));
      one(getInstallDeployTask()).setSettingsFile(with(any(File.class)));
      will(grabSettingsFileAction);
      for (      DefaultMavenDeployment defaultMavenDeployment : defaultMavenDeployments) {
        one(getInstallDeployTask()).setFile(defaultMavenDeployment.getMainArtifact().getFile());
        one(getInstallDeployTask()).addPom(with(pomMatcher(defaultMavenDeployment.getPomArtifact().getFile(),getInstallDeployTask().getProject())));
        one(loggingManagerMock).captureStandardOutput(LogLevel.INFO);
        will(returnValue(loggingManagerMock));
        one(loggingManagerMock).start();
        one(getInstallDeployTask()).execute();
        one(loggingManagerMock).stop();
        will(returnValue(loggingManagerMock));
      }
    }
  }
);
  getMavenResolver().commitPublishTransaction();
  assertThat(attachedArtifact.getFile(),equalTo(classifierArtifact.getFile()));
  assertThat(attachedArtifact.getType(),equalTo(classifierArtifact.getType()));
  assertThat(attachedArtifact.getClassifier(),equalTo(classifierArtifact.getClassifier()));
  assertThat(grabSettingsFileAction.getSettingsFile().exists(),equalTo(false));
  assertThat(grabSettingsFileAction.getSettingsFileContent(),equalTo(AbstractMavenResolver.SETTINGS_XML));
}
