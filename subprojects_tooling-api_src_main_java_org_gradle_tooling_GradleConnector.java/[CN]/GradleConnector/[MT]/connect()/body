{
  LOGGER.info("Connecting from tooling API consumer version {}",new GradleVersion().getVersion());
  LOGGER.info("Consumer ClassLoader: {}",getClass().getClassLoader());
  if (projectDir == null) {
    throw new IllegalStateException("A project directory must be specified before creating a connection.");
  }
  if (distribution == null) {
    distribution=distributionFactory.getCurrentDistribution();
  }
  return connectionFactory.create(distribution,projectDir);
}
