{
  FileCollectionHashBuilder hashBuilder=orderSensitive ? new OrderInsensitiveFileCollectionHashBuilder(snapshots.size(),builder) : new OrderSensitiveFileCollectionHashBuilder(builder);
  List<String> keys=Lists.newArrayList(snapshots.keySet());
  Collections.sort(keys);
  for (  String key : keys) {
    IncrementalFileSnapshot snapshot=snapshots.get(key);
    hashBuilder.hash(key,snapshot.getHash());
  }
  hashBuilder.close();
}
