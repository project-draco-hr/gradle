{
synchronized (implementations) {
    T implementation=serviceType.cast(implementations.get(serviceType));
    if (implementation == null) {
      implementation=getFactory(serviceType).create();
      implementations.put(serviceType,implementation);
    }
    return implementation;
  }
}
