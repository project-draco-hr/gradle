{
  String resourceName="META-INF/services/" + serviceType.getName();
  URL resource=classLoader.getResource(resourceName);
  if (resource == null) {
    return null;
  }
  InputStream inputStream=resource.openStream();
  try {
    BufferedReader reader=new BufferedReader(new InputStreamReader(inputStream));
    String line;
    while ((line=reader.readLine()) != null) {
      line=line.replaceAll("#.*","").trim();
      if (line.length() > 0) {
        return line;
      }
    }
  }
  finally {
    inputStream.close();
  }
  throw new RuntimeException(String.format("No implementation class for service '%s' specified in resource '%s'.",serviceType.getName(),resource));
}
