{
  DefaultGradleConnector connector=getInternalConnector();
  if (gradleUserHomeDir != null) {
    connector.useGradleUserHomeDir(gradleUserHomeDir);
  }
  if (daemonBaseDir != null) {
    connector.daemonBaseDir(daemonBaseDir);
  }
  if (daemonMaxIdleTimeValue != null && daemonMaxIdleTimeUnits != null) {
    connector.daemonMaxIdleTime(daemonMaxIdleTimeValue,daemonMaxIdleTimeUnits);
  }
  connector.searchUpwards(false);
  connector.forProjectDirectory(build.getProjectDir());
  return configureDistribution(connector,build).connect();
}
