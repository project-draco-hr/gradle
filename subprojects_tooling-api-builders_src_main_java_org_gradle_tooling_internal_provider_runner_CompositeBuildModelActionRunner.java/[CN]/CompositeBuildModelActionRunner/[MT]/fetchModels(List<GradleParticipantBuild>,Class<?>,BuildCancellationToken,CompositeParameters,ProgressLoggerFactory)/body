{
  final Map<Object,Object> results=new HashMap<Object,Object>();
  for (  GradleParticipantBuild participant : participantBuilds) {
    if (cancellationToken.isCancellationRequested()) {
      break;
    }
    ProjectConnection projectConnection=connect(participant,compositeParameters);
    File rootDir=participant.getProjectDir();
    DefaultBuildIdentity buildIdentity=new DefaultBuildIdentity(rootDir);
    try {
      if (modelType == BuildEnvironment.class) {
        ProjectIdentity projectIdentity=new DefaultProjectIdentity(buildIdentity,rootDir,":");
        results.putAll(fetchPerBuildModels(projectIdentity,projectConnection,modelType,cancellationToken,progressLoggerFactory));
      }
 else {
        results.putAll(fetchPerProjectModels(projectConnection,modelType,cancellationToken,progressLoggerFactory));
      }
    }
 catch (    GradleConnectionException e) {
      throw new CompositeBuildExceptionVersion1(e,buildIdentity);
    }
 finally {
      projectConnection.close();
    }
  }
  return results;
}
