{
  String executable=getExecutable();
  if (StringUtils.isEmpty(executable)) {
    throw new IllegalStateException("execCommand == null!");
  }
  boolean shouldReadErrorStream=!redirectErrorStream;
  StreamsForwarder forwarder=new StreamsForwarder(standardOutput,errorOutput,input,shouldReadErrorStream,String.format("Forward streams with process: %s",getDisplayName()));
  return new DefaultExecHandle(getDisplayName(),getWorkingDir(),executable,getAllArguments(),getActualEnvironment(),forwarder,listeners,redirectErrorStream);
}
