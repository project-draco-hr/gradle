{
  try {
    TestNG testNg=new TestNG();
    testNg.setOutputDirectory(testReportDir.getAbsolutePath());
    testNg.setUseDefaultListeners(false);
    testNg.addListener(new SuiteHTMLReporter());
    testNg.addListener(new XMLReporter());
    testNg.addListener(new TestNGListenerAdapter(listener));
    testNg.setVerbose(0);
    Class[] classes=new Class[testClassNames.size()];
    for (int i=0; i < testClassNames.size(); i++) {
      String className=testClassNames.get(i);
      classes[i]=TestNG.class.getClassLoader().loadClass(className);
    }
    testNg.setTestClasses(classes);
    testNg.run();
  }
 catch (  Throwable throwable) {
    throw new GradleException("Could not execute tests.",throwable);
  }
}
