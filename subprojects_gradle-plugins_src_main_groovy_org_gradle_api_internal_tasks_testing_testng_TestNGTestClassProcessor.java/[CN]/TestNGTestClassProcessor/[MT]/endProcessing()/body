{
  TestNG testNg=new TestNG();
  testNg.setOutputDirectory(testReportDir.getAbsolutePath());
  testNg.setDefaultSuiteName(options.getSuiteName());
  testNg.setDefaultTestName(options.getTestName());
  testNg.setAnnotations(options.getAnnotations());
  if (options.getJavadocAnnotations()) {
    testNg.setSourcePath(GUtil.join(options.getTestResources(),File.pathSeparator));
  }
  testNg.setUseDefaultListeners(options.getUseDefaultListeners());
  testNg.addListener(listener);
  testNg.setVerbose(0);
  if (!suiteFiles.isEmpty()) {
    testNg.setTestSuites(GFileUtils.toPaths(suiteFiles));
  }
 else {
    Class[] classes=testClasses.toArray(new Class[testClasses.size()]);
    testNg.setTestClasses(classes);
  }
  testNg.run();
}
