{
  final MockFile root=new MockFile(context,"root",false);
  final MockFile rootFile1=root.addFile("rootFile1");
  final MockFile dir1=root.addDir("dir1");
  final MockFile dirFile1=dir1.addFile("dirFile1");
  dir1.addFile("dirFile2");
  dir1.addDir("dir1Dir").addFile("dir1Dir1File1");
  final MockFile rootFile2=root.addFile("rootFile2");
  root.setExpectations();
  context.checking(new Expectations(){
{
      one(visitor).visitFile(with(file(rootFile1)));
      will(stopVisiting());
    }
  }
);
  DirectoryFileTree fileTree=new DirectoryFileTree(root.getMock());
  fileTree.visit(visitor);
  final Sequence visiting=context.sequence("visiting");
  context.checking(new Expectations(){
{
      one(visitor).visitFile(with(file(rootFile1)));
      inSequence(visiting);
      one(visitor).visitFile(with(file(rootFile2)));
      inSequence(visiting);
      one(visitor).visitDir(with(file(dir1)));
      inSequence(visiting);
      one(visitor).visitFile(with(file(dirFile1)));
      will(stopVisiting());
      inSequence(visiting);
    }
  }
);
  fileTree.visit(visitor);
}
