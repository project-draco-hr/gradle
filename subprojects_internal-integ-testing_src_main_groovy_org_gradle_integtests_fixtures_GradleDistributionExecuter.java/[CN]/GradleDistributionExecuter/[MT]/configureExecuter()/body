{
  if (!workingDirSet) {
    inDirectory(dist.getTestDir());
  }
  if (!userHomeSet) {
    withUserHomeDir(dist.getUserHomeDir());
  }
  if (getDaemonIdleTimeoutSecs() == null) {
    if (dist.isUsingIsolatedDaemons() || getDaemonBaseDir() != null) {
      withDaemonIdleTimeoutSecs(20);
    }
 else {
      withDaemonIdleTimeoutSecs(DEFAULT_DAEMON_IDLE_TIMEOUT_SECS);
    }
  }
  if (getDaemonBaseDir() == null) {
    withDaemonBaseDir(dist.getDaemonBaseDir());
  }
  if (!getClass().desiredAssertionStatus()) {
    throw new RuntimeException("Assertions must be enabled when running integration tests.");
  }
  GradleExecuter gradleExecuter=createExecuter(executerType);
  copyTo(gradleExecuter);
  configureTmpDir(gradleExecuter);
  configureForSettingsFile(gradleExecuter);
  if (System.getProperty(UNKNOWN_OS_SYS_PROP) != null) {
    gradleExecuter.withGradleOpts("-Dos.arch=unknown architecture","-Dos.name=unknown operating system","-Dos.version=unknown version");
  }
  return gradleExecuter;
}
