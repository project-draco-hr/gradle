{
  if (!workingDirSet) {
    inDirectory(dist.getTestDir());
  }
  if (!userHomeSet) {
    withUserHomeDir(dist.getUserHomeDir());
  }
  if (!getClass().desiredAssertionStatus()) {
    throw new RuntimeException("Assertions must be enabled when running integration tests.");
  }
  GradleExecuter gradleExecuter=createExecuter(executerType);
  copyTo(gradleExecuter);
  if (executerType.executeParallel) {
    gradleExecuter.withArgument("--parallel-executor");
  }
  configureTmpDir(gradleExecuter);
  configureForSettingsFile(gradleExecuter);
  return gradleExecuter;
}
