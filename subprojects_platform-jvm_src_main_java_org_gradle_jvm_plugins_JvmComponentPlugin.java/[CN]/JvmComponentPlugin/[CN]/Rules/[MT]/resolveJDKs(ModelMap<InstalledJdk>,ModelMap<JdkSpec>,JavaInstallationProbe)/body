{
  File currentJavaHome=canonicalFile(Jvm.current().getJavaHome());
  for (  final JdkSpec jdk : jdks) {
    final File javaHome=canonicalFile(jdk.getPath());
    JavaInstallationProbe.ProbeResult probeResult=probe.checkJdk(javaHome);
switch (probeResult) {
case VALID_JDK:
      if (!javaHome.equals(currentJavaHome)) {
        installedJdks.create(jdk.getName(),InstalledJdkInternal.class,new Action<InstalledJdkInternal>(){
          @Override public void execute(          InstalledJdkInternal installedJdk){
            installedJdk.setJavaHome(javaHome);
            probe.configure(javaHome,installedJdk);
          }
        }
);
      }
    break;
case NO_SUCH_DIRECTORY:
  throw new InvalidModelException(String.format("Path to JDK '%s' doesn't exist: %s",jdk.getName(),javaHome));
case INVALID_JDK:
throw new InvalidModelException(String.format("JDK '%s' is not a valid JDK installation: %s",jdk.getName(),javaHome));
}
}
}
