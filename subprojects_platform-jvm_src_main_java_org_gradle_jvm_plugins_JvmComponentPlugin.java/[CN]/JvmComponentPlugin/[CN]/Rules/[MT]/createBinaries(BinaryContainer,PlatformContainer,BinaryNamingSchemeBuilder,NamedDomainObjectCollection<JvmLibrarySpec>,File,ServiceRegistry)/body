{
  Instantiator instantiator=serviceRegistry.get(Instantiator.class);
  JavaToolChain toolChain=serviceRegistry.get(JavaToolChain.class);
  Action<JarBinarySpec> configureBinaryAction=new JarBinarySpecInitializer(buildDir);
  @SuppressWarnings("unchecked") Action<JarBinarySpec> initAction=Actions.composite(configureBinaryAction,new MarkBinariesBuildable());
  JarBinariesFactory factory=new DefaultJarBinariesFactory(instantiator,initAction);
  Action<JvmLibrarySpec> createBinariesAction=new JvmLibrarySpecInitializer(factory,namingSchemeBuilder,toolChain,platforms);
  for (  JvmLibrarySpec jvmLibrary : libraries) {
    createBinariesAction.execute(jvmLibrary);
    for (    JvmBinarySpec jarBinarySpec : jvmLibrary.getBinaries()) {
      toolChain.assertValidPlatform(jarBinarySpec.getTargetPlatform(),platforms);
    }
    binaries.addAll(jvmLibrary.getBinaries());
  }
}
