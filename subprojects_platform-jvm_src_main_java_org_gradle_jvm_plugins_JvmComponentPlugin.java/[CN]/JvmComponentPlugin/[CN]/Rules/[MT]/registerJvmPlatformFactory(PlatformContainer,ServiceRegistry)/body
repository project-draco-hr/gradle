{
  final Instantiator instantiator=serviceRegistry.get(Instantiator.class);
  platforms.registerFactory(JavaPlatform.class,new NamedDomainObjectFactory<JavaPlatform>(){
    public JavaPlatform create(    String name){
      return instantiator.newInstance(DefaultJavaPlatform.class,name);
    }
  }
);
  for (  JavaVersion javaVersion : JavaVersion.values()) {
    String name="java" + javaVersion.getMajorVersion();
    JavaPlatform platform=platforms.create(name,JavaPlatform.class);
    platform.setTargetCompatibility(javaVersion);
  }
}
