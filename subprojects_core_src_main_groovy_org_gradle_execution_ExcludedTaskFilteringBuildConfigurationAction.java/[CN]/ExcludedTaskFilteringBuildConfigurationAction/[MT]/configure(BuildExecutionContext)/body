{
  GradleInternal gradle=context.getGradle();
  Set<String> excludedTaskNames=gradle.getStartParameter().getExcludedTaskNames();
  if (!excludedTaskNames.isEmpty()) {
    TaskSelector selector=gradle.getServices().get(TaskSelector.class);
    final Set<Task> excludedTasks=new HashSet<Task>();
    for (    String taskName : excludedTaskNames) {
      excludedTasks.addAll(selector.getSelection(taskName).getTasks());
    }
    gradle.getTaskGraph().useFilter(new Spec<Task>(){
      public boolean isSatisfiedBy(      Task task){
        return !excludedTasks.contains(task);
      }
    }
);
  }
  context.proceed();
}
