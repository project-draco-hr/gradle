{
  if (commandLine.hasOption(HELP)) {
    return new ActionAdapter(new ShowUsageAction(parser));
  }
  if (commandLine.hasOption(VERSION)) {
    return new ActionAdapter(new ShowVersionAction());
  }
  if (commandLine.hasOption(GUI)) {
    return new ActionAdapter(new ShowGuiAction());
  }
  if (commandLine.hasOption(FOREGROUND)) {
    return new ActionAdapter(new GradleDaemon(loggingServices));
  }
  if (commandLine.hasOption(STOP)) {
    return new StopDaemonAction(new DaemonConnector(),loggingServices.get(OutputEventListener.class));
  }
  StartParameter startParameter=startParameterConverter.convert(commandLine);
  if (commandLine.hasOption(DAEMON) || System.getProperty("org.gradle.daemon","false").equals("true")) {
    return new DaemonBuildAction(loggingServices.get(OutputEventListener.class),new DaemonConnector(),startParameter,commandLine,new File(System.getProperty("user.dir")));
  }
  return new RunBuildAction(startParameter,loggingServices);
}
