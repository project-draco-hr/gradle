{
  CommandLineParser parser=new CommandLineParser();
  CommandLineConverter<StartParameter> startParameterConverter=createStartParameterConverter();
  startParameterConverter.configure(parser);
  parser.option(HELP,"?","help").hasDescription("Shows this help message");
  parser.option(VERSION,"version").hasDescription("Print version info.");
  parser.option(GUI).hasDescription("Launches a GUI application");
  LoggingConfiguration loggingConfiguration=new LoggingConfiguration();
  ServiceRegistry loggingServices=createLoggingServices();
  Runnable action;
  try {
    ParsedCommandLine commandLine=parser.parse(args);
    CommandLineConverter<LoggingConfiguration> loggingConfigurationConverter=loggingServices.get(CommandLineConverter.class);
    loggingConfigurationConverter.convert(commandLine,loggingConfiguration);
    action=createAction(parser,commandLine,startParameterConverter,loggingServices);
  }
 catch (  CommandLineArgumentException e) {
    action=new CommandLineParseFailureAction(parser,e);
  }
  return new WithLoggingAction(loggingConfiguration,loggingServices,action);
}
