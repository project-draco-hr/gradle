{
  if (state == StageState.Init || state == StageState.Stopped) {
    throw new IllegalStateException(String.format("Cannot stop later when in %s state.",state));
  }
  state=StageState.StopPending;
}
