{
  FailureState failureState=new FailureState(resolveState.root);
  newModelBuilder.start(resolveState.root.moduleRevision.id);
  for (  ConfigurationNode resolvedConfiguration : resolveState.getConfigurationNodes()) {
    if (resolvedConfiguration.isSelected()) {
      resolvedConfiguration.validate();
      oldModelBuilder.newResolvedDependency(resolvedConfiguration.id);
      resolvedConfiguration.collectFailures(failureState);
      newModelBuilder.resolvedModuleVersion(resolvedConfiguration.moduleRevision);
    }
  }
  for (  ConfigurationNode resolvedConfiguration : resolveState.getConfigurationNodes()) {
    if (resolvedConfiguration.isSelected()) {
      resolvedConfiguration.attachToParents(oldModelBuilder);
      newModelBuilder.resolvedConfiguration(resolvedConfiguration.toId(),resolvedConfiguration.outgoingEdges);
    }
  }
  failureState.attachFailures(oldModelBuilder);
  oldModelBuilder.done(resolveState.root.id);
}
