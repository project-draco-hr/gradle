{
  String[] configurations=from.metaData.getHierarchy().toArray(new String[from.metaData.getHierarchy().size()]);
  ModuleVersionSpec moduleVersionSelector=ModuleVersionSpec.forExcludes(dependencyDescriptor.getExcludeRules(configurations));
  ArtifactVersionSpec artifactVersionSelector=ArtifactVersionSpec.forExcludes(dependencyDescriptor.getExcludeRules(configurations));
  return new ModuleSelector(moduleVersionSelector,artifactVersionSelector).intersect(selectorSpec);
}
