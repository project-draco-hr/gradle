{
  if (isSnapshotVersion(dd)) {
    final ModuleRevisionId dependencyRevisionId=dd.getDependencyRevisionId();
    final String uniqueSnapshotVersion=findUniqueSnapshotVersion(dependencyRevisionId);
    if (uniqueSnapshotVersion != null) {
      Map<String,String> extraAttributes=new HashMap<String,String>(1);
      extraAttributes.put("timestamp",uniqueSnapshotVersion);
      final ModuleRevisionId newModuleRevisionId=ModuleRevisionId.newInstance(dependencyRevisionId.getOrganisation(),dependencyRevisionId.getName(),dependencyRevisionId.getRevision(),extraAttributes);
      final DependencyDescriptor enrichedDependencyDescriptor=dd.clone(newModuleRevisionId);
      final ResolvedModuleRevision dependency=super.getDependency(enrichedDependencyDescriptor,data);
      final ModuleDescriptor descriptor=dependency.getDescriptor();
      descriptor.setResolvedModuleRevisionId(newModuleRevisionId);
      return dependency;
    }
  }
  return super.getDependency(dd,data);
}
