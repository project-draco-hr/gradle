{
  Set<DirectoryTree> watchedTrees=pathToDirectoryTrees.get(changeDetails.getWatchedPath());
  if (watchedTrees != null) {
    for (    DirectoryTree watchedTree : watchedTrees) {
      FileTreeElement fileTreeElement=toFileTreeElement(changeDetails,watchedTree);
      if (!isExcluded(watchedTree,fileTreeElement)) {
        boolean isDirectory=isDirectory(changeDetails.getFullItemPath());
        if (isDirectory && changeDetails.getChangeType() == ChangeDetails.ChangeType.CREATE) {
          handleNewDirectory(changeDetails,listener,watchedTree);
        }
        if (!isDirectory && isIncluded(watchedTree,fileTreeElement)) {
          handleFileChange(changeDetails,listener,watchedTree);
        }
      }
    }
  }
}
