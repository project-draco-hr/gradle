{
  ProgressLogger progressLogger=progressLoggerFactory.newOperation(ProgressLoggingExternalResource.class);
  progressLogger.setDescription(String.format("Download %s",getName()));
  progressLogger.setShortDescription(String.format("Download %s",getName()));
  progressLogger.started();
  final ProgressLoggingOutputStream progressLoggingOutputStream=new ProgressLoggingOutputStream(outputStream,progressLogger,resource.getContentLength());
  try {
    resource.writeTo(progressLoggingOutputStream,lister);
  }
 catch (  IOException e) {
    progressLogger.completed(String.format("Failed to write %s to %s.",getName()));
    throw e;
  }
catch (  Exception e) {
    progressLogger.completed(String.format("Failed to write %s to %s.",getName()));
    throw UncheckedException.throwAsUncheckedException(e);
  }
 finally {
    progressLogger.completed();
  }
}
