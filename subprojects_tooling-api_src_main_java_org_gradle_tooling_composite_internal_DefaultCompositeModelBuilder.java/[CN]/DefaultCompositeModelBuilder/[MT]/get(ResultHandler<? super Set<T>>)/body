{
  final ConsumerOperationParameters operationParameters=getConsumerOperationParameters();
  connection.run(new ConsumerAction<Set<T>>(){
    public ConsumerOperationParameters getParameters(){
      return operationParameters;
    }
    public Set<T> run(    ConsumerConnection connection){
      Set<T> model=connection.buildModels(modelType,operationParameters);
      return model;
    }
  }
,new ResultHandlerAdapter<Set<T>>(handler){
    @Override protected String connectionFailureMessage(    Throwable failure){
      String message=String.format("Could not fetch models of type '%s' using %s.",modelType.getSimpleName(),connection.getDisplayName());
      if (!(failure instanceof UnsupportedMethodException) && failure instanceof UnsupportedOperationException) {
        message+="\n" + Exceptions.INCOMPATIBLE_VERSION_HINT;
      }
      return message;
    }
  }
);
}
