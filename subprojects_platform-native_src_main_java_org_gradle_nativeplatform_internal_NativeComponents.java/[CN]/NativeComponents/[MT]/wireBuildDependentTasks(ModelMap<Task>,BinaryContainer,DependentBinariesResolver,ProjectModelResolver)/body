{
  final ModelMap<NativeBinarySpecInternal> nativeBinaries=binaries.withType(NativeBinarySpecInternal.class);
  for (  final BinarySpecInternal binary : nativeBinaries) {
    Task assembleDependents=tasks.get(binary.getNamingScheme().getTaskName("assembleDependents"));
    Callable<Iterable<BinarySpec>> deferredDependencies=new Callable<Iterable<BinarySpec>>(){
      @Override public Iterable<BinarySpec> call(){
        List<BinarySpec> dependencies=Lists.newArrayList();
        DependentBinariesResolvedResult result=dependentsResolver.resolve(binary).getRoot();
        for (        DependentBinariesResolvedResult dependent : result.getChildren()) {
          if (dependent.isBuildable()) {
            ModelRegistry modelRegistry=projectModelResolver.resolveProjectModel(dependent.getId().getProjectPath());
            ModelMap<NativeBinarySpecInternal> projectBinaries=modelRegistry.realize("binaries",ModelTypes.modelMap(NativeBinarySpecInternal.class));
            NativeBinarySpecInternal dependentBinary=projectBinaries.get(dependent.getProjectScopedName());
            dependencies.add(dependentBinary);
          }
        }
        return dependencies;
      }
    }
;
    assembleDependents.dependsOn(deferredDependencies);
  }
}
