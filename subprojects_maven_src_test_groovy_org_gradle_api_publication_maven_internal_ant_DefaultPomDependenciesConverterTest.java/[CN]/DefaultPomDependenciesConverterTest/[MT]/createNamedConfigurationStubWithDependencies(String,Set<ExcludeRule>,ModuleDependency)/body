{
  final Configuration configurationStub=context.mock(Configuration.class,confName);
  final DependencySet dependencySet=context.mock(DependencySet.class);
  context.checking(new Expectations(){
{
      allowing(configurationStub).getName();
      will(returnValue(confName));
      allowing(configurationStub).getDependencies();
      will(returnValue(dependencySet));
      allowing(dependencySet).withType(ModuleDependency.class);
      will(returnValue(toDomainObjectSet(ModuleDependency.class,dependencies)));
      allowing(configurationStub).getExcludeRules();
      will(returnValue(excludeRules));
    }
  }
);
  return configurationStub;
}
