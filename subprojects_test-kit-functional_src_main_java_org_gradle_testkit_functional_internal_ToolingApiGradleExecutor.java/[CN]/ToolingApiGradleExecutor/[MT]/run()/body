{
  final ByteArrayOutputStream standardOutput=new ByteArrayOutputStream();
  final ByteArrayOutputStream standardError=new ByteArrayOutputStream();
  final List<String> executedTasks=new ArrayList<String>();
  final List<String> skippedTasks=new ArrayList<String>();
  GradleConnector gradleConnector=buildConnector();
  ProjectConnection connection=null;
  try {
    connection=gradleConnector.connect();
    BuildLauncher launcher=connection.newBuild();
    launcher.setStandardOutput(standardOutput);
    launcher.setStandardError(standardError);
    launcher.addProgressListener(new TaskExecutionProgressListener(executedTasks,skippedTasks));
    String[] argumentArray=new String[arguments.size()];
    arguments.toArray(argumentArray);
    launcher.withArguments(argumentArray);
    String[] tasksArray=new String[taskNames.size()];
    taskNames.toArray(tasksArray);
    launcher.forTasks(tasksArray);
    launcher.run();
  }
 catch (  RuntimeException t) {
    return new GradleExecutionResult(standardOutput,standardError,executedTasks,skippedTasks,t);
  }
 finally {
    if (connection != null) {
      connection.close();
    }
  }
  return new GradleExecutionResult(standardOutput,standardError,executedTasks,skippedTasks);
}
