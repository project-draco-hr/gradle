{
  Map<String,Long> rootFileIds=new HashMap<String,Long>();
  int rootFileIdsCount=dataInput.readInt();
  for (int i=0; i < rootFileIdsCount; i++) {
    String key=dataInput.readUTF();
    boolean notNull=dataInput.readBoolean();
    Long value=notNull ? dataInput.readLong() : null;
    rootFileIds.put(key,value);
  }
  FileSnapshotSerializer serializer=new FileSnapshotSerializer();
  FileCollectionSnapshot snapshot=serializer.read(dataInput);
  return new OutputFilesSnapshotter.OutputFilesSnapshot(rootFileIds,snapshot);
}
