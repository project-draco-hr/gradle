{
  final Configuration configurationDummy=context.mock(Configuration.class);
  final Set<Configuration> configurations=WrapUtil.toSet(configurationDummy);
  final ResolvedConfiguration resolvedConfiguration=context.mock(ResolvedConfiguration.class);
  final ModuleDescriptor moduleDescriptorDummy=HelperUtil.createModuleDescriptor(WrapUtil.toSet("someConf"));
  final IvyFactory ivyFactoryStub=context.mock(IvyFactory.class);
  final Ivy ivyStub=context.mock(Ivy.class);
  final IvySettings ivySettingsDummy=new IvySettings();
  context.checking(new Expectations(){
{
      allowing(ivyFactoryStub).createIvy(ivySettingsDummy);
      will(returnValue(ivyStub));
      allowing(configurationDummy).getHierarchy();
      will(returnValue(configurations));
      allowing(ivyStub).getSettings();
      will(returnValue(ivySettingsDummy));
      allowing(ivyService.getDependencyResolver()).resolve(configurationDummy,ivyStub,moduleDescriptorDummy);
      will(returnValue(resolvedConfiguration));
      allowing(ivyService.getResolveModuleDescriptorConverter()).convert(WrapUtil.toSet(configurationDummy),moduleDummy,ivySettingsDummy);
      will(returnValue(moduleDescriptorDummy));
      allowing(ivyService.getSettingsConverter()).convertForResolve(dependencyResolversDummy,cacheParentDirDummy,internalRepositoryDummy,clientModuleRegistryDummy);
      will(returnValue(ivySettingsDummy));
    }
  }
);
  ivyService.setIvyFactory(ivyFactoryStub);
  assertThat(ivyService.resolve(configurationDummy),sameInstance(resolvedConfiguration));
}
