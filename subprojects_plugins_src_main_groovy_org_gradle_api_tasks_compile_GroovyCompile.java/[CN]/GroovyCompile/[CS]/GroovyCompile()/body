{
  ProjectInternal projectInternal=(ProjectInternal)getProject();
  JavaCompilerFactory inProcessCompilerFactory=new InProcessJavaCompilerFactory();
  tempFileProvider=projectInternal.getServices().get(TemporaryFileProvider.class);
  CompilerDaemonManager compilerDaemonManager=getServices().get(CompilerDaemonManager.class);
  InProcessCompilerDaemonFactory inProcessCompilerDaemonFactory=getServices().get(InProcessCompilerDaemonFactory.class);
  DefaultJavaCompilerFactory javaCompilerFactory=new DefaultJavaCompilerFactory(projectInternal,inProcessCompilerFactory,compilerDaemonManager);
  GroovyCompilerFactory groovyCompilerFactory=new GroovyCompilerFactory(projectInternal,javaCompilerFactory,compilerDaemonManager,inProcessCompilerDaemonFactory);
  Compiler<GroovyJavaJointCompileSpec> delegatingCompiler=new DelegatingGroovyCompiler(groovyCompilerFactory);
  compiler=new CleaningGroovyCompiler(delegatingCompiler,getOutputs());
}
