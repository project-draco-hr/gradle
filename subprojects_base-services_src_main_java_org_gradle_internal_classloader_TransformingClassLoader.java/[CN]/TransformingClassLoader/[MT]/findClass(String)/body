{
  if (!shouldTransform(name)) {
    return super.findClass(name);
  }
  String resourceName=name.replace('.','/') + ".class";
  URL resource=findResource(resourceName);
  if (resource == null) {
    throw new ClassNotFoundException(name);
  }
  try {
    byte[] bytes=loadBytecode(resource);
    bytes=transform(name,bytes);
    String packageName=StringUtils.substringBeforeLast(name,".");
    Package p=getPackage(packageName);
    if (p == null) {
      definePackage(packageName,null,null,null,null,null,null,null);
    }
    URL codeBase=ClasspathUtil.getClasspathForResource(resource,resourceName).toURI().toURL();
    return defineClass(name,bytes,0,bytes.length,new CodeSource(codeBase,(Certificate[])null));
  }
 catch (  Exception e) {
    throw new GradleException(String.format("Could not load class '%s' from %s.",name,resource),e);
  }
}
