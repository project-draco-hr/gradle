{
  boolean stacktrace=startParameter != null && (startParameter.getShowStacktrace() != StartParameter.ShowStacktrace.INTERNAL_EXCEPTIONS || startParameter.getLogLevel() == LogLevel.DEBUG);
  if (stacktrace) {
    details.exception=ExceptionStyle.Sanitized;
  }
  boolean fullStacktrace=startParameter != null && (startParameter.getShowStacktrace() == StartParameter.ShowStacktrace.ALWAYS_FULL);
  if (fullStacktrace) {
    details.exception=ExceptionStyle.Full;
  }
  if (failure instanceof TaskSelectionException) {
    formatTaskSelectionFailure((TaskSelectionException)failure,details);
  }
 else {
    formatGenericFailure(failure,stacktrace,fullStacktrace,details);
  }
}
