{
  final ResourceOperation uploadOperation=createResourceOperation(destination.toString(),ResourceOperation.Type.upload,getClass(),contentLength);
  try {
    delegate.upload(new Factory<InputStream>(){
      public InputStream create(){
        return new ProgressLoggingInputStream(source.create(),uploadOperation);
      }
    }
,contentLength,destination);
  }
  finally {
    uploadOperation.completed();
  }
}
