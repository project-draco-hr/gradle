{
  ModelPath path=creator.getPath();
  if (path.getDepth() > 1) {
    throw new IllegalStateException("Creator at path " + path + " not supported, must be top level");
  }
  ModelNode node=modelGraph.find(path);
  if (node != null) {
    if (node.getState() == ModelNode.State.Known) {
      throw new DuplicateModelException(String.format("Cannot register model creation rule '%s' for path '%s' as the rule '%s' is already registered to create a model element at this path",toString(creator.getDescriptor()),path,toString(node.getDescriptor())));
    }
    throw new DuplicateModelException(String.format("Cannot register model creation rule '%s' for path '%s' as the rule '%s' is already registered (and the model element has been created)",toString(creator.getDescriptor()),path,toString(node.getDescriptor())));
  }
  node=modelGraph.addEntryPoint(path.getName(),creator.getDescriptor(),creator.getPromise(),creator.getAdapter());
  notifyCreationListeners(node);
  bind(creator);
}
