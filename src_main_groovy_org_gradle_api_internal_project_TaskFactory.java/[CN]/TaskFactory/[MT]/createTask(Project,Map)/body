{
  checkTaskArgsAndCreateDefaultValues(args);
  String name=args.get(Task.TASK_NAME).toString();
  if (!GUtil.isTrue(name)) {
    throw new InvalidUserDataException("The task name must be provided.");
  }
  Task task=createTaskObject(project,(Class)args.get(Task.TASK_TYPE),name);
  Object dependsOnTasks=args.get(Task.TASK_DEPENDS_ON);
  task.dependsOn(dependsOnTasks);
  Object description=args.get(Task.TASK_DESCRIPTION);
  if (description != null) {
    task.setDescription(description.toString());
  }
  Object action=args.get(Task.TASK_ACTION);
  if (action instanceof TaskAction) {
    TaskAction taskAction=(TaskAction)action;
    task.doFirst(taskAction);
  }
 else   if (action != null) {
    Closure closure=(Closure)action;
    task.doFirst(closure);
  }
  return task;
}
