{
  final JunitForkOptions forkOptions=options.getForkOptions();
  if (StringUtils.isNotEmpty(forkOptions.getJvm())) {
    javaForkOptions.executable(forkOptions.getJvm());
  }
  if (forkOptions.getDir() != null) {
    javaForkOptions.workingDir(forkOptions.getDir());
  }
  if (StringUtils.isNotEmpty(forkOptions.getMaxMemory())) {
    javaForkOptions.setMaxHeapSize(forkOptions.getMaxMemory());
  }
  final List<String> jvmArgs=forkOptions.getJvmArgs();
  if (jvmArgs != null && !jvmArgs.isEmpty()) {
    javaForkOptions.jvmArgs(jvmArgs);
  }
  if (forkOptions.isNewEnvironment()) {
    final Map<String,String> environment=forkOptions.getEnvironment();
    javaForkOptions.setEnvironment(environment);
  }
}
