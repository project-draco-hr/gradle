{
  final JunitForkOptions forkOptions=options.getForkOptions();
  if (StringUtils.isNotEmpty(forkOptions.getJvm())) {
    forkHandleBuilder.getCommand().execCommand(forkOptions.getJvm());
  }
  if (forkOptions.getDir() != null) {
    forkHandleBuilder.execDirectory(forkOptions.getDir());
  }
  if (StringUtils.isNotEmpty(forkOptions.getMaxMemory())) {
    forkHandleBuilder.jvmArguments("-Xmx=" + forkOptions.getMaxMemory());
  }
  final List<String> jvmArgs=forkOptions.getJvmArgs();
  if (jvmArgs != null && !jvmArgs.isEmpty()) {
    forkHandleBuilder.jvmArguments(jvmArgs);
  }
  if (forkOptions.isNewEnvironment()) {
    final Map<String,String> environment=forkOptions.getEnvironment();
    forkHandleBuilder.getCommand().setEnvironment(environment);
  }
}
