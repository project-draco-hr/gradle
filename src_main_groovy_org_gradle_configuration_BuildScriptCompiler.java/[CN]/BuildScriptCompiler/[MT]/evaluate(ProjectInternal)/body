{
  ScriptSource source=new ImportsScriptSource(project.getBuildScriptSource(),importsReader,project.getRootDir());
  ScriptProcessor processor=scriptProcessorFactory.createProcessor(source);
  processor.setClassloader(project.getClassLoaderProvider().getClassLoader());
  processor.setTransformer(new BuildScriptClasspathScriptTransformer());
  Script classPathScript=processor.process(ProjectScript.class);
  projectScriptMetaData.applyMetaData(classPathScript,project);
  project.getStandardOutputRedirector().on(LogLevel.QUIET);
  try {
    classPathScript.run();
  }
  finally {
    project.getStandardOutputRedirector().flush();
  }
  project.getClassLoaderProvider().updateClassPath();
  processor.setTransformer(new BuildScriptTransformer());
  Script buildScript=processor.process(ProjectScript.class);
  projectScriptMetaData.applyMetaData(buildScript,project);
  project.setBuildScript(buildScript);
}
