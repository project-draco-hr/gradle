{
  DefaultGradleConnector connector=getInternalConnector();
  connector.searchUpwards(false);
  connector.forProjectDirectory(projectDir);
  if (gradleUserHomeDir != null) {
    connector.useGradleUserHomeDir(gradleUserHomeDir);
  }
  if (daemonBaseDir != null) {
    connector.daemonBaseDir(daemonBaseDir);
  }
  return configureDistribution(connector).connect();
}
