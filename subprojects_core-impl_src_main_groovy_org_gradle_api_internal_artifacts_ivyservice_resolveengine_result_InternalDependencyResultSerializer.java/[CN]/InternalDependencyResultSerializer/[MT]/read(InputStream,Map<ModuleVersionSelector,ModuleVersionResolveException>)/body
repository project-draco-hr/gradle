{
  DataInputStream dataInput=new DataInputStream(instr);
  ModuleVersionSelector requested=new ModuleVersionSelectorSerializer().read((DataInput)dataInput);
  ModuleVersionSelectionReason reason=new ModuleVersionSelectionReasonSerializer().read((DataInput)dataInput);
  byte resultByte=dataInput.readByte();
  if (resultByte == SUCCESSFUL) {
    ModuleVersionSelection selected=new ModuleVersionSelectionSerializer().read((DataInput)dataInput);
    return new DefaultInternalDependencyResult(requested,selected,reason,null);
  }
 else   if (resultByte == FAILED) {
    ModuleVersionResolveException failure=failures.get(requested);
    return new DefaultInternalDependencyResult(requested,null,reason,failure);
  }
 else {
    throw new IllegalArgumentException("Unknown result byte: " + resultByte);
  }
}
