{
  context.checking(new Expectations(){
{
      one(delegate).createTask(projectInternal,options);
      will(returnValue(task));
      allowing(task).getExecuter();
      will(returnValue(delegateExecuter));
      one(task).setExecuter(with(reflectionEquals(new ExecutionShortCircuitTaskExecuter(delegateExecuter,repository))));
    }
  }
);
  assertThat(factory.createTask(projectInternal,options),sameInstance(task));
}
