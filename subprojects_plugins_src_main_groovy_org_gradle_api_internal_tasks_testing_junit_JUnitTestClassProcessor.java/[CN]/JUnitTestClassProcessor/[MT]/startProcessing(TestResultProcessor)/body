{
  ClassLoader applicationClassLoader=Thread.currentThread().getContextClassLoader();
  ListenerBroadcast<TestResultProcessor> processors=new ListenerBroadcast<TestResultProcessor>(TestResultProcessor.class);
  processors.add(new JUnitXmlReportGenerator(testResultsDir));
  processors.add(resultProcessor);
  TestResultProcessor resultProcessorChain=new AttachParentTestResultProcessor(new CaptureTestOutputTestResultProcessor(processors.getSource(),outputRedirector));
  TestClassExecutionEventGenerator eventGenerator=new TestClassExecutionEventGenerator(resultProcessorChain,idGenerator,timeProvider);
  JUnitTestEventAdapter junitEventAdapter=new JUnitTestEventAdapter(eventGenerator,timeProvider,idGenerator);
  executer=new JUnitTestClassExecuter(applicationClassLoader,junitEventAdapter,eventGenerator);
}
