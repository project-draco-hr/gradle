{
  DefaultGradleLauncher launcher=(DefaultGradleLauncher)buildController.getLauncher();
  if (runTasks) {
    launcher.addListener(new TasksCompletionListener(){
      public void onTasksFinished(      GradleInternal gradle){
        ToolingModelBuilder builder=getToolingModelBuilderRegistry(gradle).getBuilder(type);
        model=builder.buildAll(type,gradle.getDefaultProject());
      }
    }
);
    buildController.run();
  }
 else {
    launcher.addListener(new ModelConfigurationListener(){
      public void onConfigure(      GradleInternal gradle){
        ensureAllProjectsEvaluated(gradle);
        ToolingModelBuilder builder=getToolingModelBuilderRegistry(gradle).getBuilder(type);
        model=builder.buildAll(type,gradle.getDefaultProject());
      }
    }
);
    buildController.configure();
  }
  return (T)model;
}
