{
  final ClassLoader previousContextClassLoader=Thread.currentThread().getContextClassLoader();
  try {
    Thread.currentThread().setContextClassLoader(controlClassLoader);
    try {
      classToLaunch.getMethod("setSharedClassLoader",ClassLoader.class).invoke(forkExecuter,sharedClassLoader);
      classToLaunch.getMethod("setControlClassLoader",ClassLoader.class).invoke(forkExecuter,controlClassLoader);
      classToLaunch.getMethod("setSandboxClassLoader",ClassLoader.class).invoke(forkExecuter,sandboxClassLoader);
      classToLaunch.getMethod("setArguments",List.class).invoke(forkExecuter,arguments);
      classToLaunch.getMethod("execute").invoke(forkExecuter);
    }
 catch (    Throwable t) {
      throw new RuntimeException("failed to execute",t);
    }
  }
  finally {
    Thread.currentThread().setContextClassLoader(previousContextClassLoader);
  }
}
