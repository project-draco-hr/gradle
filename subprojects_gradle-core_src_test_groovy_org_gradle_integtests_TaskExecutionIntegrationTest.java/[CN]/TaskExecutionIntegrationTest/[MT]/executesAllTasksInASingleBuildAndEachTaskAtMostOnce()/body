{
  TestFile buildFile=testFile("build.gradle");
  buildFile.writelns("gradle.taskGraph.whenReady { assertFalse(project.hasProperty('graphReady')); graphReady = true }","task a << { task -> project.executedA = task }","task b << { ","    assertSame(a, project.executedA);","    assertTrue(gradle.taskGraph.hasTask(':a'))","}","task c(dependsOn: a)","task d(dependsOn: a)","task e(dependsOn: [a, d])");
  usingBuildFile(buildFile).withTasks("a","b").run().assertTasksExecuted(":a",":b");
  usingBuildFile(buildFile).withTasks("a","a").run().assertTasksExecuted(":a");
  usingBuildFile(buildFile).withTasks("c","a").run().assertTasksExecuted(":a",":c");
  usingBuildFile(buildFile).withTasks("c","e").run().assertTasksExecuted(":a",":c",":d",":e");
}
