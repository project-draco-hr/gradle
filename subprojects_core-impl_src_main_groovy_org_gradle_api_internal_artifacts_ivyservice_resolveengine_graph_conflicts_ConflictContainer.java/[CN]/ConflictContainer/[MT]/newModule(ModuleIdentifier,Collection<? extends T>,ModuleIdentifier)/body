{
  modules.put(newModule,candidates);
  if (replacedBy != null) {
    targetToSource.put(replacedBy,newModule);
    if (modules.containsKey(replacedBy)) {
      return registerConflict(newModule,replacedBy);
    }
  }
  ModuleIdentifier replacementSource=targetToSource.get(newModule);
  if (replacementSource != null) {
    return registerConflict(replacementSource,newModule);
  }
  if (candidates.size() > 1) {
    return registerConflict(newModule,null);
  }
  return null;
}
