{
  LOGGER.debug("Downloading {} to {}",resource.getName(),destination);
  if (destination.getParentFile() != null) {
    destination.getParentFile().mkdirs();
  }
  if (!(resource instanceof ExternalResource)) {
    throw new IllegalArgumentException("Can only download ExternalResource");
  }
  repository.downloadResource((ExternalResource)resource,destination);
  return destination.length();
}
