{
  visitor=new CopyVisitor(testDir,null,null,new FilterChain());
  visitor.visitDir(file(sourceDir,new RelativePath(false)));
  File rootFile=getResource("testfiles/rootfile.txt");
  File subDir=getResource("testfiles/subdir");
  File anotherFile=getResource("testfiles/subdir/anotherfile.txt");
  visitor.visitFile(file(rootFile,new RelativePath(true,rootFile.getName())));
  RelativePath subDirPath=new RelativePath(false,subDir.getName());
  visitor.visitDir(file(subDir,subDirPath));
  visitor.visitFile(file(anotherFile,new RelativePath(true,subDirPath,anotherFile.getName())));
  File targetRootFile=new File(testDir,rootFile.getName());
  assertTrue(targetRootFile.exists());
  File targetAnotherFile=new File(testDir,"subdir/" + anotherFile.getName());
  assertTrue(targetAnotherFile.exists());
}
