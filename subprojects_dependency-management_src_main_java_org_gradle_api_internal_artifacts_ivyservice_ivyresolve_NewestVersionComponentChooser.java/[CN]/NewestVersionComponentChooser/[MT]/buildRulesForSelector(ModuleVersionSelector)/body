{
  List<SpecRuleAction<? super ComponentSelection>> rules=Lists.newArrayList();
  if (versionMatcher.needModuleMetadata(requested.getVersion())) {
    rules.add(createAllSpecRulesAction(new MetadataVersionMatchingRule(requested.getVersion())));
  }
 else {
    rules.add(createAllSpecRulesAction(new SimpleVersionMatchingRule(requested.getVersion())));
  }
  rules.addAll(componentSelectionRules.getRules());
  return rules;
}
