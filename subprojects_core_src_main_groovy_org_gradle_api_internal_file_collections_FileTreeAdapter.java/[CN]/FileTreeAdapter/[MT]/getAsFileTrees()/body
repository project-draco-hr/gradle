{
  if (tree instanceof FileSystemMirroringFileTree) {
    FileSystemMirroringFileTree mirroringTree=(FileSystemMirroringFileTree)tree;
    if (visitAll()) {
      return Collections.singletonList(mirroringTree.getMirror());
    }
 else {
      return Collections.emptyList();
    }
  }
 else   if (tree instanceof DirectoryFileTree) {
    DirectoryFileTree fileTree=(DirectoryFileTree)tree;
    return Collections.singletonList(fileTree);
  }
  throw new UnsupportedOperationException(String.format("Cannot convert %s to a file system mirror.",tree));
}
