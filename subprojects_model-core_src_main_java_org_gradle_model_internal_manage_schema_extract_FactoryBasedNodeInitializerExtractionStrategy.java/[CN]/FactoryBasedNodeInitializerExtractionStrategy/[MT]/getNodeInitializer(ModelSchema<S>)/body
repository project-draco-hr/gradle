{
  if (schema instanceof ManagedImplStructSchema) {
    ManagedImplStructSchema<S> managedSchema=Cast.uncheckedCast(schema);
    return new FactoryBasedManagedNodeInitializer<T,S>(instanceFactory,managedSchema,schemaStore,proxyFactory,new Action<T>(){
      @Override public void execute(      T instance){
        configAction.execute(instance,schema);
      }
    }
);
  }
 else {
    return new FactoryBasedNodeInitializer<T,S>(instanceFactory,schema.getType());
  }
}
