{
  DefaultJavaCompileSpec spec=new DefaultJavaCompileSpec();
  spec.setSource(getSource());
  spec.setDestinationDir(getDestinationDir());
  spec.setWorkingDir(getProject().getProjectDir());
  spec.setTempDir(getTemporaryDir());
  spec.setClasspath(getClasspath());
  spec.setDependencyCacheDir(getDependencyCacheDir());
  final String targetCompatibility;
  final String sourceCompatibility;
  if (getTargetPlatform() != null) {
    targetCompatibility=getTargetPlatform().getTargetCompatibility().toString();
    if (getSourceCompatibility() != null) {
      sourceCompatibility=getSourceCompatibility();
    }
 else {
      sourceCompatibility=targetCompatibility;
    }
  }
 else {
    targetCompatibility=getTargetCompatibility();
    sourceCompatibility=getSourceCompatibility();
  }
  spec.setTargetCompatibility(targetCompatibility);
  spec.setSourceCompatibility(sourceCompatibility);
  spec.setCompileOptions(compileOptions);
  return spec;
}
