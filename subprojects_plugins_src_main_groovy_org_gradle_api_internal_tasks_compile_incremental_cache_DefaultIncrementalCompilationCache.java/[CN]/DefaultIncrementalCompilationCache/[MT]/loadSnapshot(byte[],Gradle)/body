{
synchronized (lock) {
    if (cache == null) {
      cache=cacheRepository.cache("jarSnapshots").withDisplayName("jar snapshots cache").withLockOptions(mode(FileLockManager.LockMode.None)).open();
    }
    PersistentIndexedCacheParameters<byte[],JarSnapshot> params=new PersistentIndexedCacheParameters<byte[],JarSnapshot>("jarSnapshots",byte[].class,JarSnapshot.class);
    theCache=cache.createCache(params);
  }
  return cache.useCache("Loading jar snapshot",new Factory<JarSnapshot>(){
    public JarSnapshot create(){
      return theCache.get(hash);
    }
  }
);
}
