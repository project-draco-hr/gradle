{
  Properties properties=new Properties();
  final TestFile propertiesFile=testDir.file("prop");
  GUtil.saveProperties(properties,propertiesFile);
  final URL url=propertiesFile.toURI().toURL();
  context.checking(new Expectations(){
{
      allowing(classLoader).getResource("META-INF/gradle-plugins/noImpl.properties");
      will(returnValue(url));
    }
  }
);
  try {
    pluginRegistry.loadPlugin("noImpl");
    fail();
  }
 catch (  PluginInstantiationException e) {
    assertThat(e.getMessage(),equalTo("No implementation class specified for plugin 'noImpl' in " + url + "."));
  }
}
