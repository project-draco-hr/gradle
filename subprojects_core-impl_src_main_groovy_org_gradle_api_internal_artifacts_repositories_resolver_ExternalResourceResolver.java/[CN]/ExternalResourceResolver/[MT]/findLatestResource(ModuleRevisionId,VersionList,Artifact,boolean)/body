{
  String name=getName();
  VersionMatcher versionMatcher=getVersionMatcher();
  for (  VersionList.ListedVersion listedVersion : versions.sortLatestFirst(getLatestStrategy())) {
    String version=listedVersion.getVersion();
    ModuleRevisionId foundMrid=ModuleRevisionId.newInstance(mrid,version);
    if (!versionMatcher.accept(mrid,foundMrid)) {
      LOGGER.debug(name + ": rejected by version matcher: " + version);
      continue;
    }
    boolean needsModuleDescriptor=versionMatcher.needModuleDescriptor(mrid,foundMrid);
    artifact=DefaultArtifact.cloneWithAnotherMrid(artifact,foundMrid);
    String resourcePath=listedVersion.getPattern().toPath(artifact);
    ExternalResource resource=getResource(resourcePath,artifact.getId(),forDownload || needsModuleDescriptor);
    String description=version + " [" + resource+ "]";
    if (!resource.exists()) {
      LOGGER.debug(name + ": unreachable: " + description);
      discardResource(resource);
      continue;
    }
    if (versionMatcher.needModuleDescriptor(mrid,foundMrid)) {
      ModuleVersionMetaData metaData=parseMetaDataArtifact(artifact,resource);
      if (metaData == null) {
        LOGGER.debug(name + ": impossible to get module descriptor resource: " + description);
        discardResource(resource);
        continue;
      }
      if (!versionMatcher.accept(mrid,metaData.getDescriptor())) {
        LOGGER.debug(name + ": md rejected by version matcher: " + description);
        discardResource(resource);
        continue;
      }
      return new DownloadedAndParsedMetaDataArtifact(resource,artifact,metaData);
    }
    return new ResolvedArtifact(resource,artifact);
  }
  return null;
}
