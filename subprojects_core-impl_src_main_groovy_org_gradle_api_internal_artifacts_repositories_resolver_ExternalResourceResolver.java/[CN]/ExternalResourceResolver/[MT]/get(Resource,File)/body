{
  LOGGER.debug("Downloading {} to {}",resource.getName(),destination);
  if (destination.getParentFile() != null) {
    GFileUtils.mkdirs(destination.getParentFile());
  }
  if (!(resource instanceof ExternalResource)) {
    throw new IllegalArgumentException("Can only download ExternalResource");
  }
  ExternalResource externalResource=(ExternalResource)resource;
  try {
    externalResource.writeTo(destination);
  }
  finally {
    externalResource.close();
  }
}
