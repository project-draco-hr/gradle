{
  ModuleRevisionId revisionId=dependencyDescriptor.getDependencyRevisionId();
  String requestedVersion=revisionId.getRevision();
  String name=getName();
  for (  VersionList.ListedVersion listedVersion : versions.sortLatestFirst(latestStrategy)) {
    String foundVersion=listedVersion.getVersion();
    boolean needsMetadata=versionMatcher.needModuleMetadata(requestedVersion);
    if (!needsMetadata && !versionMatcher.accept(requestedVersion,foundVersion)) {
      LOGGER.debug(name + ": rejected by version matcher: " + foundVersion);
      continue;
    }
    ModuleRevisionId candidateModuleVersionId=IvyUtil.createModuleRevisionId(revisionId.getOrganisation(),revisionId.getName(),foundVersion,null);
    DownloadedAndParsedMetaDataArtifact resolvedResource=findMetaDataFileUsingAnyPattern(candidateModuleVersionId);
    if (resolvedResource == null) {
      resolvedResource=findDefaultArtifactUsingAnyPattern(dependencyDescriptor,candidateModuleVersionId);
      if (resolvedResource == null) {
        continue;
      }
    }
    if (needsMetadata) {
      if (!versionMatcher.accept(requestedVersion,resolvedResource.moduleVersionMetaData)) {
        LOGGER.debug(name + ": md rejected by version matcher: " + resolvedResource.getResource());
        discardResource(resolvedResource.getResource());
        continue;
      }
    }
    return resolvedResource;
  }
  return null;
}
