{
  Type superclass=getClass().getGenericSuperclass();
  checkArgument(superclass instanceof ParameterizedType,"%s isn't parameterized",superclass);
  @SuppressWarnings("ConstantConditions") Type captured=((ParameterizedType)superclass).getActualTypeArguments()[0];
  if (captured instanceof Class) {
    this.typeToken=Cast.uncheckedCast(TypeToken.of(captured));
  }
 else {
    this.typeToken=Cast.uncheckedCast(TypeToken.of(clazz).resolveType(captured));
  }
}
