{
  final OutputFilesSnapshot other=(OutputFilesSnapshot)oldSnapshot;
  DiffUtil.diff(rootFileIds,other.rootFileIds,new ChangeListener<Map.Entry<String,Long>>(){
    public void added(    Map.Entry<String,Long> element){
      listener.added(new File(element.getKey()));
    }
    public void removed(    Map.Entry<String,Long> element){
      listener.removed(new File(element.getKey()));
    }
    public void changed(    Map.Entry<String,Long> element){
      if (other.rootFileIds.get(element.getKey()) == null) {
        return;
      }
      listener.changed(new File(element.getKey()));
    }
  }
);
  filesSnapshot.changesSince(other.filesSnapshot,new ChangeListener<File>(){
    public void added(    File element){
    }
    public void removed(    File element){
      listener.removed(element);
    }
    public void changed(    File element){
      listener.changed(element);
    }
  }
);
}
