{
  for (  MavenArtifactRepository repository : extension.getRepositories().withType(MavenArtifactRepository.class)) {
    String repositoryName=repository.getName();
    String publishTaskName=String.format("publish%sPublicationTo%sRepository",capitalize(publicationName),capitalize(repositoryName));
    PublishToMavenRepository publishTask=tasks.create(publishTaskName,PublishToMavenRepository.class);
    publishTask.setPublication(publication);
    publishTask.setRepository(repository);
    publishTask.setGroup(PublishingPlugin.PUBLISH_TASK_GROUP);
    publishTask.setDescription(String.format("Publishes Maven publication '%s' to Maven repository '%s'.",publicationName,repositoryName));
    publishLifecycleTask.dependsOn(publishTask);
  }
}
