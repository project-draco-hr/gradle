{
  testFrameworkDetector.setTestClassProcessor(testClassProcessor);
  final FileSet testClassFileSet=new FileSet(testClassDirectory,null);
  if (!scanForTestClasses) {
    if (includePatterns.isEmpty()) {
      includePatterns.add("**/*Tests.class");
      includePatterns.add("**/*Test.class");
    }
    if (excludePatterns.isEmpty()) {
      excludePatterns.add("**/Abstract*.class");
    }
  }
  testClassFileSet.include(includePatterns);
  testClassFileSet.exclude(excludePatterns);
  testClassFileSet.visit(new EmptyFileVisitor(){
    public void visitFile(    FileVisitDetails fileDetails){
      final File file=fileDetails.getFile();
      if (file.getAbsolutePath().endsWith(".class")) {
        testFrameworkDetector.processTestClass(file);
      }
    }
  }
);
}
