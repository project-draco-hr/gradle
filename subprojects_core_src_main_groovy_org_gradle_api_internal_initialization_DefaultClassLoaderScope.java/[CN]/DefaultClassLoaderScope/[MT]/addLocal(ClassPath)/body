{
  if (locked) {
    throw new IllegalStateException("class loader scope is locked");
  }
  if (!classpath.isEmpty()) {
    if (local == null) {
      local=new ArrayList<ClassLoader>(1);
    }
    ClassLoader newClassLoader=classLoaderCache.get(base.getChildClassLoader(),classpath,null);
    local.add(newClassLoader);
    if (localClassLoader != null) {
      addLocal(newClassLoader);
    }
    return newClassLoader;
  }
 else {
    return base.getChildClassLoader();
  }
}
