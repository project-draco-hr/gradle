{
  try {
    for (    Map.Entry<File,Writer> entry : openFiles.entrySet()) {
      close(entry.getValue(),entry.getKey().toString());
    }
  }
 catch (  IOException e) {
    cleanUpQuietly();
    throw new UncheckedIOException("Problems closing all files.",e);
  }
 finally {
    openFiles.clear();
  }
}
