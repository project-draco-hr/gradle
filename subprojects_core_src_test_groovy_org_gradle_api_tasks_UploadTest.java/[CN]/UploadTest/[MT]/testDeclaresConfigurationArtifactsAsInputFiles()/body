{
  assertThat(upload.getArtifacts(),nullValue());
  upload.setConfiguration(configurationMock);
  final PublishArtifactSet artifacts=context.mock(PublishArtifactSet.class);
  final FileCollection files=context.mock(FileCollection.class);
  context.checking(new Expectations(){
{
      one(configurationMock).getAllArtifacts();
      will(returnValue(artifacts));
      one(artifacts).getFiles();
      will(returnValue(files));
    }
  }
);
  assertThat(upload.getArtifacts(),sameInstance(files));
}
