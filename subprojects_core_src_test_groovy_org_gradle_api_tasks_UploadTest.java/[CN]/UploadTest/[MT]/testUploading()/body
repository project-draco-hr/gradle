{
  final File descriptorDestination=new File("somePath");
  upload.setUploadDescriptor(true);
  upload.setDescriptorDestination(descriptorDestination);
  upload.setConfiguration(configurationMock);
  upload.setArtifactPublisher(artifactPublisherMock);
  context.checking(new Expectations(){
{
      one(configurationMock).getModule();
      will(returnValue(moduleMock));
      one(configurationMock).getHierarchy();
      will(returnValue(Collections.emptySet()));
      one(artifactPublisherMock).publish(moduleMock,Collections.<Configuration>emptySet(),descriptorDestination,null);
    }
  }
);
  upload.upload();
}
