{
  TaskInternal task=taskInfo.getTask();
  TaskStateInternal state=task.getState();
synchronized (lock) {
    state.setStartTime(System.currentTimeMillis());
    taskListener.beforeExecute(task);
  }
  try {
    task.executeWithoutThrowingTaskFailure();
  }
  finally {
synchronized (lock) {
      state.setEndTime(System.currentTimeMillis());
      taskListener.afterExecute(task,state);
    }
  }
}
