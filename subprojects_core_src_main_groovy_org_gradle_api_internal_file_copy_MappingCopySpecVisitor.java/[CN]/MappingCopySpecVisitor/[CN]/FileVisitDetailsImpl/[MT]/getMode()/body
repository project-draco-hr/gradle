{
  if (mode != null) {
    return mode;
  }
  Integer specMode=fileDetails.isDirectory() ? spec.getDirMode() : spec.getFileMode();
  if (specMode != null) {
    return specMode;
  }
  return fileDetails.getMode();
}
