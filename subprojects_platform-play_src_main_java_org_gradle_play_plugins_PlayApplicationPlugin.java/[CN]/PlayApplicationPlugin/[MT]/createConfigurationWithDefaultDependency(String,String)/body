{
  final Configuration configuration=project.getConfigurations().create(configurationName);
  configuration.setVisible(false);
  configuration.getIncoming().beforeResolve(new Action<ResolvableDependencies>(){
    public void execute(    ResolvableDependencies resolvableDependencies){
      DependencySet dependencies=configuration.getDependencies();
      if (dependencies.isEmpty()) {
        dependencies.add(project.getDependencies().create(defaultDependency));
      }
    }
  }
);
  return configuration;
}
