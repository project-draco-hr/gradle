{
  for (  final PipelineSplitWorker pipelineSplitWorker : runningWorkers) {
    pipelineSplitWorker.stopConsuming();
  }
  ThreadUtils.interleavedConditionWait(runningWorkersLock,allWorkersStopped,100L,TimeUnit.MILLISECONDS,new ConditionWaitHandle(){
    public boolean checkCondition(){
      return runningWorkers.isEmpty();
    }
    public void conditionMatched(){
      ThreadUtils.shutdown(pipelineSplitThreadPool);
    }
  }
);
}
