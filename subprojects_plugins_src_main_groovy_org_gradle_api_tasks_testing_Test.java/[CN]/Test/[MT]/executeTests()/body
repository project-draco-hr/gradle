{
  TestSummaryListener listener=new TestSummaryListener(LoggerFactory.getLogger(Test.class));
  addTestListener(listener);
  addTestListener(new TestLogger(getServices().get(ProgressLoggerFactory.class)));
  addTestOutputListener(new StandardStreamsLogger(Logging.getLogger(Test.class),testLogging));
  TestResultProcessor resultProcessor=new TestListenerAdapter(getTestListenerBroadcaster().getSource(),testOutputListenerBroadcaster.getSource());
  testExecuter.execute(this,resultProcessor);
  testFramework.report();
  testFramework=null;
  if (!getIgnoreFailures() && listener.hadFailures()) {
    throw new GradleException("There were failing tests. See the report at " + getTestReportDir() + ".");
  }
}
