{
  ArgWriter argsWriter=ArgWriter.windowsStyle(writer);
  argsWriter.args("/nologo");
  argsWriter.args("/EHsc");
  argsWriter.args("/Fe" + spec.getOutputFile().getAbsolutePath());
  if (spec instanceof LibraryCompileSpec) {
    argsWriter.args("/LD");
  }
  for (  File file : spec.getIncludeRoots()) {
    argsWriter.args("/I",file.getAbsolutePath());
  }
  for (  File file : spec.getSource()) {
    argsWriter.args(file);
  }
  for (  File file : spec.getLibs()) {
    argsWriter.args("/link",file.getAbsolutePath().replaceFirst("\\.dll$",".lib"));
  }
}
