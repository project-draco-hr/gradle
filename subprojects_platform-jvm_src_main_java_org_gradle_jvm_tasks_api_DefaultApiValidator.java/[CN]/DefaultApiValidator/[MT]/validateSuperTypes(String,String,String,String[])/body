{
  String className=convertInternalNameToClassName(name);
  String superClassName=convertInternalNameToClassName(superName);
  if (!memberOfApiChecker.belongsToApi(superClassName)) {
    throw new InvalidPublicAPIException(String.format("'%s' extends '%s' and its package is not one of the allowed packages.",className,superClassName));
  }
  Set<String> invalidReferencedTypes=invalidReferencedTypes(signature);
  if (!invalidReferencedTypes.isEmpty()) {
    if (invalidReferencedTypes.size() == 1) {
      throw new InvalidPublicAPIException(String.format("'%s' references disallowed API type '%s' in superclass or interfaces.",className,invalidReferencedTypes.iterator().next()));
    }
 else {
      StringBuilder sb=new StringBuilder("The following types are referenced in ");
      sb.append(className);
      sb.append(" superclass but their package don't belong to the allowed packages:\n");
      for (      String invalidReferencedType : invalidReferencedTypes) {
        sb.append("   - ").append(invalidReferencedType).append("\n");
      }
      throw new InvalidPublicAPIException(sb.toString());
    }
  }
  if (interfaces != null) {
    for (    String intf : interfaces) {
      String interfaceName=convertInternalNameToClassName(intf);
      if (!memberOfApiChecker.belongsToApi(interfaceName)) {
        throw new InvalidPublicAPIException(String.format("'%s' declares interface '%s' and its package is not one of the allowed packages.",className,interfaceName));
      }
    }
  }
}
