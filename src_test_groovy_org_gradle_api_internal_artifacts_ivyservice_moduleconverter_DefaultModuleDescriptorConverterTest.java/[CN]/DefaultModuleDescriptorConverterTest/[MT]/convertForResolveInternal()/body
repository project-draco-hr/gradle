{
  final Configuration configurationStub=context.mock(Configuration.class,"conf");
  Map moduleRegistryDummy=WrapUtil.toMap("key",context.mock(ModuleDescriptor.class));
  context.checking(new Expectations(){
{
      allowing(configurationStub).getHierarchy();
      will(returnValue(new ArrayList(configurationsDummy)));
    }
  }
);
  commonSetUp();
  defineCommonExpectations(configurationsDummy,moduleRegistryDummy);
  DefaultModuleDescriptor actualModuleDescriptor=(DefaultModuleDescriptor)moduleDescriptorConverter.convertForResolve(configurationStub,moduleDummy,moduleRegistryDummy);
  assertThat(actualModuleDescriptor,equalTo(moduleDescriptorDummy));
}
