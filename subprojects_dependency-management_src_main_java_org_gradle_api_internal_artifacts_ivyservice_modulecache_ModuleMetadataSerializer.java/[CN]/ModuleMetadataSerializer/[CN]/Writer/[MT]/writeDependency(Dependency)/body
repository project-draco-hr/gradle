{
  ModuleVersionSelector selector=dep.getRequested();
  writeString(selector.getGroup());
  writeString(selector.getName());
  writeString(selector.getVersion());
  if (dep instanceof IvyDependency) {
    encoder.writeByte(TYPE_IVY);
    writeString(dep.getDynamicConstraintVersion());
    writeBoolean(dep.isForce());
    writeBoolean(dep.isChanging());
    writeBoolean(dep.isTransitive());
  }
 else   if (dep instanceof MavenDependency) {
    MavenDependency mavenDependency=(MavenDependency)dep;
    encoder.writeByte(TYPE_MAVEN);
    encoder.writeSmallInt(mavenDependency.getScope().ordinal());
  }
 else {
    throw new IllegalStateException("Unexpected dependency type");
  }
  writeDependencyConfigurationMapping(dep);
  writeArtifacts(dep.getDependencyArtifacts());
  writeExcludeRules(dep.getDependencyExcludes());
}
