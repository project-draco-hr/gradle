{
  if (metadata instanceof IvyModuleResolveMetadata) {
    encoder.writeByte(TYPE_IVY);
  }
 else   if (metadata instanceof MavenModuleResolveMetadata) {
    MavenModuleResolveMetadata mavenMetadata=(MavenModuleResolveMetadata)metadata;
    encoder.writeByte(TYPE_MAVEN);
    writeNullableString(mavenMetadata.getSnapshotTimestamp());
    writeNullableString(mavenMetadata.getPackaging());
    writeBoolean(mavenMetadata.isRelocated());
  }
 else {
    throw new IllegalArgumentException("Unexpected metadata type: " + metadata.getClass());
  }
}
