{
  ModuleVersionSelector requested=DefaultModuleVersionSelector.newSelector(readString(),readString(),readString());
  byte type=decoder.readByte();
switch (type) {
case TYPE_IVY:
    ListMultimap<String,String> configMappings=readDependencyConfigurationMapping();
  List<Artifact> artifacts=readDependencyArtifactDescriptors();
List<Exclude> excludes=readExcludeRules();
String dynamicConstraintVersion=readString();
boolean force=readBoolean();
boolean changing=readBoolean();
boolean transitive=readBoolean();
md.addDependency(new IvyDependencyMetadata(requested,dynamicConstraintVersion,force,changing,transitive,configMappings,artifacts,excludes));
break;
case TYPE_MAVEN:
configMappings=readDependencyConfigurationMapping();
artifacts=readDependencyArtifactDescriptors();
excludes=readExcludeRules();
MavenScope scope=MavenScope.values()[decoder.readSmallInt()];
md.addDependency(new MavenDependencyMetadata(scope,requested,configMappings,artifacts,excludes));
break;
default :
throw new IllegalArgumentException("Unexpected dependency type found.");
}
}
