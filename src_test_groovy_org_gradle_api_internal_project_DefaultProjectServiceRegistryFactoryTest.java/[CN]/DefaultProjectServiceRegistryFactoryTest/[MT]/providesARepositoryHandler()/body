{
  final RepositoryHandler repositoryHandler=context.mock(RepositoryHandler.class);
  context.checking(new Expectations(){
{
      one(repositoryHandlerFactory).createRepositoryHandler(with(any(Convention.class)));
      will(returnValue(repositoryHandler));
    }
  }
);
  ProjectServiceRegistry registry=factory.create(project);
  assertThat(registry.get(RepositoryHandler.class),sameInstance(repositoryHandler));
  assertThat(registry.get(RepositoryHandler.class),sameInstance(registry.get(RepositoryHandler.class)));
}
