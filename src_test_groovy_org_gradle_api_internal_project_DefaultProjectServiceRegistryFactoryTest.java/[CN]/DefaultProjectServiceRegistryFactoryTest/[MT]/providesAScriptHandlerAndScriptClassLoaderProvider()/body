{
  expectConfigurationHandlerCreated();
  context.checking(new Expectations(){
{
      BuildInternal build=context.mock(BuildInternal.class);
      allowing(project).getBuild();
      will(returnValue(build));
      allowing(build).getBuildScriptClassLoader();
      will(returnValue(null));
      ignoring(configurationHandler);
    }
  }
);
  ProjectServiceRegistry registry=factory.create(project);
  assertThat(registry.get(ScriptHandler.class),instanceOf(DefaultScriptHandler.class));
  assertThat(registry.get(ScriptHandler.class),sameInstance(registry.get(ScriptHandler.class)));
  assertThat(registry.get(ScriptClassLoaderProvider.class),sameInstance((Object)registry.get(ScriptHandler.class)));
}
