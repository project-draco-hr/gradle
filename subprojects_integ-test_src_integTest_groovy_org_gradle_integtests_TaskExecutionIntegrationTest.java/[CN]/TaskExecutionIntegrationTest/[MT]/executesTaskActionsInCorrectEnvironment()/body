{
  TestFile buildFile=testFile("build.gradle");
  buildFile.writelns("task a << { assert Thread.currentThread().contextClassLoader == getClass().classLoader }","task b(type: CustomTask)","class CustomTask extends DefaultTask { @TaskAction def go() { assert Thread.currentThread().contextClassLoader == getClass().classLoader } } ","task c; c.doLast new Action<Task>() { void execute(Task t) { assert Thread.currentThread().contextClassLoader == getClass().classLoader } }");
  usingBuildFile(buildFile).withTasks("a","b","c").run();
}
