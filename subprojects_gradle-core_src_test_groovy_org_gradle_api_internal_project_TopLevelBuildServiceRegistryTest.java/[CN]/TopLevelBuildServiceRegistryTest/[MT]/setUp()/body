{
  startParameter.setGradleUserHomeDir(tmpDir.getDir());
  context.checking(new Expectations(){
{
      allowing(parent).get(CacheFactory.class);
      will(returnValue(cacheFactory));
      allowing(parent).get(ClassPathRegistry.class);
      will(returnValue(classPathRegistry));
      allowing(parent).get(ClassLoaderFactory.class);
      will(returnValue(classLoaderFactory));
    }
  }
);
}
