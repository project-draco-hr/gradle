{
  project.getTasks().withType(Compile.class).allTasks(new Action<Compile>(){
    public void execute(    Compile compile){
      compile.setClasspath(project.getConfigurations().getByName(COMPILE_CONFIGURATION_NAME));
      compile.getConventionMapping().map(DefaultConventionsToPropertiesMapping.COMPILE);
      addDependsOnProjectBuildDependencies(compile,COMPILE_CONFIGURATION_NAME);
    }
  }
);
  project.getTasks().add(COMPILE_TASK_NAME,Compile.class).setDescription("Compiles the Java source code.");
}
