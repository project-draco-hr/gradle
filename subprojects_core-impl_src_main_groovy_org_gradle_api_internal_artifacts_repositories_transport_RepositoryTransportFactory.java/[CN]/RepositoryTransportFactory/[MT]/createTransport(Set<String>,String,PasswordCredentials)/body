{
  if (!WrapUtil.toSet("http","https","file","sftp").containsAll(schemes)) {
    throw new InvalidUserDataException("You may only specify 'file', 'http', 'https' and 'sftp' urls for a repository.");
  }
  if (WrapUtil.toSet("http","https").containsAll(schemes)) {
    return createHttpTransport(name,credentials);
  }
  if (WrapUtil.toSet("file").containsAll(schemes)) {
    return createFileTransport(name);
  }
  if (WrapUtil.toSet("sftp").containsAll(schemes)) {
    return createSftpTransport(name,credentials);
  }
  throw new InvalidUserDataException("You cannot mix different url schemes for a single repository. Please declare separate repositories.");
}
