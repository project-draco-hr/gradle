{
  ModuleDescriptor moduleDescriptor=createAnonymousModuleDescriptor();
  prepareTestsThatRetrieveDependencies(moduleDescriptor);
  prepareResolveReport();
  context.checking(new Expectations(){
{
      allowing(ivyReportConverterStub).convertReport(resolveReportMock,configurationStub);
    }
  }
);
  ResolvedConfiguration configuration=ivyDependencyResolver.resolve(configurationStub,ivyStub,moduleDescriptor);
  assertFalse(configuration.hasError());
  configuration.rethrowFailure();
}
