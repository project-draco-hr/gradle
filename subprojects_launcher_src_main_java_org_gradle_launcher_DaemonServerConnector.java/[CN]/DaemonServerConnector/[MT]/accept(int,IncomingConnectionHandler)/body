{
  DefaultExecutorFactory executorFactory=new DefaultExecutorFactory();
  TcpIncomingConnector<Object> incomingConnector=new TcpIncomingConnector<Object>(executorFactory,new DefaultMessageSerializer<Object>(getClass().getClassLoader()),new InetAddressFactory(),new UUIDGenerator());
  final DaemonRegistry.Entry registryEntry=daemonRegistry.newEntry();
  final CompletionHandler finished=new CompletionHandler(idleTimeout,registryEntry);
  LOGGER.lifecycle("Awaiting requests.");
  Action<ConnectEvent<Connection<Object>>> connectEvent=new Action<ConnectEvent<Connection<Object>>>(){
    public void execute(    ConnectEvent<Connection<Object>> connectionConnectEvent){
      handler.handle(connectionConnectEvent.getConnection(),finished);
    }
  }
;
  Address address=incomingConnector.accept(connectEvent,false);
  registryEntry.store(address);
  boolean stopped=finished.awaitStop();
  if (!stopped) {
    LOGGER.lifecycle("Time-out waiting for requests. Stopping.");
  }
  registryEntry.remove();
  new CompositeStoppable(incomingConnector,executorFactory).stop();
}
