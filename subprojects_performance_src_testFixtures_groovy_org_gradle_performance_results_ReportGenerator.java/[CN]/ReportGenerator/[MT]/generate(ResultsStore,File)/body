{
  try {
    File outputFile=new File(outputDirectory,"index.html");
    GFileUtils.parentMkdirs(outputFile);
    Writer writer=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(outputFile),"UTF-8"));
    try {
      new Html(writer){
{
          html();
          head();
          meta().httpEquiv("Content-Type").content("text/html; charset=utf-8");
          style().text("body { font-family: sans-serif; } ").end();
          title().text("Profile report").end();
          end();
          body();
          div().id("content");
          DateFormat format=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss z");
          format.setTimeZone(TimeZone.getTimeZone("UTC"));
          table();
          for (          String testName : store.getTestNames()) {
            for (            PerformanceResults performanceResults : store.getTestResults(testName)) {
              tr();
              td().text(format.format(new Date(performanceResults.getTestTime()))).end();
              td().text(performanceResults.getDisplayName()).end();
              td().text(performanceResults.getCurrent().avgTime().format()).end();
              td().text(performanceResults.getCurrent().avgMemory().format()).end();
              end();
            }
          }
          end();
          end();
          div().id("footer").text(String.format("Generated by %s",GradleVersion.current()));
          end();
          endAll();
        }
      }
;
    }
  finally {
      writer.close();
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(String.format("Could not generate performance test report to '%s'.",outputDirectory),e);
  }
}
