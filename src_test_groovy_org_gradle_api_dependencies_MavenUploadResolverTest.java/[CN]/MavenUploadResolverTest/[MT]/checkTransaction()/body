{
  context.checking(new Expectations(){
{
      allowing(deployTaskFactoryMock).createDeployTask();
      will(returnValue(deployTaskMock));
      allowing(deployTaskMock).getContainer();
      will(returnValue(plexusContainerMock));
      for (      File protocolProviderJar : TEST_PROTOCOL_PROVIDER_JARS) {
        one(plexusContainerMock).addJarResource(protocolProviderJar);
      }
      one(deployTaskMock).addRemoteRepository(testRepository);
      one(deployTaskMock).addRemoteSnapshotRepository(testSnapshotRepository);
      one(deployTaskMock).setFile(TEST_JAR_FILE);
      one(deployTaskMock).addPom(with(pomMatcher(TEST_POM_FILE)));
      one(deployTaskMock).setProject(with(any(Project.class)));
      one(deployTaskMock).execute();
    }
  }
);
  mavenUploadResolver.commitPublishTransaction();
}
