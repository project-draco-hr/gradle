{
  Action<DependencySubstitution> dependencySubstitutionRule=Actions.composite(resolutionStrategy.getDependencySubstitutionRule(),globalRules.getDependencySubstitutionRule());
  DependencyToComponentIdResolver componentIdResolver=new DependencySubstitutionResolver(componentSource.getComponentIdResolver(),dependencySubstitutionRule);
  ComponentMetaDataResolver componentMetaDataResolver=new ClientModuleResolver(componentSource.getComponentResolver(),dependencyDescriptorFactory);
  DependencyToConfigurationResolver dependencyToConfigurationResolver=new DefaultDependencyToConfigurationResolver();
  ResolveContextToComponentResolver requestResolver=createResolveContextConverter();
  ConflictHandler conflictHandler=createConflictHandler(resolutionStrategy,globalRules);
  return new DependencyGraphBuilder(componentIdResolver,componentMetaDataResolver,requestResolver,dependencyToConfigurationResolver,conflictHandler);
}
