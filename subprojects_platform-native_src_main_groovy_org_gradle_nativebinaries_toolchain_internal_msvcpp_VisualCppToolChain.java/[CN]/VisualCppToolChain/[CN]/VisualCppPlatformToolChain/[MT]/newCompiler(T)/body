{
  if (spec instanceof CppCompileSpec) {
    return (Compiler)createCppCompiler();
  }
  if (spec instanceof CCompileSpec) {
    return (Compiler)createCCompiler();
  }
  if (spec instanceof ObjectiveCppCompileSpec) {
    throw new RuntimeException("Objective-C++ is not available on the Visual C++ toolchain");
  }
  if (spec instanceof ObjectiveCCompileSpec) {
    throw new RuntimeException("Objective-C is not available on the Visual C++ toolchain");
  }
  if (spec instanceof WindowsResourceCompileSpec) {
    return (Compiler)createWindowsResourceCompiler();
  }
  if (spec instanceof AssembleSpec) {
    return (Compiler)createAssembler();
  }
  if (spec instanceof LinkerSpec) {
    return (Compiler)createLinker();
  }
  if (spec instanceof StaticLibraryArchiverSpec) {
    return (Compiler)createStaticLibraryArchiver();
  }
  throw new IllegalArgumentException(String.format("Don't know how to compile from a spec of type %s.",spec.getClass().getSimpleName()));
}
