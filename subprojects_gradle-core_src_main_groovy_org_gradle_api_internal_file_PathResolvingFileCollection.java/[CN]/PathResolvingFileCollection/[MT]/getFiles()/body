{
  Set<File> result=new LinkedHashSet<File>();
  for (  Object element : resolveToFilesAndFileCollections()) {
    if (element instanceof FileCollection) {
      FileCollection collection=(FileCollection)element;
      result.addAll(collection.getFiles());
    }
 else {
      result.add((File)element);
    }
  }
  return result;
}
