{
  List<FileTree> trees=new ArrayList<FileTree>();
  for (  Object element : resolveToFilesAndFileCollections()) {
    if (element instanceof FileCollection) {
      FileCollection fileCollection=(FileCollection)element;
      trees.add(fileCollection.getAsFileTree());
    }
 else {
      File file=(File)element;
      if (file.isFile()) {
        trees.add(new FlatFileTree(file));
      }
 else       if (file.isDirectory()) {
        trees.add(new FileSet(file,resolver));
      }
    }
  }
  return trees;
}
