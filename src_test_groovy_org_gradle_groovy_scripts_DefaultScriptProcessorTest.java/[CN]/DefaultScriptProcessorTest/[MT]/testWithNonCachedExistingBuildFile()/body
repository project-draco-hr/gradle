{
  createBuildScriptFile();
  context.checking(new Expectations(){
{
      one(scriptHandlerMock).loadFromCache(testScriptFile.lastModified(),testClassLoader,TEST_SCRIPT_NAME,testCacheDir);
      will(returnValue(null));
      one(scriptHandlerMock).writeToCache(TEST_SCRIPT_TEXT + System.getProperty("line.separator") + TEST_SCRIPT_ATACHEMENT,testClassLoader,TEST_SCRIPT_NAME,testCacheDir,expectedScriptBaseClass);
      will(returnValue(expectedScript));
    }
  }
);
  assertSame(expectedScript,scriptProcessor.createScriptFromFile(testCacheDir,testScriptFile,TEST_SCRIPT_ATACHEMENT,CacheUsage.ON,testClassLoader,expectedScriptBaseClass));
}
