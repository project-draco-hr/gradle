{
  TestFile buildFile=testFile("build.gradle");
  buildFile.writelns("build.taskGraph.whenReady { assertFalse(project.hasProperty('graphReady')); graphReady = true }","createTask('a') { task -> project.executedA = task }","createTask('b') { ","    assertSame(a, project.executedA);","    assertTrue(build.taskGraph.hasTask(':a'))","}","createTask('c', dependsOn: 'a')","createTask('d', dependsOn: 'a')","createTask('e', dependsOn: ['a', 'd'])");
  usingBuildFile(buildFile).withTasks("a","b").run().assertTasksExecuted(":a",":b");
  usingBuildFile(buildFile).withTasks("a","a").run().assertTasksExecuted(":a");
  usingBuildFile(buildFile).withTasks("c","a").run().assertTasksExecuted(":a",":c");
  usingBuildFile(buildFile).withTasks("c","e").run().assertTasksExecuted(":a",":c",":d",":e");
}
