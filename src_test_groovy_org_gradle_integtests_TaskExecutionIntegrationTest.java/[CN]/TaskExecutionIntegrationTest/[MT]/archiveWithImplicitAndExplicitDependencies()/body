{
  testFile("settings.gradle").write("include ('a', 'b')");
  testFile("a/build.gradle").writelns("dependsOn(':b')","createTask('libs', type: org.gradle.api.tasks.bundling.Bundle)","version = 'none'","libs.defaultArchiveTypes = org.gradle.api.plugins.JavaPluginConvention.DEFAULT_ARCHIVE_TYPES","libs {","    zip() {","        destinationDir = file('something.zip')","        files(file('src'))","    }","}","libs.dependsOn('compile')","createTask('compile')");
  testFile("b/build.gradle").writelns("createTask('libs')","createTask('archive_zip')");
  usingBuildFile(testFile("build.gradle")).withTasks("a:archive_zip").run().assertTasksExecuted(":a:compile","b:archive_zip","a:archive_zip");
  usingBuildFile(testFile("build.gradle")).withTasks("a:libs").run().assertTasksExecuted(":a:compile","b:archive_zip","b:libs","a:archive_zip");
}
