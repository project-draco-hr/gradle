{
  if (other == this) {
    return this;
  }
  if (other == ALL_SPEC) {
    return other;
  }
  if (this == ALL_SPEC) {
    return this;
  }
  List<ModuleVersionSpec> specs=new ArrayList<ModuleVersionSpec>();
  unpackUnion(specs);
  ((ModuleVersionSpec)other).unpackUnion(specs);
  for (int i=0; i < specs.size(); ) {
    ModuleVersionSpec spec=specs.get(i);
    ModuleVersionSpec merged=null;
    for (int j=i + 1; j < specs.size(); j++) {
      merged=spec.doUnion(specs.get(j));
      if (merged != null) {
        specs.remove(j);
        break;
      }
    }
    if (merged != null) {
      specs.set(i,merged);
    }
 else {
      i++;
    }
  }
  if (specs.size() == 1) {
    return specs.get(0);
  }
  return new UnionSpec(specs);
}
