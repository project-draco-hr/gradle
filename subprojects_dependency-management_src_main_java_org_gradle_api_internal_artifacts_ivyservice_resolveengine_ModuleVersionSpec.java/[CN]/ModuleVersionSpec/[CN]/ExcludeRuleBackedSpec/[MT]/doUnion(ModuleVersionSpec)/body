{
  if (!(other instanceof ExcludeRuleBackedSpec)) {
    return super.doUnion(other);
  }
  ExcludeRuleBackedSpec excludeRuleBackedSpec=(ExcludeRuleBackedSpec)other;
  if (excludeSpecs.equals(excludeRuleBackedSpec.excludeSpecs)) {
    return this;
  }
  for (  ModuleVersionSpec excludeSpec : excludeSpecs) {
    if (excludeSpec instanceof ExcludeRuleSpec) {
      return super.doUnion(other);
    }
  }
  for (  ModuleVersionSpec excludeSpec : excludeRuleBackedSpec.excludeSpecs) {
    if (excludeSpec instanceof ExcludeRuleSpec) {
      return super.doUnion(other);
    }
  }
  List<ModuleVersionSpec> merged=new ArrayList<ModuleVersionSpec>();
  for (  ModuleVersionSpec thisSpec : excludeSpecs) {
    for (    ModuleVersionSpec otherSpec : excludeRuleBackedSpec.excludeSpecs) {
      intersect(thisSpec,otherSpec,merged);
    }
  }
  if (merged.isEmpty()) {
    return ALL_SPEC;
  }
  return new ExcludeRuleBackedSpec(merged);
}
