{
  if (message instanceof ChannelAvailable) {
    ChannelAvailable channelAvailable=(ChannelAvailable)message;
    channels.put(channelAvailable.getChannel(),channelAvailable);
    LOGGER.info("Channel registered. Broadcasting {}.",message);
    context.dispatchOutgoing(message);
  }
 else   if (message instanceof ChannelUnavailable) {
    ChannelUnavailable channelUnavailable=(ChannelUnavailable)message;
    channels.remove(channelUnavailable.getChannel());
    LOGGER.info("Channel unregistered. Broadcasting {}.",message);
    context.dispatchOutgoing(message);
  }
 else {
    throw new UnsupportedOperationException();
  }
}
