{
  IdeaModel ideaModel=project.getPlugins().getPlugin(IdeaPlugin.class).getModel();
  IdeaProject projectModel=ideaModel.getProject();
  JavaVersion projectSourceLanguageLevel=convertIdeaLanguageLevelToJavaVersion(projectModel.getLanguageLevel());
  JavaVersion projectTargetBytecodeLevel=projectModel.getTargetBytecodeVersion();
  final Jvm currentJvm=Jvm.current();
  final DefaultJavaRuntime javaRuntime=new DefaultJavaRuntime(currentJvm.getJavaHome(),currentJvm.getJavaVersion());
  DefaultIdeaProject out=new DefaultIdeaProject().setName(projectModel.getName()).setJdkName(projectModel.getJdkName()).setLanguageLevel(new DefaultIdeaLanguageLevel(projectModel.getLanguageLevel().getLevel())).setJavaSourceSettings(new DefaultIdeaJavaSettings().setSourceLanguageLevel(projectSourceLanguageLevel).setTargetBytecodeVersion(projectTargetBytecodeLevel).setJavaSDK(javaRuntime));
  Map<String,DefaultIdeaModule> modules=new HashMap<String,DefaultIdeaModule>();
  for (  IdeaModule module : projectModel.getModules()) {
    appendModule(modules,module,out,rootGradleProject,javaRuntime);
  }
  for (  IdeaModule module : projectModel.getModules()) {
    buildDependencies(modules,module);
  }
  final Collection<DefaultIdeaModule> ideaModules=modules.values();
  out.setChildren(new LinkedList<DefaultIdeaModule>(ideaModules));
  return out;
}
