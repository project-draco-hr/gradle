{
  IdeaModel ideaModel=project.getPlugins().getPlugin(IdeaPlugin.class).getModel();
  IdeaProject projectModel=ideaModel.getProject();
  JavaVersion projectSourceLanguageLevel=convertIdeaLanguageLevelToJavaVersion(projectModel.getLanguageLevel());
  DefaultIdeaProject out=new DefaultIdeaProject().setName(projectModel.getName()).setJdkName(projectModel.getJdkName()).setLanguageLevel(new DefaultIdeaLanguageLevel(projectModel.getLanguageLevel().getLevel())).setJavaSourceSettings(new DefaultIdeaProjectJavaSourceSettings(projectSourceLanguageLevel));
  final DefaultJavaRuntime defaultJavaRuntime=new DefaultJavaRuntime(Jvm.current().getJavaHome());
  Map<String,DefaultIdeaModule> modules=new HashMap<String,DefaultIdeaModule>();
  for (  IdeaModule module : projectModel.getModules()) {
    appendModule(modules,module,out,rootGradleProject,projectSourceLanguageLevel,defaultJavaRuntime);
  }
  for (  IdeaModule module : projectModel.getModules()) {
    buildDependencies(modules,module);
  }
  out.setChildren(new LinkedList<DefaultIdeaModule>(modules.values()));
  return out;
}
