{
  final Set<JavaVersion> moduleBytecodeVersions=toSet(compact(collect(ideaModules,new Transformer<JavaVersion,DefaultIdeaModule>(){
    @Override public JavaVersion transform(    DefaultIdeaModule defaultIdeaModule){
      final DefaultIdeaJavaSettings javaSourceSettings=defaultIdeaModule.getJavaSourceSettings();
      return javaSourceSettings == null ? null : javaSourceSettings.getTargetBytecodeLevel();
    }
  }
)));
  if (moduleBytecodeVersions.size() > 0) {
    final JavaVersion maxBytecodeLevel=Collections.max(moduleBytecodeVersions);
    out.getJavaSourceSettings().setTargetBytecodeLevel(maxBytecodeLevel);
    for (    DefaultIdeaModule ideaModule : ideaModules) {
      if (moduleTargetByteIsMaxBytecodeLevel(maxBytecodeLevel,ideaModule)) {
        ideaModule.getJavaSourceSettings().setTargetBytecodeLevelInherited(true);
      }
    }
    out.getJavaSourceSettings().setTargetBytecodeLevel(maxBytecodeLevel);
  }
}
