{
  TestFile buildFile=testFile("build.gradle");
  buildFile.writelns("task a","a.dependsOn {","throw new RuntimeException('broken')","}");
  ExecutionFailure failure=usingBuildFile(buildFile).withTasks("a").runWithFailure();
  failure.assertHasFileName(String.format("Build file '%s'",buildFile));
  failure.assertHasLineNumber(3);
  failure.assertHasDescription("Failed to notify task execution graph listener");
  failure.assertHasCause("broken closure");
}
