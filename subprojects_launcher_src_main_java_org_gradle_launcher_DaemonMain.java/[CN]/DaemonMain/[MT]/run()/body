{
  String timeoutProperty=startParameter.getSystemPropertiesArgs().get("idleDaemonTimeout");
  int idleDaemonTimeout=(timeoutProperty != null) ? Integer.parseInt(timeoutProperty) : 3 * 60 * 60* 1000;
  connector.accept(idleDaemonTimeout,new IncomingConnectionHandler(){
    public void handle(    final Connection<Object> connection,    final DaemonConnector.CompletionHandler serverControl){
      StoppableExecutor executor=executorFactory.create("DaemonMain worker");
      executor.execute(new Runnable(){
        public void run(){
          try {
            serverControl.onStartActivity();
            doRun(connection,serverControl);
          }
  finally {
            serverControl.onActivityComplete();
            connection.stop();
          }
        }
      }
);
    }
  }
);
  executorFactory.stop();
}
