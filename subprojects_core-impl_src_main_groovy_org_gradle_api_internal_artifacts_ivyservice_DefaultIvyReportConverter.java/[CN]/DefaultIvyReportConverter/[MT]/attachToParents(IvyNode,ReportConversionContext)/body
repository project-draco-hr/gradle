{
  Collection<Usage> usages=getUsages(childNode,context);
  for (  Usage usage : usages) {
    ModuleRevisionId parentId=usage.dependencyDescriptor.getParentRevisionId();
    Set<ConfigurationDetails> parentConfigurations;
    if (parentId.equals(context.configurationResolveReport.getModuleDescriptor().getModuleRevisionId())) {
      parentConfigurations=context.findExtendingConfigurations(parentId,context.conf);
    }
 else {
      parentConfigurations=context.findExtendingConfigurations(parentId,usage.dependerConfig);
    }
    Set<String> childConfigs=getRealConfigurations(childNode,Arrays.asList(usage.dependencyDescriptor.getDependencyConfigurations(usage.dependerConfig)));
    for (    ConfigurationDetails parentConfiguration : parentConfigurations) {
      for (      String childConfigName : childConfigs) {
        ConfigurationDetails childConfiguration=context.getConfiguration(childNode,childConfigName);
        parentConfiguration.dependency.addChild(childConfiguration.dependency);
        Set<ResolvedArtifact> parentSpecificResolvedArtifacts=getParentSpecificArtifacts(childNode,childConfiguration,usage);
        childConfiguration.dependency.addParentSpecificArtifacts(parentConfiguration.dependency,parentSpecificResolvedArtifacts);
        context.resolvedArtifacts.addAll(parentSpecificResolvedArtifacts);
      }
    }
  }
}
