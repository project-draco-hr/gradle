{
  this.classLoaderFactory=classLoaderFactory;
  ClassLoader runtimeClassLoader=getClass().getClassLoader();
  apiOnlyClassLoader=restrictToGradleApi(runtimeClassLoader);
  ClassPath pluginsClassPath=classPathRegistry.getClassPath("GRADLE_EXTENSIONS");
  extensionsClassLoader=classLoaderFactory.createCustomClassLoader(runtimeClassLoader,pluginsClassPath,new CustomClassLoaderFactory(){
    @Override public ClassLoader create(    ClassLoader parent,    ClassPath classPath){
      return new MixInLegacyTypesClassLoader(parent,classPath);
    }
  }
);
  this.apiAndPluginsClassLoader=restrictToGradleApi(extensionsClassLoader);
}
