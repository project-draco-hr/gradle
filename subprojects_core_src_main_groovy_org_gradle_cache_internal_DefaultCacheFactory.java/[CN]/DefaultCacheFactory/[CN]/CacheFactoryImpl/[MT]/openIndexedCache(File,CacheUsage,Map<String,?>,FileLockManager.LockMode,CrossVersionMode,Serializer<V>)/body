{
  if (lockMode == FileLockManager.LockMode.Shared) {
    throw new UnsupportedOperationException("No indexed cache implementation is available that can be shared by multiple processes.");
  }
  if (crossVersionMode == CrossVersionMode.CrossVersion) {
    throw new UnsupportedOperationException("No indexed cache implementation is available that can be used by multiple Gradle versions.");
  }
  IndexedCacheReference<K,V> cacheReference=doOpenDir(cacheDir,usage,properties,FileLockManager.LockMode.Exclusive,null).getIndexedCache(serializer);
  cacheReference.addReference(this);
  return cacheReference.getCache();
}
