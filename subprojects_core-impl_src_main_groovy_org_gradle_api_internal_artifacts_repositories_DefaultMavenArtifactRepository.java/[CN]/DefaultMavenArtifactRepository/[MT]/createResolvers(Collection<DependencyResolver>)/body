{
  URI rootUri=getUrl();
  if (rootUri == null) {
    throw new InvalidUserDataException("You must specify a URL for a Maven repository.");
  }
  MavenResolver resolver;
  if (rootUri.getScheme().equalsIgnoreCase("file")) {
    String root=getFilePath(rootUri);
    resolver=new MavenResolver(name,root,new FileRepository());
    resolver.setRepositoryCacheManager(new LocalFileRepositoryCacheManager(name));
    Collection<URI> artifactUrls=getArtifactUrls();
    for (    URI repoUrl : artifactUrls) {
      resolver.addArtifactUrl(getFilePath(repoUrl));
    }
  }
 else {
    HttpSettings httpSettings=new DefaultHttpSettings(getCredentials());
    String root=getUriPath(rootUri);
    resolver=new MavenResolver(name,root,new CommonsHttpClientBackedRepository(httpSettings));
    Collection<URI> artifactUrls=getArtifactUrls();
    for (    URI repoUrl : artifactUrls) {
      resolver.addArtifactUrl(getUriPath(repoUrl));
    }
  }
  resolvers.add(resolver);
}
