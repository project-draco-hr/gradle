{
  if (key == null) {
    throw new IllegalArgumentException("key cannot be null");
  }
  return cacheLockingManager.useCache(operationName("store"),new Factory<CachedArtifactResolution>(){
    public CachedArtifactResolution create(){
      P internalKey=createKey(key);
      CachedArtifactResolution cachedResolution=toCachedArtifactResolution(getPersistentCache().get(internalKey));
      if (cachedResolution == null) {
        return null;
      }
 else       if (cachedResolution.isMissing() || cachedResolution.getArtifactFile().exists()) {
        return cachedResolution;
      }
 else {
        clearWithInternalKey(internalKey);
        return null;
      }
    }
  }
);
}
