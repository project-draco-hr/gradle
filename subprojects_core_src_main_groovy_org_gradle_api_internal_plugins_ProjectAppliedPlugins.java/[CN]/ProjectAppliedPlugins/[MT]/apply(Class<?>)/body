{
  if (Plugin.class.isAssignableFrom(pluginClass)) {
    @SuppressWarnings("unchecked") Class<? extends Plugin<?>> pluginImplementingClass=(Class<? extends Plugin<?>>)pluginClass;
    target.getPlugins().apply(pluginImplementingClass);
  }
 else {
    Set<Class<?>> declaredSources=getDeclaredSources(pluginClass);
    if (declaredSources.size() == 0) {
      throw new IllegalArgumentException(String.format("%s is neither a plugin or a rule source and cannot be applied.",pluginClass.getName()));
    }
    extractModelRules(declaredSources);
  }
}
