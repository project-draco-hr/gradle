{
  ArtifactRepository localRepo=createLocalArtifactRepository();
  ParsedMavenPom parsedMavenPom=new ParsedMavenPom(pomFile);
  Artifact artifact=createMainArtifact(parsedMavenPom);
  if (mainArtifact == null) {
    publishArtifact(artifact,pomFile,localRepo);
  }
 else {
    ArtifactMetadata metadata=new ProjectArtifactMetadata(artifact,pomFile);
    artifact.addMetadata(metadata);
    publishArtifact(artifact,mainArtifact,localRepo);
  }
  for (  AdditionalArtifact attachedArtifact : additionalArtifacts) {
    Artifact attach=createAttachedArtifact(artifact,attachedArtifact.getType(),attachedArtifact.getClassifier());
    publishArtifact(attach,attachedArtifact.getFile(),localRepo);
  }
}
