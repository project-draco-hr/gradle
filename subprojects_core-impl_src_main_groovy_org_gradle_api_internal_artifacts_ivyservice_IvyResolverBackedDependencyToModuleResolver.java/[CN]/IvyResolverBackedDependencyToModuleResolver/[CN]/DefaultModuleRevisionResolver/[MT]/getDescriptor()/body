{
  if (failure != null) {
    throw failure;
  }
  if (moduleDescriptor == null) {
    IvyContext context=IvyContext.pushNewCopyContext();
    try {
      context.setIvy(ivy);
      context.setResolveData(resolveData);
      context.setDependencyDescriptor(dependencyDescriptor);
      ResolvedModuleRevision resolvedRevision;
      try {
        resolvedRevision=resolver.getDependency(dependencyDescriptor,resolveData);
      }
 catch (      Throwable t) {
        throw new ModuleResolveException(String.format("Could not resolve %s",dependencyDescriptor.getDependencyRevisionId()),t);
      }
      if (resolvedRevision == null) {
        throw new ModuleNotFoundException(String.format("%s not found.",dependencyDescriptor.getDependencyRevisionId()));
      }
      moduleDescriptor=resolvedRevision.getDescriptor();
    }
 catch (    ModuleResolveException e) {
      failure=e;
      throw failure;
    }
 finally {
      IvyContext.popContext();
    }
  }
  return moduleDescriptor;
}
