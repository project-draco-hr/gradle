{
  final PublishInstruction publishInstruction=new PublishInstruction(true,expectedIvyFile);
  context.checking(new Expectations(){
{
      allowing(publishOptionsFactoryMock).createPublishOptions(WrapUtil.toSet(expectedConf),publishInstruction);
      will(returnValue(expectedPublishOptions));
      one(publishEngineMock).publish(moduleDescriptorMock,createSrcPatternForIvyArtifacts(),expectedResolverList.get(0),expectedPublishOptions);
      one(moduleDescriptorMock).toIvyFile(expectedIvyFile);
    }
  }
);
  ivyDependencyPublisher.publish(WrapUtil.toSet(expectedConf),publishInstruction,expectedResolverList,moduleDescriptorMock,publishEngineMock);
}
