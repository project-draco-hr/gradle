{
  final SettingsProcessor delegate=context.mock(SettingsProcessor.class);
  final URLClassLoader urlClassLoader=new URLClassLoader(new URL[0]);
  final IGradlePropertiesLoader propertiesLoader=context.mock(IGradlePropertiesLoader.class);
  final StartParameter startParameter=new StartParameter();
  final SettingsInternal settings=context.mock(SettingsInternal.class);
  final File settingsDir=new File("root");
  final GradleInternal gradle=context.mock(GradleInternal.class);
  final SettingsLocation settingsLocation=new SettingsLocation(settingsDir,new File("foo"));
  PropertiesLoadingSettingsProcessor processor=new PropertiesLoadingSettingsProcessor(delegate,propertiesLoader);
  final ClassLoaderScope classLoaderScope=new RootClassLoaderScope(urlClassLoader,new DummyClassLoaderCache());
  context.checking(new Expectations(){
{
      one(propertiesLoader).loadProperties(settingsDir);
      one(delegate).process(gradle,settingsLocation,classLoaderScope,startParameter);
      will(returnValue(settings));
    }
  }
);
  assertThat(processor.process(gradle,settingsLocation,classLoaderScope,startParameter),sameInstance(settings));
}
