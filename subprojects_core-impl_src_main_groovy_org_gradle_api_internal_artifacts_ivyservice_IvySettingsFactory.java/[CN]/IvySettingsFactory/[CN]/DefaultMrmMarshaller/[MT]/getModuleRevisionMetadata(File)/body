{
  LockHolder lockHolder=lockHolderFactory.getOrCreateLockHolder(file);
  if (!lockHolder.acquireLock()) {
    throw new RuntimeException(String.format("Could not acquire lock for %s",file));
  }
  try {
    return getCache(file).get();
  }
  finally {
    lockHolder.releaseLock();
  }
}
