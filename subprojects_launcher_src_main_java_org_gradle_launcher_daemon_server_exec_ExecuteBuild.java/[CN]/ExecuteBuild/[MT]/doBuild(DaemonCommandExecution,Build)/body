{
  LOGGER.info("Executing build with daemon context: {}",execution.getDaemonContext());
  try {
    BuildCancellationToken cancellationToken=execution.getDaemonStateControl().updateCancellationToken(build.getIdentifier());
    Object result=actionExecuter.execute(build.getAction(),cancellationToken,build.getParameters());
    if (cancellationToken.isCancellationRequested()) {
      if (!(execution.getException() instanceof BuildCancelledException)) {
        BuildCancelledException cancelledException=new BuildCancelledException("Build cancelled.");
        if (execution.getException() != null) {
          cancelledException.initCause(execution.getException());
        }
        execution.setException(cancelledException);
      }
    }
 else {
      execution.setResult(result);
    }
  }
 catch (  ReportedException e) {
    execution.setException(e);
  }
 finally {
    LOGGER.debug(DaemonMessages.FINISHED_BUILD);
  }
  execution.proceed();
}
