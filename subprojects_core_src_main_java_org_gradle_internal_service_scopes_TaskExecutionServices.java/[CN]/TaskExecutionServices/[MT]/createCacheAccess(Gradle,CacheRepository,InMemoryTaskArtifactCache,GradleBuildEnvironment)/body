{
  CacheDecorator decorator;
  if (environment.isLongLivingProcess()) {
    decorator=inMemoryTaskArtifactCache;
  }
 else {
    decorator=new AsyncCacheAccessDecorator();
  }
  return new DefaultTaskArtifactStateCacheAccess(gradle,cacheRepository,decorator);
}
