{
  Assume.assumeTrue(OperatingSystem.current().isLinux() || OperatingSystem.current().isMacOsX());
  final FileCopyDetails mappedDetails=expectActionExecutedWhenFileVisited();
  final TestFile destFile=tmpDir.getDir().file("test.txt").createFile();
  mappedDetails.setMode(0645);
  context.checking(new Expectations(){
{
      one(details).copyTo(destFile);
      will(returnValue(true));
    }
  }
);
  mappedDetails.copyTo(destFile);
  assertThat(destFile.getMode(),equalTo(0645));
}
