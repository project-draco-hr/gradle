{
  Type extensibleObjectFieldType=extensible ? extensibleDynamicObjectHelperType : nonExtensibleDynamicObjectHelperType;
  final String fieldSignature=extensibleObjectFieldType.getDescriptor();
  visitor.visitField(Opcodes.ACC_PRIVATE,DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature,null,null);
  initDynamicObjectHelper=new MethodCodeBody(){
    public void add(    MethodVisitor visitor) throws Exception {
      generateCreateDynamicObject(visitor);
      visitor.visitFieldInsn(Opcodes.PUTFIELD,generatedType.getInternalName(),DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature);
    }
  }
;
  if (extensible) {
    addGetter(HasConvention.class.getDeclaredMethod("getConvention"),new MethodCodeBody(){
      public void add(      MethodVisitor visitor) throws Exception {
        visitor.visitVarInsn(Opcodes.ALOAD,0);
        visitor.visitFieldInsn(Opcodes.GETFIELD,generatedType.getInternalName(),DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature);
        String getterDescriptor=Type.getMethodDescriptor(ExtensibleDynamicObject.class.getDeclaredMethod("getConvention"));
        visitor.visitMethodInsn(Opcodes.INVOKEVIRTUAL,extensibleDynamicObjectHelperType.getInternalName(),"getConvention",getterDescriptor,false);
      }
    }
);
    addGetter(ExtensionAware.class.getDeclaredMethod("getExtensions"),new MethodCodeBody(){
      public void add(      MethodVisitor visitor) throws Exception {
        visitor.visitVarInsn(Opcodes.ALOAD,0);
        String getterDescriptor=Type.getMethodDescriptor(ExtensibleDynamicObject.class.getDeclaredMethod("getConvention"));
        visitor.visitMethodInsn(Opcodes.INVOKEVIRTUAL,generatedType.getInternalName(),"getConvention",getterDescriptor,false);
      }
    }
);
  }
  addGetter(DynamicObjectAware.class.getDeclaredMethod("getAsDynamicObject"),new MethodCodeBody(){
    public void add(    MethodVisitor visitor){
      visitor.visitVarInsn(Opcodes.ALOAD,0);
      visitor.visitFieldInsn(Opcodes.GETFIELD,generatedType.getInternalName(),DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature);
    }
  }
);
}
