{
  if (allowedPackages.isEmpty()) {
    return Collections.emptySet();
  }
  SignatureReader sr=new SignatureReader(signature);
  final Set<String> result=Sets.newLinkedHashSet();
  sr.accept(new SignatureVisitor(Opcodes.ASM5){
    @Override public void visitClassType(    String name){
      super.visitClassType(name);
      String className=toClassName(name);
      if (!validateType(className)) {
        result.add(className);
      }
    }
  }
);
  return result;
}
