{
  if (junit4 && t instanceof AssertionFailedError) {
    wrappedListener.addFailure(test,(AssertionFailedError)t);
  }
 else   if (junit4 && t.getClass().getName().equals("java.lang.AssertionError")) {
    try {
      String msg=t.getMessage();
      AssertionFailedError failure=msg != null ? new AssertionFailedError(msg) : new AssertionFailedError();
      Method initCause=Throwable.class.getMethod("initCause",new Class[]{Throwable.class});
      initCause.invoke(failure,new Object[]{t});
      wrappedListener.addFailure(test,failure);
    }
 catch (    Exception e) {
      e.printStackTrace();
      wrappedListener.addError(test,t);
    }
  }
 else {
    wrappedListener.addError(test,t);
  }
}
