{
  String repositoryName=repository.getName();
  if (!GUtil.isTrue(repositoryName)) {
    repositoryName=findName(defaultName);
    repository.setName(repositoryName);
  }
  if (findByName(repositoryName) != null) {
    throw new InvalidUserDataException(String.format("Cannot add a repository with name '%s' as a repository with that name already exists.",repository.getName()));
  }
  action.execute(repository);
  super.add(repository);
  return repository;
}
