{
  if (listener.getType() != null) {
    if (!node.isAtLeast(ModelNode.State.Discovered)) {
      return false;
    }
    if (!node.getPromise().canBeViewedAsMutable(listener.getType()) && !node.getPromise().canBeViewedAsImmutable(listener.getType())) {
      return false;
    }
  }
  return listener.onDiscovered(node);
}
