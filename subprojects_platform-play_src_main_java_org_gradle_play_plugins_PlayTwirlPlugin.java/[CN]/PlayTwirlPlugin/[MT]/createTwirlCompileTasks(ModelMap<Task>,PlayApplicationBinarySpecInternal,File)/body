{
  for (  final TwirlSourceSet twirlSourceSet : binary.getInputs().withType(TwirlSourceSet.class)) {
    final String twirlCompileTaskName=binary.getTasks().taskName("compile",twirlSourceSet.getName());
    final File twirlCompileOutputDirectory=binary.getNamingScheme().getOutputDirectory(buildDir,twirlCompileTaskName);
    tasks.create(twirlCompileTaskName,TwirlCompile.class,new Action<TwirlCompile>(){
      public void execute(      TwirlCompile twirlCompile){
        twirlCompile.setDescription("Compiles twirl templates for the '" + twirlSourceSet.getName() + "' source set.");
        twirlCompile.setPlatform(binary.getTargetPlatform());
        twirlCompile.setSource(twirlSourceSet.getSource());
        twirlCompile.setOutputDirectory(twirlCompileOutputDirectory);
        ScalaLanguageSourceSet twirlScalaSources=binary.getGeneratedScala().get(twirlSourceSet);
        twirlScalaSources.getSource().srcDir(twirlCompileOutputDirectory);
        twirlScalaSources.builtBy(twirlCompile);
      }
    }
);
  }
}
