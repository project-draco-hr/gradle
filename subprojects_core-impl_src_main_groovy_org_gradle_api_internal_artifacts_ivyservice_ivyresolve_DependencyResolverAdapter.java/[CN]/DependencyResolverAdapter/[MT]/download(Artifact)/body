{
  ArtifactDownloadReport artifactDownloadReport=resolver.download(new Artifact[]{artifact},downloadOptions).getArtifactReport(artifact);
  if (downloadFailed(artifactDownloadReport)) {
    if (artifactDownloadReport instanceof EnhancedArtifactDownloadReport) {
      EnhancedArtifactDownloadReport enhancedReport=(EnhancedArtifactDownloadReport)artifactDownloadReport;
      throw new ArtifactResolveException(artifactDownloadReport.getArtifact(),enhancedReport.getFailure());
    }
    throw new ArtifactResolveException(artifactDownloadReport.getArtifact(),artifactDownloadReport.getDownloadDetails());
  }
  ArtifactOrigin artifactOrigin=artifactDownloadReport.getArtifactOrigin();
  File localFile=artifactDownloadReport.getLocalFile();
  if (localFile != null) {
    String source=artifactOrigin.getLocation();
    Date lastModified=null;
    if (artifactOrigin instanceof ArtifactOriginWithLastModified) {
      lastModified=((ArtifactOriginWithLastModified)artifactOrigin).getLastModified();
    }
    return new DownloadedArtifact(localFile,new DefaultExternalResourceMetaData(source,lastModified,-1));
  }
 else {
    return null;
  }
}
