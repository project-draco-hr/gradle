{
  final String confName=configurationStub.getName();
  context.checking(new Expectations(){
{
      allowing(configurationStub).getAll();
      will(returnValue(toSet(configurationStub,otherConfiguration)));
      allowing(configurationStub).getModule();
      will(returnValue(module));
      one(ivyFactory).create(resolutionStrategy);
      will(returnValue(ivyStub));
      one(moduleDescriptorConverter).convert(with(equalTo(toSet(configurationStub,otherConfiguration))),with(equalTo(module)));
      will(returnValue(moduleDescriptor));
      one(ivyStub).resolve(with(equal(moduleDescriptor)),with(equalResolveOptions(confName)));
      will(returnValue(resolveReportMock));
      one(ivyReportConverterStub).convertReport(resolveReportMock,configurationStub);
      will(returnValue(conversionResultStub));
    }
  }
);
}
