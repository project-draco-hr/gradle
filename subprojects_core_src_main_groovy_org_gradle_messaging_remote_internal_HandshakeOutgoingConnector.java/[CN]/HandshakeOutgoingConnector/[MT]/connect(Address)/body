{
  if (!(destinationAddress instanceof CompositeAddress)) {
    throw new IllegalArgumentException(String.format("Cannot create a connection to address of unknown type: %s.",destinationAddress));
  }
  CompositeAddress compositeAddress=(CompositeAddress)destinationAddress;
  Address connectionAddress=compositeAddress.getAddress();
  Connection<Message> connection=connector.connect(connectionAddress);
  try {
    connection.dispatch(new ConnectRequest(destinationAddress));
  }
 catch (  Throwable e) {
    connection.stop();
    throw UncheckedException.asUncheckedException(e);
  }
  return connection;
}
