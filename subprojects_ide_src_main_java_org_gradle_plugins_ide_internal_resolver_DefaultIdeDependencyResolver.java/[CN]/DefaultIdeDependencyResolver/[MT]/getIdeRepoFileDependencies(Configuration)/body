{
  ResolutionResult result=getIncomingResolutionResult(configuration);
  List<ResolvedComponentResult> resolvedDependencies=new ArrayList<ResolvedComponentResult>();
  findAllResolvedDependencyResultsAndTheirDependencies(resolvedDependencies,new ArrayList<ResolvedComponentResult>(),result.getRoot().getDependencies(),ModuleComponentIdentifier.class);
  Set<ModuleVersionIdentifier> mappedResolvedDependencies=mapResolvedDependencies(resolvedDependencies);
  Set<ResolvedArtifact> artifacts=getExternalArtifacts(configuration);
  List<IdeExtendedRepoFileDependency> externalDependencies=new ArrayList<IdeExtendedRepoFileDependency>();
  for (  ResolvedArtifact artifact : artifacts) {
    if (mappedResolvedDependencies.contains(artifact.getModuleVersion().getId())) {
      IdeExtendedRepoFileDependency ideRepoFileDependency=new IdeExtendedRepoFileDependency(configuration,artifact.getFile());
      ideRepoFileDependency.setId(artifact.getModuleVersion().getId());
      externalDependencies.add(ideRepoFileDependency);
    }
  }
  return externalDependencies;
}
