{
  if (JavaVersion.current().isJava7Compatible()) {
    Class clazz;
    try {
      clazz=this.getClass().getClassLoader().loadClass("org.gradle.internal.filewatch.jdk7.DefaultFileWatcher");
    }
 catch (    ClassNotFoundException e) {
      throw new RuntimeException("Cannot find FileWatcher implementation class",e);
    }
    Constructor<?> constructor=null;
    try {
      constructor=clazz.getConstructor(ExecutorService.class);
    }
 catch (    NoSuchMethodException e) {
      throw new RuntimeException("Cannot find constructor in FileWatcher class",e);
    }
    try {
      return Cast.uncheckedCast(constructor.newInstance(executor));
    }
 catch (    Exception e) {
      throw new RuntimeException("Cannot instantiate FileWatcher implementation",e);
    }
  }
 else {
    throw new RuntimeException("FileWatcher is only available on Java 7 compatible JVMs");
  }
}
