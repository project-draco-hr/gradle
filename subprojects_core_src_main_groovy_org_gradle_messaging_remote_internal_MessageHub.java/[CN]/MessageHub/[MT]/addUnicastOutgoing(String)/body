{
  lock.lock();
  try {
    ProtocolStack<Message> outgoing=outgoingUnicasts.get(channel);
    if (outgoing == null) {
      Protocol<Message> unicastSendProtocol=new UnicastSendProtocol();
      Protocol<Message> sendProtocol=new SendProtocol(idGenerator.generateId(),nodeName,channel);
      StoppableExecutor executor=executorFactory.create(displayName + " outgoing " + channel);
      executors.add(executor);
      outgoing=new ProtocolStack<Message>(executor,failureHandler,failureHandler,unicastSendProtocol,sendProtocol,new ConnectionDisconnectProtocol());
      outgoingUnicasts.put(channel,outgoing);
      AsyncConnection<Message> outgoingEndpoint=router.createLocalConnection();
      outgoing.getBottom().dispatchTo(outgoingEndpoint);
      outgoingEndpoint.dispatchTo(outgoing.getBottom());
    }
    return new OutgoingMultiplex(channel,outgoing.getTop());
  }
  finally {
    lock.unlock();
  }
}
