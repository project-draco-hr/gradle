{
  lock.lock();
  try {
    AsyncConnectionAdapter<Message> asyncConnection=new AsyncConnectionAdapter<Message>(connection,failureHandler,executorFactory,new ConnectionDisconnectProtocol());
    connections.add(asyncConnection);
    AsyncConnection<Message> incomingEndpoint=router.createRemoteConnection();
    incomingEndpoint.dispatchTo(new MethodInvocationMarshallingDispatch(asyncConnection));
    asyncConnection.dispatchTo(new MethodInvocationUnmarshallingDispatch(incomingEndpoint,messagingClassLoader));
  }
  finally {
    lock.unlock();
  }
}
