{
  Hasher hasher=Hashing.md5().newHasher();
  ImmutableSortedMap.Builder<String,FileCollectionSnapshot.PreCheck> builder=ImmutableSortedMap.naturalOrder();
  for (  TaskFilePropertySpecInternal fileProperty : fileProperties) {
    String propertyName=fileProperty.getPropertyName();
    FileCollectionSnapshot.PreCheck result;
    try {
      result=snapshotter.preCheck(fileProperty.getPropertyFiles(),allowSnapshotReuse);
    }
 catch (    UncheckedIOException e) {
      throw new UncheckedIOException(String.format("Failed to capture snapshot of %s files for task '%s' property '%s' during up-to-date check.",title.toLowerCase(),taskName,propertyName),e);
    }
    builder.put(propertyName,result);
    hasher.putString(propertyName,Charsets.UTF_8);
    hasher.putInt(result.getHash());
  }
  return new PreCheckSet(builder.build(),hasher.hash());
}
