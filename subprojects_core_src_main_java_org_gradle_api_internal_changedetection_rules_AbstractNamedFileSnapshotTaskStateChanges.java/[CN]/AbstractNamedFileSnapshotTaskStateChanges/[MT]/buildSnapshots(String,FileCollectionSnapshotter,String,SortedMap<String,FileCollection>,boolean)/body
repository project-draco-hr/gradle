{
  ImmutableMap.Builder<String,FileCollectionSnapshot> builder=ImmutableMap.builder();
  for (  Map.Entry<String,FileCollection> entry : fileProperties.entrySet()) {
    String propertyName=entry.getKey();
    FileCollection files=entry.getValue();
    FileCollectionSnapshot result;
    try {
      result=snapshotter.snapshot(files,allowSnapshotReuse);
    }
 catch (    UncheckedIOException e) {
      throw new UncheckedIOException(String.format("Failed to capture snapshot of %s files for task '%s' property '%s' during up-to-date check.",title.toLowerCase(),taskName,propertyName),e);
    }
    builder.put(propertyName,result);
  }
  return builder.build();
}
