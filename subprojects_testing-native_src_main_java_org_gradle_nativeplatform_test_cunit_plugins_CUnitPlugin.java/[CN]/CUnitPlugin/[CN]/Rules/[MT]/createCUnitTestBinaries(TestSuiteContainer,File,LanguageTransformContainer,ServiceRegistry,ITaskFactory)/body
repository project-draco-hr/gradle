{
  final Action<NativeBinarySpec> setToolsAction=new ToolSettingNativeBinaryInitializer(languageTransforms);
  testSuites.withType(CUnitTestSuiteSpec.class).afterEach(new Action<CUnitTestSuiteSpec>(){
    @Override public void execute(    final CUnitTestSuiteSpec cUnitTestSuite){
      for (      final NativeBinarySpec testedBinary : cUnitTestSuite.getTestedComponent().getBinaries().withType(NativeBinarySpec.class).values()) {
        if (testedBinary instanceof SharedLibraryBinary) {
          continue;
        }
        final BinaryNamingScheme namingScheme=new DefaultBinaryNamingSchemeBuilder(((NativeBinarySpecInternal)testedBinary).getNamingScheme()).withComponentName(cUnitTestSuite.getBaseName()).withTypeString("CUnitExe").build();
        final NativeDependencyResolver resolver=serviceRegistry.get(NativeDependencyResolver.class);
        cUnitTestSuite.getBinaries().create(namingScheme.getLifecycleTaskName(),CUnitTestSuiteBinarySpec.class,new Action<CUnitTestSuiteBinarySpec>(){
          @Override public void execute(          CUnitTestSuiteBinarySpec binary){
            DefaultCUnitTestSuiteBinary testBinary=(DefaultCUnitTestSuiteBinary)binary;
            testBinary.setTestedBinary((NativeBinarySpecInternal)testedBinary);
            testBinary.setNamingScheme(namingScheme);
            testBinary.setResolver(resolver);
            setToolsAction.execute(testBinary);
            configure(testBinary,buildDir);
          }
        }
);
      }
    }
  }
);
}
