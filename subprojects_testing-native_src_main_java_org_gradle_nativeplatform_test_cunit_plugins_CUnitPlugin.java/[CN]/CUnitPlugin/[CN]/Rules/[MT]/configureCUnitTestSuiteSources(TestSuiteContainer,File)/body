{
  for (  final CUnitTestSuiteSpec suite : testSuites.withType(CUnitTestSuiteSpec.class).values()) {
    FunctionalSourceSet suiteSourceSet=((ComponentSpecInternal)suite).getSources();
    CSourceSet launcherSources=suiteSourceSet.maybeCreate(CUNIT_LAUNCHER_SOURCE_SET,CSourceSet.class);
    File baseDir=new File(buildDir,String.format("src/%s/cunitLauncher",suite.getName()));
    launcherSources.getSource().srcDir(new File(baseDir,"c"));
    launcherSources.getExportedHeaders().srcDir(new File(baseDir,"headers"));
    CSourceSet testSources=suiteSourceSet.maybeCreate("c",CSourceSet.class);
    testSources.getSource().srcDir(String.format("src/%s/%s",suite.getName(),"c"));
    testSources.getExportedHeaders().srcDir(String.format("src/%s/headers",suite.getName()));
    testSources.lib(launcherSources);
  }
}
