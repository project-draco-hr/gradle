{
  ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  try {
    resource.writeTo(outputStream,new CopyProgressListenerAdapter());
    return outputStream.toByteArray();
  }
  finally {
    try {
      outputStream.close();
    }
  finally {
      resource.close();
    }
  }
}
