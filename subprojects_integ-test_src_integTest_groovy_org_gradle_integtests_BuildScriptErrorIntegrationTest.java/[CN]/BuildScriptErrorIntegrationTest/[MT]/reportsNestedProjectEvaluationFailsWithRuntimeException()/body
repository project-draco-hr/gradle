{
  testFile("settings.gradle").write("include 'child'");
  TestFile buildFile=testFile("build.gradle");
  buildFile.writelns("evaluationDependsOn 'child'","task t");
  TestFile childBuildFile=testFile("child/build.gradle");
  childBuildFile.writelns("def broken = { ->","    throw new RuntimeException('failure') }","broken()");
  ExecutionFailure failure=inTestDirectory().withTasks("t").runWithFailure();
  failure.assertHasFileName(String.format("Build file '%s'",childBuildFile));
  failure.assertHasLineNumber(2);
  failure.assertHasDescription("A problem occurred evaluating project ':child'.");
  failure.assertHasCause("failure");
}
