{
  Set<IDependencyImplementationFactory> dependencyImpls=WrapUtil.toSet(new ModuleDependencyFactory(),new ProjectDependencyFactory());
  File buildResolverDir=new File(settingsFinder.getSettingsDir(),Project.TMP_DIR_NAME + "/" + DependencyManager.BUILD_RESOLVER_NAME);
  if (cacheUsage != CacheUsage.ON) {
    GradleUtil.deleteDir(buildResolverDir);
  }
  DefaultDependencyManager dependencyManager=new DefaultDependencyManager(new DefaultIvyFactory(),new DependencyFactory(dependencyImpls),new DefaultResolverFactory(),new DefaultSettingsConverter(),new DefaultModuleDescriptorConverter(),new DefaultDependencyResolver(new Report2Classpath()),new DefaultDependencyPublisher(),new BuildResolverHandler(buildResolverDir,new LocalReposCacheHandler()),new DefaultExcludeRuleContainer());
  dependencyManager.setProject(project);
  return dependencyManager;
}
