{
  List<ResolvedResource> resolvedResources=new ArrayList<ResolvedResource>();
  Set<String> foundRevisions=new HashSet<String>();
  boolean dynamic=getSettings().getVersionMatcher().isDynamic(moduleRevision);
  boolean stop=false;
  for (Iterator iter=patternList.iterator(); iter.hasNext() && !stop; ) {
    String pattern=(String)iter.next();
    ResolvedResource rres=findResourceUsingPattern(moduleRevision,pattern,artifact,rmdparser,date,forDownload);
    if ((rres != null) && !foundRevisions.contains(rres.getRevision())) {
      foundRevisions.add(rres.getRevision());
      resolvedResources.add(rres);
      stop=!dynamic;
    }
  }
  if (resolvedResources.size() > 1) {
    ResolvedResource[] rress=resolvedResources.toArray(new ResolvedResource[resolvedResources.size()]);
    List<ResolvedResource> sortedResources=getLatestStrategy().sort(rress);
    for (int i=0; i < sortedResources.size() - 1; i++) {
      ResolvedResource resolvedResource=sortedResources.get(i);
      discardResource(resolvedResource.getResource());
    }
    return sortedResources.get(sortedResources.size() - 1);
  }
 else   if (resolvedResources.size() == 1) {
    return resolvedResources.get(0);
  }
 else {
    return null;
  }
}
