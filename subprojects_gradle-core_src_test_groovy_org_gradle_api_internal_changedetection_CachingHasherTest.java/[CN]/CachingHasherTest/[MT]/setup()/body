{
  context.checking(new Expectations(){
{
      CacheBuilder cacheBuilder=context.mock(CacheBuilder.class);
      PersistentCache persistentCache=context.mock(PersistentCache.class);
      one(cacheRepository).cache("fileHashes");
      will(returnValue(cacheBuilder));
      one(cacheBuilder).open();
      will(returnValue(persistentCache));
      one(persistentCache).openIndexedCache(with(notNullValue(Serializer.class)));
      will(returnValue(cache));
    }
  }
);
  hasher=new CachingHasher(delegate,cacheRepository);
}
