{
  if (event.getFailure() != null) {
    failure=event.getFailure();
  }
  TestResult.ResultType resultType=isFailed() ? TestResult.ResultType.FAILURE : event.getResultType() != null ? event.getResultType() : TestResult.ResultType.SUCCESS;
  if (!test.isComposite()) {
    testCount=1;
switch (resultType) {
case SUCCESS:
      successfulCount=1;
    break;
case FAILURE:
  failedCount=1;
break;
}
}
if (startEvent.getParentId() != null) {
TestState parentState=executing.get(startEvent.getParentId());
if (isFailed()) {
parentState.failedChild=true;
}
parentState.testCount+=testCount;
parentState.successfulCount+=successfulCount;
parentState.failedCount+=failedCount;
}
return new DefaultTestResult(resultType,failure,startEvent.getStartTime(),event.getEndTime(),testCount,successfulCount,failedCount);
}
