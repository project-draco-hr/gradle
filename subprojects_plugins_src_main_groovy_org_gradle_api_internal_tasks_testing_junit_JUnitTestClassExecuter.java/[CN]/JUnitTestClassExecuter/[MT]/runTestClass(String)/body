{
  final Class<?> testClass=Class.forName(testClassName,true,applicationClassLoader);
  Request request=Request.aClass(testClass);
  if (options != null) {
    Transformer<Class<?>,String> transformer=new Transformer<Class<?>,String>(){
      public Class<?> transform(      final String original){
        try {
          return applicationClassLoader.loadClass(original);
        }
 catch (        ClassNotFoundException e) {
          throw new InvalidUserDataException("Can't load category class.",e);
        }
      }
    }
;
    request=request.filterWith(new CategoryFilter(CollectionUtils.collect(options.getIncludeCategories(),transformer),CollectionUtils.collect(options.getExcludeCategories(),transformer)));
  }
  Runner runner=request.getRunner();
  if (!Filter.class.equals(runner.getClass())) {
    RunNotifier notifier=new RunNotifier();
    notifier.addListener(listener);
    runner.run(notifier);
  }
}
