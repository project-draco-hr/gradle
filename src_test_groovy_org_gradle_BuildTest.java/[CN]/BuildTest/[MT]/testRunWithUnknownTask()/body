{
  expectedStartParams.setTaskNames(WrapUtil.toList("unknown"));
  context.checking(new Expectations(){
{
      one(projectsLoaderMock).reset();
      one(projectsLoaderMock).load(expectedRootProjectDescriptor,expectedClassLoader,expectedStartParams,testGradleProperties);
      one(settingsProcessorMock).process(settingsFinderMock,expectedStartParams,gradlePropertiesLoaderMock);
      will(returnValue(settingsMock));
      one(buildConfigurerMock).process(expectedRootProject);
    }
  }
);
  BuildResult buildResult=build.run(expectedStartParams);
  assertThat(buildResult.getFailure(),notNullValue());
  assertThat(buildResult.getFailure().getClass(),equalTo((Object)UnknownTaskException.class));
}
