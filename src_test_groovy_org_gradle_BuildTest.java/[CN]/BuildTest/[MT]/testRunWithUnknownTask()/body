{
  expectedStartParams.setTaskNames(WrapUtil.toList("unknown"));
  context.checking(new Expectations(){
{
      one(projectsLoaderMock).load(settingsMock,expectedClassLoader,expectedStartParams,testGradleProperties,System.getProperties(),System.getenv());
      one(settingsProcessorMock).process(settingsFinderMock,expectedStartParams);
      will(returnValue(settingsMock));
      one(buildConfigurerMock).process(expectedRootProject);
    }
  }
);
  BuildResult buildResult=build.run(expectedStartParams);
  assertThat(buildResult.getFailure(),notNullValue());
  assertThat(buildResult.getFailure().getClass(),equalTo((Object)UnknownTaskException.class));
}
