{
  context.checking(new Expectations(){
{
      one(buildConfigurerMock).process(expectedRootProject);
      one(buildExecuterMock).unknownTasks(expectedTaskNames,expectedRecursive,expectedCurrentProject);
      will(returnValue(new ArrayList()));
      one(buildExecuterMock).execute((String)expectedTaskNames.get(0),expectedRecursive,expectedCurrentProject,expectedRootProject,true);
      will(returnValue(rebuildDagReturnValue));
      one(buildExecuterMock).execute((String)expectedTaskNames.get(1),expectedRecursive,expectedCurrentProject,expectedRootProject,false);
      one(projectsLoaderMock).load(settingsMock,expectedClassLoader,expectedStartParams,expectedProjectProperties,System.getProperties(),System.getenv());
      if (rebuildDagReturnValue) {
        one(buildConfigurerMock).process(expectedRootProject);
        one(projectsLoaderMock).load(settingsMock,expectedClassLoader,expectedStartParams,expectedProjectProperties,System.getProperties(),System.getenv());
      }
    }
  }
);
}
