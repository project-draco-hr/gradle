{
  try {
    if (get(OperatingSystem.class).isWindows()) {
      return new WindowsTerminalDetector();
    }
    return new LibCBackedTerminalDetector(get(LibC.class));
  }
 catch (  LinkageError e) {
    return new NoOpTerminalDetector();
  }
}
