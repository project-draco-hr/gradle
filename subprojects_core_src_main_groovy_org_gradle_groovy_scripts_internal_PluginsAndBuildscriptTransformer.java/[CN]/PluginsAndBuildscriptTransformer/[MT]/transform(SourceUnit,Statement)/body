{
  ScriptBlock scriptBlock=AstUtils.detectScriptBlock(statement,scriptBlockNames);
  if (scriptBlock == null) {
    seenNonClasspathStatement=true;
    return null;
  }
 else {
    if (scriptBlock.getName().equals(PLUGINS)) {
      String failMessage=null;
      if (pluginsBlockMessage != null) {
        failMessage=pluginBlockMetadataExtractor.formatErrorMessage(pluginsBlockMessage);
      }
 else {
        seenPluginsBlock=true;
        if (seenNonClasspathStatement) {
          failMessage=String.format(pluginBlockMetadataExtractor.formatErrorMessage("only %s {} and other %s {} script blocks are allowed before %s {} blocks, no other statements are allowed"),classpathBlockName,PLUGINS,PLUGINS);
        }
 else {
          pluginBlockMetadataExtractor.extract(sourceUnit,scriptBlock);
        }
      }
      if (failMessage != null) {
        sourceUnit.getErrorCollector().addError(new SyntaxException(failMessage,statement.getLineNumber(),statement.getColumnNumber()),sourceUnit);
      }
      return null;
    }
 else {
      if (seenPluginsBlock) {
        String message=String.format(pluginBlockMetadataExtractor.formatErrorMessage("all %s {} blocks must appear before any %s {} blocks in the script"),classpathBlockName,PLUGINS);
        sourceUnit.getErrorCollector().addError(new SyntaxException(message,statement.getLineNumber(),statement.getColumnNumber()),sourceUnit);
      }
      return statement;
    }
  }
}
