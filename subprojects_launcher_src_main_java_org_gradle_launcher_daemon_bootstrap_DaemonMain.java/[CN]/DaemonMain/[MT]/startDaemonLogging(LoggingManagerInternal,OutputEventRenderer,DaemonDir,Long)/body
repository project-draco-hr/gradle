{
  Runtime.getRuntime().addShutdownHook(new Thread(){
    public void run(){
      LOGGER.info("Daemon[pid = {}] finishing",pid);
    }
  }
);
  if (redirectIo) {
    String logFileName=String.format("daemon-%s.out.log",pid == null ? UUID.randomUUID() : pid);
    File logFile=new File(daemonDir.getVersionedDir(),logFileName);
    Files.createParentDirs(logFile);
    PrintStream printStream=new PrintStream(new FileOutputStream(logFile),true);
    outputRenderer.addStandardOutput(printStream);
    outputRenderer.addStandardError(printStream);
  }
  loggingManager.start();
}
