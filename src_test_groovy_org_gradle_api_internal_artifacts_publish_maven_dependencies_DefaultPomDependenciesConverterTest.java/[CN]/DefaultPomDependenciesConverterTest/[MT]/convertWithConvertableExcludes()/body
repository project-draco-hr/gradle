{
  final Configuration someConfigurationStub=createNamedConfigurationStubWithDependencies("someConfiguration",dependency1);
  final DefaultMavenExclude mavenExclude=new DefaultMavenExclude("a","b");
  dependency1.exclude(toMap("key","value"));
  context.checking(new Expectations(){
{
      allowing(conf2ScopeMappingContainerMock).getMapping(someConfigurationStub);
      will(returnValue(createMapping(compileConfStub,"compile")));
      allowing(excludeRuleConverterMock).convert(dependency1.getExcludeRules().iterator().next());
      will(returnValue(mavenExclude));
    }
  }
);
  List<MavenDependency> actualMavenDependencies=dependenciesConverter.convert(pomMock,toSet(someConfigurationStub));
  assertEquals(1,actualMavenDependencies.size());
  assertThat(actualMavenDependencies,hasItem((MavenDependency)DefaultMavenDependency.newInstance("org1","name1","rev1",null,"compile")));
  assertEquals(actualMavenDependencies.get(0).getMavenExcludes(),toList(mavenExclude));
  assertEquals(actualMavenDependencies.get(0).getScope(),"compile");
}
