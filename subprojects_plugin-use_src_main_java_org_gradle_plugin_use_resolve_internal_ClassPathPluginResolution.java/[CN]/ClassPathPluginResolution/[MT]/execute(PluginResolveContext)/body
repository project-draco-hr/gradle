{
  ClassPath classPath=classPathFactory.create();
  ClassLoaderScope loaderScope=parent.createChild();
  loaderScope.local(classPath);
  loaderScope.lock();
  PluginRegistry pluginRegistry=new DefaultPluginRegistry(pluginInspector,loaderScope.getLocalClassLoader());
  PotentialPluginWithId<?> plugin=pluginRegistry.lookup(pluginId);
  if (plugin == null) {
    throw new UnknownPluginException("Plugin with id '" + pluginId + "' not found.");
  }
  pluginResolveContext.add(plugin);
}
