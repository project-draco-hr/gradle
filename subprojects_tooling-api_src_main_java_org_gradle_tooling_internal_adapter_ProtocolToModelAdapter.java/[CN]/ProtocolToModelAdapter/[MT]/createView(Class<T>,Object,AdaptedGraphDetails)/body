{
  if (sourceObject == null) {
    return null;
  }
  Class<? extends T> viewType=graphDetails.typeProvider.getTargetType(targetType,sourceObject);
  if (viewType.isInstance(sourceObject)) {
    return viewType.cast(sourceObject);
  }
  if (targetType.isEnum()) {
    return adaptToEnum(targetType,sourceObject);
  }
  ViewKey viewKey=new ViewKey(viewType,sourceObject);
  Object view=graphDetails.adaptedObjects.get(viewKey);
  if (view != null) {
    return targetType.cast(view);
  }
  DefaultSourceObjectMapping mapping=new DefaultSourceObjectMapping(sourceObject,targetType);
  graphDetails.mapper.execute(mapping);
  MethodInvoker mixInMethodInvoker=NO_OP_HANDLER;
  if (mapping.mixInType != null) {
    mixInMethodInvoker=new ClassMixInMethodInvoker(mapping.mixInType,new AdaptingMethodInvoker(graphDetails,REFLECTION_METHOD_INVOKER));
  }
 else   if (mapping.mixInBean != null) {
    mixInMethodInvoker=new BeanMixInMethodInvoker(mapping.mixInBean,new AdaptingMethodInvoker(graphDetails,REFLECTION_METHOD_INVOKER));
  }
  Object proxy=Proxy.newProxyInstance(viewType.getClassLoader(),new Class<?>[]{viewType},new InvocationHandlerImpl(sourceObject,mixInMethodInvoker,graphDetails));
  graphDetails.adaptedObjects.put(viewKey,proxy);
  return viewType.cast(proxy);
}
