{
  byte fileSnapshotKind=decoder.readByte();
  if (fileSnapshotKind == 1) {
    return DirSnapshot.getInstance();
  }
 else   if (fileSnapshotKind == 2) {
    return MissingFileSnapshot.getInstance();
  }
 else   if (fileSnapshotKind == 3) {
    return new FileHashSnapshot(hashCodeSerializer.read(decoder));
  }
 else {
    throw new RuntimeException("Unable to read serialized file snapshot. Unrecognized value found in the data stream.");
  }
}
