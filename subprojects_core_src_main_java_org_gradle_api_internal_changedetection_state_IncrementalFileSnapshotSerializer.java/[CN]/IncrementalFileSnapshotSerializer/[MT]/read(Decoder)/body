{
  byte fileSnapshotKind=decoder.readByte();
  IncrementalFileSnapshot incrementalFileSnapshot;
  if (fileSnapshotKind == 1) {
    incrementalFileSnapshot=DirSnapshot.getInstance();
  }
 else   if (fileSnapshotKind == 2) {
    incrementalFileSnapshot=MissingFileSnapshot.getInstance();
  }
 else   if (fileSnapshotKind == 3) {
    incrementalFileSnapshot=new FileHashSnapshot(hashCodeSerializer.read(decoder));
  }
 else {
    throw new RuntimeException("Unable to read serialized file collection snapshot. Unrecognized value found in the data stream.");
  }
  return incrementalFileSnapshot;
}
