{
  if (value instanceof DirSnapshot) {
    encoder.writeByte((byte)1);
  }
 else   if (value instanceof MissingFileSnapshot) {
    encoder.writeByte((byte)2);
  }
 else   if (value instanceof FileHashSnapshot) {
    encoder.writeByte((byte)3);
    hashCodeSerializer.write(encoder,value.getHash());
  }
 else {
    throw new AssertionError();
  }
}
