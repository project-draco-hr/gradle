{
  nextClosure:   for (  Closure<?> closure : moduleClosures) {
    List<Object> args=Lists.newArrayList();
    for (    Class<?> argType : closure.getParameterTypes()) {
      if (argType == ComponentMetadataDetails.class || argType == Object.class) {
        args.add(details);
      }
 else       if (argType == IvyModuleDescriptor.class) {
        if (metadata.getIvyMetaData() == null) {
          continue nextClosure;
        }
        args.add(new DefaultIvyModuleDescriptor(metadata.getIvyMetaData().getExtraInfo()));
      }
 else {
        throw new GradleException(String.format("Unsupported parameter type for component metadata rule: %s",argType.getName()));
      }
    }
    closure.call(args.toArray());
  }
}
