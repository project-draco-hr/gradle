{
  if (!isValidXmlName(name)) {
    throw new IllegalArgumentException(String.format("Invalid attribute name: '%s'",name));
  }
  if (!startElement) {
    throw new IllegalStateException("Cannot write attribute [" + name + ":"+ value+ "]. You should write start element first.");
  }
  write(" ");
  write(name);
  write("=\"");
  writeXmlEncoded(value);
  write("\"");
  return this;
}
