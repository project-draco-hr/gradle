{
  Index targetIndex=index.children.get(className);
  if (targetIndex != null && testId != null) {
    targetIndex=targetIndex.children.get(testId);
  }
  if (targetIndex == null) {
    return;
  }
  boolean stdout=destination == TestOutputEvent.Destination.StdOut;
  Region region=stdout ? targetIndex.stdOut : targetIndex.stdErr;
  if (region.start < 0) {
    return;
  }
  boolean ignoreClassLevel=!allClassOutput && testId != null;
  boolean ignoreTestLevel=!allClassOutput && testId == null;
  final File file=getOutputsFile();
  try {
    Input input=new Input(new FileInputStream(file));
    skip(input,region.start);
    try {
      while (input.total() <= region.stop) {
        boolean readStdout=input.readBoolean();
        boolean isClassLevel=input.readBoolean();
        if (stdout != readStdout || (ignoreClassLevel && isClassLevel) || (ignoreTestLevel && !isClassLevel)) {
          skipNext(input);
          input.readLong(true);
          skipNext(input);
          continue;
        }
        String readClassName=readString(messageStorageCharset,input);
        if (!className.equals(readClassName)) {
          input.readLong(true);
          skipNext(input);
          continue;
        }
        boolean shouldWrite;
        if (testId == null) {
          input.readLong(true);
          shouldWrite=true;
        }
 else {
          long readTestId=input.readLong(true);
          shouldWrite=testId.longValue() == readTestId;
        }
        if (shouldWrite) {
          String message=readString(messageStorageCharset,input);
          writer.write(message);
        }
 else {
          skipNext(input);
        }
      }
    }
  finally {
      input.close();
    }
  }
 catch (  IOException e) {
    throw new UncheckedIOException(e);
  }
}
