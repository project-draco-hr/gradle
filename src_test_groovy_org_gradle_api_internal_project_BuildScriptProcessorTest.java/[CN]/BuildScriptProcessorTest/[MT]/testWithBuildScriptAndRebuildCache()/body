{
  createBuildScriptFile();
  buildScriptProcessor=new BuildScriptProcessor(importsReaderMock,null,CacheUsage.REBUILD);
  buildScriptProcessor.scriptHandler=scriptHandlerMock;
  context.checking(new Expectations(){
{
      one(scriptHandlerMock).writeToCache(with(any(testProject.getClass())),with(any(String.class)));
      will(returnValue(expectedScript));
    }
  }
);
  assertSame(expectedScript,buildScriptProcessor.createScript(testProject));
}
