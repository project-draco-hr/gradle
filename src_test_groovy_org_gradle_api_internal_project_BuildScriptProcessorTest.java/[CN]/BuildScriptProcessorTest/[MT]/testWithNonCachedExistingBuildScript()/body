{
  createBuildScriptFile();
  context.checking(new Expectations(){
{
      one(scriptHandlerMock).loadFromCache(with(same(testProject)),with(equal(testBuildScriptFile.lastModified())));
      will(returnValue(null));
      one(scriptHandlerMock).writeToCache(with(same(testProject)),with(equal(TEST_SCRIPT_TEXT + System.getProperty("line.separator") + TEST_IMPORTS)));
      will(returnValue(expectedScript));
    }
  }
);
  assertSame(expectedScript,buildScriptProcessor.createScript(testProject));
}
