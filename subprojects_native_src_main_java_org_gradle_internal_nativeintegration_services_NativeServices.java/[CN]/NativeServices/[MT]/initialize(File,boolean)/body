{
  String overrideProperty=System.getProperty(NATIVE_DIR_OVERRIDE);
  File nativeDir;
  if (overrideProperty == null) {
    nativeDir=new File(userHomeDir,"native");
  }
 else {
    nativeDir=new File(overrideProperty);
  }
  if (useNativePlatform) {
    try {
      net.rubygrapefruit.platform.Native.init(nativeDir);
    }
 catch (    NativeIntegrationUnavailableException ex) {
      if (OperatingSystem.current().isWindows()) {
        throw ex;
      }
      LOGGER.debug("Native-platform is not available.");
      useNativePlatform=false;
    }
catch (    NativeException ex) {
      if (OperatingSystem.current().isWindows()) {
        throw ex;
      }
      LOGGER.debug("Unable to initialize native-platform. Failure: {}",format(ex));
      useNativePlatform=false;
    }
  }
  if (OperatingSystem.current().isWindows() && initializeJNA) {
    new JnaBootPathConfigurer().configure(nativeDir);
  }
  initialized=true;
}
