{
  if (!(parameters instanceof CompositeConnectionParameters)) {
    return null;
  }
  List<GradleParticipantBuild> unorderedBuilds=((CompositeConnectionParameters)parameters).getBuilds();
  if (buildIdentifier == null) {
    return unorderedBuilds;
  }
  GradleParticipantBuild targetBuild=null;
  List<GradleParticipantBuild> builds=new LinkedList<GradleParticipantBuild>();
  for (  GradleParticipantBuild build : unorderedBuilds) {
    BuildIdentifier participantIdentifier=new DefaultBuildIdentifier(build.getProjectDir());
    if (participantIdentifier.equals(buildIdentifier)) {
      targetBuild=build;
    }
 else {
      builds.add(build);
    }
  }
  if (targetBuild == null) {
    throw new GradleConnectionException("Not a valid build: " + buildIdentifier,new IllegalStateException("Build not part of composite"));
  }
 else {
    builds.add(0,targetBuild);
  }
  return builds;
}
