{
  ScriptSource source;
  if (embeddedScript != null) {
    source=embeddedScript;
  }
 else   if (parent == null) {
    source=new FileScriptSource("build file",new File(rootDir,buildFileName));
  }
 else {
    File projectDir=new File(parent.getProjectDir(),name);
    source=new FileScriptSource("build file",new File(projectDir,buildFileName));
  }
  return new DefaultProject(name,parent,rootDir,buildFileName,source,buildScriptClassLoader,taskFactory,dependencyManagerFactory,buildScriptProcessor,pluginRegistry,projectRegistry,this);
}
