{
  File buildFile=projectDescriptor.getBuildFile();
  ScriptSource source;
  if (embeddedScript != null) {
    source=embeddedScript;
  }
 else   if (!buildFile.exists()) {
    source=new StringScriptSource("empty build file","");
  }
 else {
    source=new FileScriptSource("build file",buildFile);
  }
  DefaultProject project=new DefaultProject(projectDescriptor.getName(),parent,projectDescriptor.getProjectDir(),projectDescriptor.getBuildFile(),source,build.getProjectRegistry(),build,serviceRegistryFactory);
  if (parent != null) {
    parent.addChildProject(project);
  }
  build.getProjectRegistry().addProject(project);
  return project;
}
