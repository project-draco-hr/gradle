{
  File buildFile=projectDescriptor.getBuildFile();
  ScriptSource source;
  if (embeddedScript != null) {
    source=embeddedScript;
  }
 else   if (!buildFile.exists()) {
    source=new StringScriptSource("empty build file","");
  }
 else {
    source=new FileScriptSource("build file",buildFile);
  }
  DefaultProject project=new DefaultProject(projectDescriptor.getName(),parent,projectDescriptor.getProjectDir(),projectDescriptor.getBuildFile(),source,build.getBuildScriptClassLoader(),taskFactory,configurationContainerFactory,dependencyFactory,repositoryHandlerFactory,publishArtifactFactory,internalRepository,antBuilderFactory,buildScriptProcessor,pluginRegistry,build.getProjectRegistry(),build,new DefaultConvention());
  if (parent != null) {
    parent.addChildProject(project);
  }
  return project;
}
