{
  if (!versionDetails.maySupportModel(type)) {
    throw Exceptions.unsupportedModel(type,versionDetails.getVersion());
  }
  final ModelIdentifier modelIdentifier=modelMapping.getModelIdentifierFromModelType(type);
  BuildResult<?> result;
  try {
    result=builder.getModel(modelIdentifier,new BuildCancellationTokenAdapter(operationParameters.getCancellationToken()),operationParameters);
  }
 catch (  InternalUnsupportedModelException e) {
    throw Exceptions.unknownModel(type,e);
  }
catch (  RuntimeException e) {
    throw exceptionTransformer.transform(e);
  }
  FixedBuildIdentifierProvider buildIdentifierProvider=new FixedBuildIdentifierProvider(operationParameters.getRootDirectory(),":");
  Action<SourceObjectMapping> compatibilityMapperAction=getCompatibilityMapperAction(buildIdentifierProvider);
  return adapter.adapt(type,result.getModel(),compatibilityMapperAction);
}
