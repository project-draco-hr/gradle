{
  ClassLoader runtimeClassLoader=getClass().getClassLoader();
  ClassPath coreImplClassPath=classPathRegistry.getClassPath("GRADLE_CORE_IMPL");
  coreImplClassLoader=new MutableURLClassLoader(runtimeClassLoader,coreImplClassPath);
  apiOnlyClassLoader=restrictToGradleApi(classLoaderFactory,coreImplClassLoader);
  ClassPath pluginsClassPath=classPathRegistry.getClassPath("GRADLE_PLUGINS");
  ClassLoader pluginsImports=new CachingClassLoader(new MultiParentClassLoader(runtimeClassLoader,coreImplClassLoader));
  pluginsClassLoader=new MutableURLClassLoader(pluginsImports,pluginsClassPath);
  this.apiAndPluginsClassLoader=restrictToGradleApi(classLoaderFactory,pluginsClassLoader);
}
