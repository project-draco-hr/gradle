{
  Set<String> authSchemes=Sets.newHashSet();
  for (  Authentication authenticationType : authenticationTypes) {
    if (BasicAuthentication.class.isAssignableFrom(authenticationType.getClass())) {
      authSchemes.add(AuthPolicy.BASIC);
    }
 else     if (DigestAuthentication.class.isAssignableFrom(authenticationType.getClass())) {
      authSchemes.add(AuthPolicy.DIGEST);
    }
 else     if (NtlmAuthentication.class.isAssignableFrom(authenticationType.getClass())) {
      authSchemes.add(AuthPolicy.NTLM);
    }
 else {
      throw new IllegalArgumentException(String.format("Authentication type of '%s' is not supported.",authenticationType.getClass().getSimpleName()));
    }
  }
  if (authSchemes.size() == 0) {
    authSchemes.add(AuthPolicy.BASIC);
    authSchemes.add(AuthPolicy.DIGEST);
    authSchemes.add(AuthPolicy.NTLM);
  }
  return authSchemes;
}
