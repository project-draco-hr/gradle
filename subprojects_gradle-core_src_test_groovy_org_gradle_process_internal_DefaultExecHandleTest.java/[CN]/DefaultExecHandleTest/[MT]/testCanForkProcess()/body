{
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  DefaultExecHandle execHandle=new DefaultExecHandle(tmpDir.getDir(),Jvm.current().getJavaExecutable().getAbsolutePath(),Arrays.asList("-cp",System.getProperty("java.class.path"),TestApp.class.getName(),"arg1","arg2"),System.getenv(),out,System.err,new ByteArrayInputStream(new byte[0]),null);
  ExecResult result=execHandle.start().waitForFinish();
  assertEquals(ExecHandleState.SUCCEEDED,execHandle.getState());
  assertEquals(0,result.getExitValue());
  assertEquals("args: [arg1, arg2]",out.toString());
  result.assertNormalExitValue();
}
