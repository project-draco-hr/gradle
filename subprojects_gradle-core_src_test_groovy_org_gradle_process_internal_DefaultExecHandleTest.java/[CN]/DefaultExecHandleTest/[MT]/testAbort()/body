{
  DefaultExecHandle execHandle=new DefaultExecHandle(tmpDir.getDir(),Jvm.current().getJavaExecutable().getAbsolutePath(),Arrays.asList("-cp",System.getProperty("java.class.path"),SlowApp.class.getName()),System.getenv(),System.out,System.err,new ByteArrayInputStream(new byte[0]),Collections.<ExecHandleListener>emptyList());
  execHandle.start();
  execHandle.abort();
  ExecResult result=execHandle.waitForFinish();
  assertEquals(ExecHandleState.ABORTED,execHandle.getState());
  assertThat(result.getExitValue(),not(equalTo(0)));
}
