{
  if (dde.getExtraAttribute(ClientModule.CLIENT_MODULE_KEY) == null) {
    return data.getCurrentResolvedModuleRevision();
  }
  IvyContext context=IvyContext.pushNewCopyContext();
  try {
    context.setDependencyDescriptor(dde);
    context.setResolveData(data);
    ModuleDescriptor moduleDescriptor=moduleRegistry.get(dde.getExtraAttribute(ClientModule.CLIENT_MODULE_KEY));
    MetadataArtifactDownloadReport downloadReport=new MetadataArtifactDownloadReport(moduleDescriptor.getMetadataArtifact());
    downloadReport.setDownloadStatus(DownloadStatus.NO);
    downloadReport.setSearched(false);
    return new ResolvedModuleRevision(userResolver,userResolver,moduleDescriptor,downloadReport);
  }
  finally {
    IvyContext.popContext();
  }
}
