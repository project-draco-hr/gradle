{
  SystemDefaultCredentialsProvider credentialsProvider=new SystemDefaultCredentialsProvider();
  configureSslSocketConnectionFactory(builder,httpSettings.getSslContextFactory());
  configureAuthSchemeRegistry(builder);
  configureCredentials(builder,credentialsProvider,httpSettings.getAuthenticationSettings());
  configureProxyCredentials(credentialsProvider,httpSettings.getProxySettings());
  configureRetryHandler(builder);
  configureUserAgent(builder);
  builder.setDefaultCredentialsProvider(credentialsProvider);
}
