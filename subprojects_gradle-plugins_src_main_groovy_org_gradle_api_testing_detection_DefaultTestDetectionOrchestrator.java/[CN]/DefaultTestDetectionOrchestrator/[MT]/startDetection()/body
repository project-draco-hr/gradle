{
  detectionRunStateLock.lock();
  try {
    if (detectionThread == null) {
      Runnable detectionRunner=factory.createDetectionRunner();
      detectionThread=new Thread(detectionRunner);
      detectionThread.start();
    }
 else {
      throw new IllegalStateException("detection already started");
    }
  }
  finally {
    detectionRunStateLock.unlock();
  }
}
