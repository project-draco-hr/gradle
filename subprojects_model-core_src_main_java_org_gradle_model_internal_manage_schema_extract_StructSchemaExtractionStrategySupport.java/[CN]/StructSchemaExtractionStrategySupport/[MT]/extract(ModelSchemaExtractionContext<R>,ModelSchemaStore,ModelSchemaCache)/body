{
  ModelType<R> type=extractionContext.getType();
  if (!isTarget(type)) {
    return null;
  }
  validateTypeHierarchy(extractionContext,type);
  List<ModelPropertyExtractionResult<?>> propertyExtractionResults=extractPropertySchemas(extractionContext,ModelSchemaUtils.getCandidateMethods(type.getRawClass()));
  Iterable<ModelProperty<?>> properties=Iterables.transform(propertyExtractionResults,new Function<ModelPropertyExtractionResult<?>,ModelProperty<?>>(){
    @Override public ModelProperty<?> apply(    ModelPropertyExtractionResult<?> propertyResult){
      return propertyResult.getProperty();
    }
  }
);
  List<ModelSchemaAspect> aspects=aspectExtractor.extract(extractionContext,propertyExtractionResults);
  ModelSchema<R> schema=createSchema(extractionContext,store,type,properties,aspects);
  Iterable<ModelSchemaExtractionContext<?>> propertyDependencies=Iterables.transform(propertyExtractionResults,new Function<ModelPropertyExtractionResult<?>,ModelSchemaExtractionContext<?>>(){
    public ModelSchemaExtractionContext<?> apply(    ModelPropertyExtractionResult<?> propertyResult){
      return toPropertyExtractionContext(extractionContext,propertyResult,cache);
    }
  }
);
  return new ModelSchemaExtractionResult<R>(schema,propertyDependencies);
}
