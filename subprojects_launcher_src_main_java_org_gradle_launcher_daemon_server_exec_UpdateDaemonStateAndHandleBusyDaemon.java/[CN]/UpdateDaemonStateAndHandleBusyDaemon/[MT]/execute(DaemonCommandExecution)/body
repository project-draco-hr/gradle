{
  DaemonStateCoordinator stateCoordinator=execution.getDaemonStateCoordinator();
  DaemonCommandExecution existingExecution=stateCoordinator.onStartCommand(execution);
  if (existingExecution != null) {
    execution.getConnection().dispatch(new DaemonBusy(existingExecution.getCommand()));
  }
 else {
    try {
      execution.proceed();
    }
  finally {
      stateCoordinator.onFinishCommand();
    }
  }
}
