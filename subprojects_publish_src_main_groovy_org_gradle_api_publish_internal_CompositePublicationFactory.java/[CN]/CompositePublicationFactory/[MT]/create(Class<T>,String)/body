{
  for (  Map.Entry<Class<? extends Publication>,PublicationFactory> entry : factories.entrySet()) {
    if (type.isAssignableFrom(entry.getKey())) {
      return type.cast(entry.getValue().create(name));
    }
  }
  throw new InvalidUserDataException("Cannot create publications of type: " + type);
}
