{
  validateSchemes(schemes);
  if (WrapUtil.toSet("file").containsAll(schemes)) {
    return createFileTransport(name);
  }
  if (WrapUtil.toSet("http","https").containsAll(schemes)) {
    return createHttpTransport(name,credentials);
  }
  if (WrapUtil.toSet("sftp").containsAll(schemes)) {
    return createSftpTransport(name,credentials);
  }
  if (WrapUtil.toSet("s3").containsAll(schemes)) {
    return createS3Transport(name,credentials);
  }
  throw new InvalidUserDataException("You cannot mix different URL schemes for a single repository. Please declare separate repositories.");
}
