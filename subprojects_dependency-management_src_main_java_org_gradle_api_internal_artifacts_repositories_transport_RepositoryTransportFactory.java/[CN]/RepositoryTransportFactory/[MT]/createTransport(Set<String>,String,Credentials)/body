{
  validateSchemes(schemes);
  if (Collections.singleton("file").containsAll(schemes)) {
    return new FileTransport(name);
  }
  ResourceConnectorSpecification connectionDetails=new DefaultResourceConnectorSpecification(credentials);
  ExternalResourceConnector resourceConnector=findConnectorFactory(schemes).createResourceConnector(connectionDetails);
  return new ResourceConnectorRepositoryTransport(name,progressLoggerFactory,temporaryFileProvider,cachedExternalResourceIndex,timeProvider,cacheLockingManager,resourceConnector);
}
