{
  if (credentials == null) {
    return null;
  }
  if (org.gradle.internal.resource.PasswordCredentials.class.isAssignableFrom(type)) {
    return type.cast(convertPasswordCredentials(credentials));
  }
  if (type.isAssignableFrom(credentials.getClass())) {
    return type.cast(credentials);
  }
 else {
    throw new IllegalArgumentException(String.format("Credentials must be an instance of '%s'.",type.getCanonicalName()));
  }
}
