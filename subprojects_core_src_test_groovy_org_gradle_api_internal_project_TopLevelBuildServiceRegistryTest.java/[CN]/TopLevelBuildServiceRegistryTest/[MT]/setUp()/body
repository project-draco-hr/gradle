{
  startParameter.setGradleUserHomeDir(tmpDir.getDir());
  context.checking(new Expectations(){
{
      allowing(parent).getFactory(CacheFactory.class);
      will(returnValue(cacheFactoryFactory));
      allowing(cacheFactoryFactory).create();
      will(returnValue(cacheFactory));
      allowing(parent).get(ClassLoaderRegistry.class);
      will(returnValue(classLoaderRegistry));
      allowing(parent).getFactory(LoggingManagerInternal.class);
      will(returnValue(loggingManagerFactory));
    }
  }
);
}
