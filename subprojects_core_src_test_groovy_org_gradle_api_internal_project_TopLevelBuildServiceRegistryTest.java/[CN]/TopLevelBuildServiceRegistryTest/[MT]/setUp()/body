{
  startParameter.setGradleUserHomeDir(tmpDir.getDir());
  context.checking(new Expectations(){
{
      allowing(parent).get(CacheFactory.class);
      will(returnValue(cacheFactory));
      allowing(parent).get(ClassPathRegistry.class);
      will(returnValue(classPathRegistry));
      allowing(parent).get(ClassLoaderRegistry.class);
      will(returnValue(classLoaderRegistry));
      allowing(parent).getFactory(LoggingManagerInternal.class);
      will(returnValue(loggingManagerFactory));
      allowing(parent).get(ProgressLoggerFactory.class);
      will(returnValue(progressLoggerFactory));
    }
  }
);
}
