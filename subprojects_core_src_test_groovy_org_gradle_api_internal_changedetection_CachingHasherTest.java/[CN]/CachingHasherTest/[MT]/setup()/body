{
  context.checking(new Expectations(){
{
      ObjectCacheBuilder<CachingHasher.FileInfo,PersistentIndexedCache<File,CachingHasher.FileInfo>> cacheBuilder=context.mock(ObjectCacheBuilder.class);
      one(cacheRepository).indexedCache(File.class,CachingHasher.FileInfo.class,"fileHashes");
      will(returnValue(cacheBuilder));
      one(cacheBuilder).forObject(gradle);
      will(returnValue(cacheBuilder));
      one(cacheBuilder).withSerializer(with(notNullValue(Serializer.class)));
      will(returnValue(cacheBuilder));
      one(cacheBuilder).open();
      will(returnValue(cache));
    }
  }
);
  hasher=new CachingHasher(delegate,cacheRepository,gradle);
}
