{
  testConfigurations=new HashSet<Configuration>();
  final PomWriter writerMock=context.mock(PomWriter.class);
  final MavenPom testPom=context.mock(MavenPom.class);
  final String expectedPomText="somePomXml";
  context.checking(new Expectations(){
{
      one(writerMock).convert(with(same(testPom)),with(same(testConfigurations)),with(any(PrintWriter.class)));
      will(new WriteAction(expectedPomText));
    }
  }
);
  new DefaultPomFileWriter(writerMock).write(testPom,testConfigurations,dest);
  assertTrue(dest.exists());
  String wrote=FileUtils.readFileToString(dest);
  assertEquals(expectedPomText + System.getProperty("line.separator"),wrote);
}
