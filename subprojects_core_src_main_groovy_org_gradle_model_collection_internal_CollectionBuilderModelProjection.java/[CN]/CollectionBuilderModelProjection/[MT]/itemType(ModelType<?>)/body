{
  Class<?> targetClass=targetType.getRawClass();
  if (targetClass.equals(CollectionBuilder.class)) {
    Class<?> targetItemClass=targetType.getTypeVariables().get(0).getRawClass();
    if (targetItemClass.isAssignableFrom(baseItemType)) {
      return baseItemType;
    }
    if (baseItemType.isAssignableFrom(targetItemClass)) {
      return targetItemClass.asSubclass(baseItemType);
    }
    return null;
  }
  if (targetClass.isAssignableFrom(CollectionBuilder.class)) {
    return baseItemType;
  }
  return null;
}
