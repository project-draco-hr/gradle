{
  MavenProjectBuilder projectBuilder=(MavenProjectBuilder)lookup(MavenProjectBuilder.ROLE);
  ModelDefaultsInjector modelDefaultsInjector=(ModelDefaultsInjector)lookup(ModelDefaultsInjector.ROLE);
  MavenProjectHelper helper=(MavenProjectHelper)lookup(MavenProjectHelper.ROLE);
  ProfileManager profileManager=new DefaultProfileManager(getContainer(),settings,System.getProperties());
  MavenArtifactBuilder mavenArtifactBuilder=new MavenArtifactBuilder(projectBuilder,modelDefaultsInjector,helper,profileManager);
  mavenArtifactBuilder.setPomFile(pomFile);
  mavenArtifactBuilder.initialiseMavenProject(localArtifactRepository);
  if (attachedArtifacts != null) {
    for (    AttachedArtifact attached : attachedArtifacts) {
      mavenArtifactBuilder.attach(attached);
    }
  }
  return mavenArtifactBuilder;
}
