{
  byte[] path=new byte[file.getAbsolutePath().length() * 3 + 1];
  int pathLength=libC.wcstombs(path,new WString(file.getAbsolutePath()),path.length);
  if (pathLength < 0) {
    throw new RuntimeException(String.format("Could not encode file path '%s'.",file.getAbsolutePath()));
  }
  byte[] zeroTerminatedByteArray=new byte[pathLength + 1];
  System.arraycopy(path,0,zeroTerminatedByteArray,0,pathLength);
  zeroTerminatedByteArray[pathLength]=0;
  return zeroTerminatedByteArray;
}
