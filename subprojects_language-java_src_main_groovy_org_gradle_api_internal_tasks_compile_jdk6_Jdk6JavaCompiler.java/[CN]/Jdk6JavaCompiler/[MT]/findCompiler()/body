{
  File realJavaHome=Jvm.current().getJavaHome();
  File javaHomeFromToolProvidersPointOfView=new File(System.getProperty("java.home"));
  if (realJavaHome.equals(javaHomeFromToolProvidersPointOfView)) {
    return ToolProvider.getSystemJavaCompiler();
  }
  System.setProperty("java.home",realJavaHome.getAbsolutePath());
  try {
    return ToolProvider.getSystemJavaCompiler();
  }
  finally {
    System.setProperty("java.home",javaHomeFromToolProvidersPointOfView.getAbsolutePath());
  }
}
