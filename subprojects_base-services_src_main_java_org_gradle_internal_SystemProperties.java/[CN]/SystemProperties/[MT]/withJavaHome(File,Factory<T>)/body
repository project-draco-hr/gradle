{
  lock.lock();
  File originalJavaHomeDir=getJavaHomeDir();
  setJavaHomeDir(javaHomeDir);
  try {
    return factory.create();
  }
  finally {
    setJavaHomeDir(originalJavaHomeDir);
    lock.unlock();
  }
}
