{
  TestDescriptorInternal testInternal;
synchronized (lock) {
    testInternal=executing.get(test);
  }
  boolean needEndEvent=false;
  if (testInternal == null) {
    testInternal=convertForError(test);
    needEndEvent=true;
    doStartTest(test,testInternal);
  }
  resultProcessor.failure(testInternal.getId(),throwable);
  if (needEndEvent) {
    endTest(test);
  }
}
