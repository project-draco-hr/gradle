{
  OutputListenerImpl outputListener=new OutputListenerImpl();
  OutputListenerImpl errorListener=new OutputListenerImpl();
  BuildListenerImpl buildListener=new BuildListenerImpl();
  BuildResult result=doRun(outputListener,errorListener,buildListener);
  result.rethrowFailure();
  return new InProcessExecutionResult(buildListener.executedTasks,buildListener.skippedTasks,outputListener.toString(),errorListener.toString());
}
