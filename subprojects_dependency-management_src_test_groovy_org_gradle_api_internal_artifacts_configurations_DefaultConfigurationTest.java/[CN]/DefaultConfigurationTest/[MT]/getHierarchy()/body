{
  Configuration root1=createNamedConfiguration("root1");
  Configuration middle1=createNamedConfiguration("middle1").extendsFrom(root1);
  Configuration root2=createNamedConfiguration("root2");
  Configuration middle2=createNamedConfiguration("middle2").extendsFrom(root1,root2);
  createNamedConfiguration("root3");
  Configuration leaf=createNamedConfiguration("leaf1").extendsFrom(middle1,middle2);
  Set<Configuration> hierarchy=leaf.getHierarchy();
  assertThat(hierarchy.size(),equalTo(5));
  assertThat(hierarchy.iterator().next(),equalTo(leaf));
  assertBothExistsAndOneIsBeforeOther(hierarchy,middle1,root1);
  assertBothExistsAndOneIsBeforeOther(hierarchy,middle2,root2);
}
