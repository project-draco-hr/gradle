{
  action.execute(new CopyActionProcessingStream(){
    public void process(    Action<? super FileCopyDetailsInternal> action){
      for (      FileCopyDetailsInternal f : files) {
        if (f.isDirectory()) {
          action.execute(f);
        }
 else {
          action.execute(f);
        }
      }
    }
  }
);
}
