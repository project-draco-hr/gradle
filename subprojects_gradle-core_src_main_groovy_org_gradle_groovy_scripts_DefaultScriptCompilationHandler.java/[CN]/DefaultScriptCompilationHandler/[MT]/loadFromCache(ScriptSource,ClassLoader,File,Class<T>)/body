{
  String scriptText=source.getText();
  String scriptName=source.getClassName();
  CachePropertiesHandler.CacheState cacheState=cachePropertiesHandler.getCacheState(scriptText,scriptCacheDir);
  if (cacheState == CachePropertiesHandler.CacheState.INVALID) {
    return null;
  }
  Clock clock=new Clock();
  Script script;
  try {
    URLClassLoader urlClassLoader=new URLClassLoader(WrapUtil.toArray(scriptCacheDir.toURI().toURL()),classLoader);
    script=(Script)urlClassLoader.loadClass(scriptName).newInstance();
  }
 catch (  ClassNotFoundException e) {
    logger.debug("Class not in cache: ",e);
    return null;
  }
catch (  Exception e) {
    throw new GradleException(e);
  }
  if (!scriptBaseClass.isInstance(script)) {
    return null;
  }
  logger.debug("Timing: Loading script from cache took: {}",clock.getTime());
  return scriptBaseClass.cast(script);
}
