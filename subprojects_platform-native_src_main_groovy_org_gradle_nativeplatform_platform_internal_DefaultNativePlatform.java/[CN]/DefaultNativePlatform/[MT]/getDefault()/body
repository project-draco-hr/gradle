{
  ArchitectureInternal architecture=getCurrentArchitecture();
  if (getCurrentOs().isWindows() && architecture.getInstructionSet() == ArchitectureInternal.InstructionSet.X86 && architecture.getRegisterSize() == 64) {
    architecture=new DefaultArchitecture(architecture.getName(),ArchitectureInternal.InstructionSet.X86,32);
  }
  OperatingSystem currentOs=OperatingSystem.current();
  OperatingSystemInternal operatingSystem=new DefaultOperatingSystem(currentOs.getName(),currentOs);
  return new DefaultNativePlatform(getDefaultName(architecture,operatingSystem),architecture,operatingSystem);
}
