{
  if (artifactResolver.getRepositoryCacheManager() instanceof LocalFileRepositoryCacheManager) {
    return downloadWithoutCache(artifactResolver,artifact,options);
  }
  ArtifactResolutionCache.CachedArtifactResolution cachedArtifactResolution=artifactResolutionCache.getCachedArtifactResolution(artifactResolver,artifact.getId());
  if (cachedArtifactResolution != null) {
    if (cachedArtifactResolution.getArtifactFile() == null) {
      LOGGER.debug("Detected non-existence of artifact '{}' in resolver cache",artifact.getId());
      return null;
    }
    if (cachedArtifactResolution.getArtifactFile().exists()) {
      LOGGER.debug("Found artifact '{}' in resolver cache: {}",artifact.getId(),cachedArtifactResolution.getArtifactFile());
      return cachedArtifactResolution.getArtifactFile();
    }
  }
  File artifactFile=downloadWithoutCache(artifactResolver,artifact,options);
  LOGGER.debug("Downloaded artifact '{}' from resolver: {}",artifact.getId(),artifactFile);
  artifactResolutionCache.recordArtifactResolution(artifactResolver,artifact.getId(),artifactFile);
  return artifactFile;
}
