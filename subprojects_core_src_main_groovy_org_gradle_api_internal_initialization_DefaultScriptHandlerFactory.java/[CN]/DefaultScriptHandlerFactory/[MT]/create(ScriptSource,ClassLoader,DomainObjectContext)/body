{
  DependencyResolutionServices services=dependencyManagementServices.create(fileResolver,dependencyMetaDataProvider,projectFinder,context);
  RepositoryHandler repositoryHandler=services.getResolveRepositoryHandler();
  ConfigurationContainer configurationContainer=services.getConfigurationContainer();
  DependencyHandler dependencyHandler=services.getDependencyHandler();
  Collection<Object> key=Arrays.asList(scriptSource.getClassName(),parentClassLoader);
  ClassLoader classLoader=classLoaderCache.get(key);
  if (classLoader == null) {
    DefaultScriptHandler handler=new DefaultScriptHandler(scriptSource,repositoryHandler,dependencyHandler,configurationContainer,parentClassLoader);
    classLoader=handler.getClassLoader();
    classLoaderCache.put(key,classLoader);
    return handler;
  }
  return new NoClassLoaderUpdateScriptHandler(parentClassLoader,classLoader,repositoryHandler,dependencyHandler,scriptSource,configurationContainer);
}
