{
  try {
    OutputStream outStr=new FileOutputStream(destination);
switch (compression) {
case GZIP:
      return new GZIPOutputStream(outStr);
case BZIP2:
    outStr.write('B');
  outStr.write('Z');
return new CBZip2OutputStream(outStr);
default :
return outStr;
}
}
 catch (Exception e) {
String message=String.format("Unable to create output stream for file: %s due to: %s ",destination,e.getMessage());
throw new RuntimeException(message,e);
}
}
