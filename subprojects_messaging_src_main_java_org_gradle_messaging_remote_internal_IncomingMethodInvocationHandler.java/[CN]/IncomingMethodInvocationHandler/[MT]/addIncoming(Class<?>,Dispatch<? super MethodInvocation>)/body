{
  Set<Class<?>> incomingTypes=new HashSet<Class<?>>();
  addInterfaces(type,incomingTypes);
  for (  Class<?> incomingType : incomingTypes) {
    if (!classes.add(incomingType)) {
      throw new IllegalArgumentException(String.format("A handler has already been added for type '%s'.",incomingType.getName()));
    }
    connection.addIncomingChannel(incomingType.getName(),new TypeCastDispatch<MethodInvocation,Object>(MethodInvocation.class,dispatch));
  }
}
