{
  if (lib instanceof NativeDependencySet) {
    return (NativeDependencySet)lib;
  }
  if (lib instanceof Library) {
    return resolve(target,((Library)lib).getShared());
  }
  if (lib instanceof ContextualLibraryResolver) {
    return ((ContextualLibraryResolver)lib).withFlavor(target.getFlavor()).withToolChain(target.getToolChain()).withPlatform(target.getTargetPlatform()).resolve();
  }
  if (lib instanceof LibraryResolver) {
    return ((LibraryResolver)lib).resolve();
  }
  throw new InvalidUserDataException("Not a valid type for a library dependency: " + lib);
}
