{
  super(type,((ProjectInternal)task.getProject()).getServices().get(Instantiator.class));
  task.getInputs().property("reports.enabledReportNames",new Callable<Collection<String>>(){
    @Override public Collection<String> call() throws Exception {
      return CollectionUtils.collect(getEnabled(),new TreeSet<String>(),REPORT_NAME);
    }
  }
);
  task.getOutputs().configure(new Action<TaskOutputs>(){
    @Override public void execute(    TaskOutputs taskOutputs){
      for (      final Report report : getEnabled()) {
        Callable<File> futureFile=new Callable<File>(){
          @Override public File call() throws Exception {
            return report.getDestination();
          }
        }
;
switch (report.getOutputType()) {
case FILE:
          taskOutputs.file(futureFile);
        break;
case DIRECTORY:
      taskOutputs.dir(futureFile);
    break;
default :
  throw new AssertionError();
}
}
((TaskInternal)task).prependParallelSafeAction(new Action<Task>(){
@Override public void execute(Task task){
for (Report report : getEnabled()) {
switch (report.getOutputType()) {
case FILE:
    File file=FileUtils.canonicalize(report.getDestination());
  GFileUtils.mkdirs(file.getParentFile());
break;
case DIRECTORY:
file=FileUtils.canonicalize(report.getDestination());
GFileUtils.mkdirs(file);
break;
default :
throw new AssertionError();
}
}
}
}
);
}
}
);
}
