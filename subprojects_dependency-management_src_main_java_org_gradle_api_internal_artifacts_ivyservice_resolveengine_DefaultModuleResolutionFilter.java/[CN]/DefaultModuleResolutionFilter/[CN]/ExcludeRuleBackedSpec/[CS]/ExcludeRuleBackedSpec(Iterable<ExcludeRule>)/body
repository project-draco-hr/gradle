{
  for (  ExcludeRule rule : excludeRules) {
    if (!(rule.getMatcher() instanceof ExactPatternMatcher)) {
      excludeSpecs.add(new ExcludeRuleSpec(rule));
      continue;
    }
    ArtifactId artifactId=rule.getId();
    ModuleId moduleId=artifactId.getModuleId();
    boolean wildcardOrganisation=MatcherHelper.matchesAnyExpression(moduleId.getOrganisation());
    boolean wildcardModule=MatcherHelper.matchesAnyExpression(moduleId.getName());
    if (wildcardOrganisation && wildcardModule) {
      excludeSpecs.add(new ExcludeRuleSpec(rule));
    }
 else     if (wildcardOrganisation) {
      excludeSpecs.add(new ModuleNameSpec(moduleId.getName()));
    }
 else     if (wildcardModule) {
      excludeSpecs.add(new GroupNameSpec(moduleId.getOrganisation()));
    }
 else {
      boolean wildcardName=MatcherHelper.matchesAnyExpression(artifactId.getName());
      boolean wildcardType=MatcherHelper.matchesAnyExpression(artifactId.getType());
      boolean wildcardExt=MatcherHelper.matchesAnyExpression(artifactId.getExt());
      if (wildcardName && wildcardType && wildcardExt) {
        excludeSpecs.add(new ModuleIdSpec(moduleId.getOrganisation(),moduleId.getName()));
      }
 else {
        excludeSpecs.add(new ExcludeRuleSpec(rule));
      }
    }
  }
}
