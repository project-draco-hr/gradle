{
  for (  ExcludeRule rule : excludeRules) {
    if (!(rule.getMatcher() instanceof ExactPatternMatcher)) {
      excludeSpecs.add(new ExcludeRuleSpec(rule));
      continue;
    }
    ArtifactId artifactId=rule.getId();
    ModuleId moduleId=artifactId.getModuleId();
    boolean anyOrganisation=isWildcard(moduleId.getOrganisation());
    boolean anyModule=isWildcard(moduleId.getName());
    boolean anyArtifact=isWildcard(artifactId.getName()) && isWildcard(artifactId.getType()) && isWildcard(artifactId.getExt());
    if (anyArtifact) {
      if (!anyOrganisation && !anyModule) {
        excludeSpecs.add(new ModuleIdExcludeSpec(moduleId.getOrganisation(),moduleId.getName()));
      }
 else       if (!anyModule) {
        excludeSpecs.add(new ModuleNameExcludeSpec(moduleId.getName()));
      }
 else       if (!anyOrganisation) {
        excludeSpecs.add(new GroupNameExcludeSpec(moduleId.getOrganisation()));
      }
 else {
        excludeSpecs.add(new ExcludeAllModulesSpec());
      }
    }
 else {
      excludeSpecs.add(new ArtifactExcludeSpec(rule));
    }
  }
}
