{
  IncomingMethodInvocationHandler incoming=new IncomingMethodInvocationHandler(classLoader);
  final OutgoingConnection<Message> messageConnection=connector.accept(incoming.getIncomingDispatch());
  OutgoingMethodInvocationHandler outgoing=new OutgoingMethodInvocationHandler(messageConnection);
  final AtomicReference<ObjectConnection> connectionRef=new AtomicReference<ObjectConnection>();
  AsyncStoppable stopControl=new AsyncStoppable(){
    public void requestStop(){
      messageConnection.requestStop();
    }
    public void stop(){
      messageConnection.stop();
      connections.remove(connectionRef.get());
    }
  }
;
  DefaultObjectConnection connection=new DefaultObjectConnection(messageConnection,stopControl,outgoing,incoming);
  connectionRef.set(connection);
  connections.add(connection);
  return connection;
}
