{
  SftpClientFactory sftpClientFactory=new SftpClientFactory(credentials);
  SftpResourceAccessor accessor=new SftpResourceAccessor(sftpClientFactory);
  SftpResourceUploader uploader=new SftpResourceUploader(sftpClientFactory);
  ProgressLoggingExternalResourceAccessor loggingAccessor=new ProgressLoggingExternalResourceAccessor(accessor,progressLoggerFactory);
  return new DefaultExternalResourceRepository(name,accessor,new ProgressLoggingExternalResourceUploader(uploader,progressLoggerFactory),new SftpResourceLister(sftpClientFactory),temporaryFileProvider,new DefaultCacheAwareExternalResourceAccessor(loggingAccessor,cachedExternalResourceIndex,timeProvider));
}
