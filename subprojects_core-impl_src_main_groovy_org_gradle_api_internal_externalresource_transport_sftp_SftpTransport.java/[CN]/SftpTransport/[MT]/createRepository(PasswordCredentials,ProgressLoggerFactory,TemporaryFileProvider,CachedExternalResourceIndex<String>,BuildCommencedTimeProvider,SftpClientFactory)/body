{
  SftpResourceAccessor accessor=new SftpResourceAccessor(sftpClientFactory,credentials);
  SftpResourceUploader uploader=new SftpResourceUploader(sftpClientFactory,credentials);
  ProgressLoggingExternalResourceAccessor loggingAccessor=new ProgressLoggingExternalResourceAccessor(accessor,progressLoggerFactory);
  return new DefaultExternalResourceRepository(name,accessor,new ProgressLoggingExternalResourceUploader(uploader,progressLoggerFactory),new SftpResourceLister(sftpClientFactory,credentials),temporaryFileProvider,new DefaultCacheAwareExternalResourceAccessor(loggingAccessor,cachedExternalResourceIndex,timeProvider));
}
