{
  List<String> lines=daemonProcess.readInputStreamLines();
  if (lines.isEmpty() || !lines.get(lines.size() - 1).startsWith(DaemonMessages.ABOUT_TO_CLOSE_STREAMS)) {
    int exitValue;
    try {
      exitValue=daemonProcess.exitValue();
    }
 catch (    IllegalThreadStateException e) {
      throw new GradleException(DaemonMessages.UNABLE_TO_START_DAEMON + " However, it appears the process hasn't exited yet as we couldn't get its exit value." + "\n"+ processOutput(lines));
    }
    throw new GradleException(DaemonMessages.UNABLE_TO_START_DAEMON + " The exit value was: " + exitValue+ "."+ "\n"+ processOutput(lines));
  }
  String lastLine=lines.get(lines.size() - 1);
  return new DaemonStartupCommunication().readDiagnostics(lastLine);
}
