{
  try {
    final int forkId=Integer.parseInt(arguments.get(1));
    final URI testServerUri=new URI(arguments.get(2));
    TcpMessagingClient client=new TcpMessagingClient(getClass().getClassLoader(),testServerUri);
    try {
      Dispatch<TestClientControlMessage> outgoing=client.getConnection().addOutgoing(Dispatch.class);
      outgoing.dispatch(new ForkStartedMessage(forkId));
      TestControlMessageDispatcher testControlMessageDispatcher=new TestControlMessageDispatcher(forkId,outgoing,sandboxClassLoader);
      testControlMessageDispatcher.waitForExitReceived();
      outgoing.dispatch(new ForkStoppedMessage(forkId));
    }
  finally {
      client.stop();
    }
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
}
