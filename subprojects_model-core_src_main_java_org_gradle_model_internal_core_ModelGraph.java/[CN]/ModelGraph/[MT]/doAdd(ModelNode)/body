{
  flattened.put(node.getPath(),node);
  notifying=true;
  try {
    notifyListeners(node,pathListeners.get(node.getPath()));
    notifyListeners(node,parentListeners.get(node.getPath().getParent()));
    notifyListeners(node,scopeListeners.get(node.getPath()));
    notifyListeners(node,scopeListeners.get(node.getPath().getParent()));
    notifyListeners(node,listeners);
  }
  finally {
    notifying=false;
  }
}
