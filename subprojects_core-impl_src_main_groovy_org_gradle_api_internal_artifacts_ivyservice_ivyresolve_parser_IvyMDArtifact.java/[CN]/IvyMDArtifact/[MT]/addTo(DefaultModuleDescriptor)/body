{
  if (configurations.isEmpty()) {
    throw new IllegalArgumentException("Artifact should be attached to at least one configuration.");
  }
  MDArtifact newArtifact=new MDArtifact(md,artName,type,ext,url,extraAttributes);
  Artifact[] allArtifacts=target.getAllArtifacts();
  for (  Artifact existing : allArtifacts) {
    if (artifactsEqual(existing,newArtifact)) {
      if (!(existing instanceof MDArtifact)) {
        throw new IllegalArgumentException("Cannot update an existing artifact (" + existing + ") in provided module descriptor ("+ target+ ")"+ " because the artifact is not an instance of MDArtifact."+ target);
      }
      addArtifact((MDArtifact)existing,this.configurations,target);
      return;
    }
  }
  addArtifact(newArtifact,this.configurations,target);
}
