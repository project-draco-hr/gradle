{
  ServerSocketChannel serverSocket;
  int localPort;
  try {
    serverSocket=ServerSocketChannel.open();
    serverSockets.add(serverSocket);
    serverSocket.socket().bind(new InetSocketAddress(0));
    localPort=serverSocket.socket().getLocalPort();
  }
 catch (  Exception e) {
    throw UncheckedException.throwAsUncheckedException(e);
  }
  Object id=idGenerator.generateId();
  List<InetAddress> addresses=allowRemote ? addressFactory.findRemoteAddresses() : addressFactory.findLocalAddresses();
  Address address=new MultiChoiceAddress(id,localPort,addresses);
  LOGGER.debug("Listening on {}.",address);
  executor.execute(new Receiver<T>(serverSocket,action,serializer,allowRemote));
  return address;
}
