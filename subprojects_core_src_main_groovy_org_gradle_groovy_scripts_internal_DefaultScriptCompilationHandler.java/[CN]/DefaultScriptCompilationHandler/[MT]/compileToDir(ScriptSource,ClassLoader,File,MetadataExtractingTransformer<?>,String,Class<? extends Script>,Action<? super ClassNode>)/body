{
  Clock clock=new Clock();
  GFileUtils.deleteDirectory(classesDir);
  GFileUtils.mkdirs(classesDir);
  CompilerConfiguration configuration=createBaseCompilerConfiguration(scriptBaseClass);
  configuration.setTargetDirectory(classesDir);
  Transformer transformer=extractingTransformer != null ? extractingTransformer.getTransformer() : null;
  try {
    compileScript(source,classLoader,configuration,classesDir,transformer,verifier,classpathClosureName);
  }
 catch (  GradleException e) {
    GFileUtils.deleteDirectory(classesDir);
    throw e;
  }
  logger.debug("Timing: Writing script to cache at {} took: {}",classesDir.getAbsolutePath(),clock.getTime());
}
