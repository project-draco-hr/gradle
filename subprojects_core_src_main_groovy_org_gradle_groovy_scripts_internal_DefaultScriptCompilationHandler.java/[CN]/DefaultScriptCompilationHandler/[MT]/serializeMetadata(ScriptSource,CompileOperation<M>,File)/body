{
  if (extractingTransformer == null || extractingTransformer.getDataSerializer() == null) {
    return;
  }
  File metadataFile=new File(metadataDir,METADATA_FILE_NAME);
  try {
    GFileUtils.mkdirs(metadataDir);
    KryoBackedEncoder encoder=new KryoBackedEncoder(new FileOutputStream(metadataFile));
    try {
      Serializer<M> serializer=extractingTransformer.getDataSerializer();
      serializer.write(encoder,extractingTransformer.getExtractedData());
    }
  finally {
      encoder.close();
    }
  }
 catch (  Exception e) {
    String transformerName=extractingTransformer.getTransformer().getClass().getName();
    throw new IllegalStateException(String.format("Failed to serialize script metadata extracted using %s for %s",transformerName,scriptSource.getDisplayName()),e);
  }
}
