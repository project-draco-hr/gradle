{
  TaskExecution thisExecution=history.getCurrentExecution();
  TaskExecution lastExecution=history.getPreviousExecution();
  upToDateSpecState=TaskUpToDateSpecStateChangeRule.create(task);
  noHistoryState=NoHistoryStateChangeRule.create(task,lastExecution);
  taskTypeState=TaskTypeStateChangeRule.create(task,lastExecution,thisExecution);
  inputPropertiesState=InputPropertiesStateChangeRule.create(task,lastExecution,thisExecution);
  outputFilesState=OutputFilesStateChangeRule.create(task,lastExecution,thisExecution,outputFilesSnapshotter);
  inputFilesState=InputFilesStateChangeRule.create(task,lastExecution,thisExecution,inputFilesSnapshotter,MAX_OUT_OF_DATE_MESSAGES);
  allTaskChanges=new SummaryTaskStateChanges(MAX_OUT_OF_DATE_MESSAGES,upToDateSpecState,noHistoryState,taskTypeState,inputPropertiesState,outputFilesState,inputFilesState);
  rebuildChanges=new SummaryTaskStateChanges(1,upToDateSpecState,noHistoryState,taskTypeState,inputPropertiesState,outputFilesState);
}
