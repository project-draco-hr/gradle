{
  if (streamHandle.equals(INVALID_HANDLE_VALUE)) {
    throw new IOException("Invalid handle. Errno: " + kernel32.GetLastError());
  }
  boolean ok=kernel32.SetHandleInformation(streamHandle,HANDLE_FLAG_INHERIT,0);
  if (!ok) {
    int setHandleError=kernel32.GetLastError();
    if (setHandleError == ERROR_INVALID_PARAMETER) {
      LOGGER.warn("Invalid parameter attempting to uninherit stream - child process may remain attached.");
      return;
    }
    if (setHandleError == ERROR_INVALID_HANDLE) {
      LOGGER.warn("Invalid handle attempting to uninherit stream - child process may remain attached.");
      return;
    }
    throw new IOException("Could not set flag on handle. Errno: " + kernel32.GetLastError());
  }
}
