{
  final Artifact ivyArtifact=DefaultArtifactIdentifier.toArtifact(artifact);
  DownloadReport download=cacheAccess.useCache("ivy download",new Factory<DownloadReport>(){
    public DownloadReport create(){
      return resolver.download(new Artifact[]{ivyArtifact},downloadOptions);
    }
  }
);
  ArtifactDownloadReport artifactDownloadReport=download.getArtifactReport(ivyArtifact);
  if (downloadFailed(artifactDownloadReport)) {
    if (artifactDownloadReport instanceof EnhancedArtifactDownloadReport) {
      EnhancedArtifactDownloadReport enhancedReport=(EnhancedArtifactDownloadReport)artifactDownloadReport;
      result.failed(new ArtifactResolveException(artifact,enhancedReport.getFailure()));
    }
 else {
      result.failed(new ArtifactResolveException(artifact,artifactDownloadReport.getDownloadDetails()));
    }
    return;
  }
  File localFile=artifactDownloadReport.getLocalFile();
  if (localFile != null) {
    result.resolved(localFile);
  }
 else {
    result.notFound(artifact);
  }
}
