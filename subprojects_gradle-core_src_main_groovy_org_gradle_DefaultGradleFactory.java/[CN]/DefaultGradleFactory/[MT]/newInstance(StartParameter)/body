{
  loggingConfigurer.configure(startParameter.getLogLevel());
  ImportsReader importsReader=new ImportsReader(startParameter.getDefaultImportsFile());
  CachePropertiesHandler cachePropertiesHandler=new DefaultCachePropertiesHandler();
  ISettingsFinder settingsFinder=new EmbeddedScriptSettingsFinder(new DefaultSettingsFinder(WrapUtil.<ISettingsFileSearchStrategy>toList(new MasterDirSettingsFinderStrategy(),new ParentDirSettingsFinderStrategy())));
  ConfigurationContainerFactory configurationContainerFactory=new DefaultConfigurationContainerFactory(startParameter.getProjectDependenciesBuildInstruction());
  DefaultInternalRepository internalRepository=new DefaultInternalRepository();
  DependencyFactory dependencyFactory=new DefaultDependencyFactory(WrapUtil.<IDependencyImplementationFactory>toSet(new ModuleDependencyFactory(),new SelfResolvingDependencyFactory()),new DefaultClientModuleFactory(),new DefaultProjectDependencyFactory());
  ResolverFactory resolverFactory=new DefaultResolverFactory();
  ScriptProcessorFactory scriptProcessorFactory=new DefaultScriptProcessorFactory(new DefaultScriptCompilationHandler(cachePropertiesHandler),startParameter.getCacheUsage());
  DefaultProjectEvaluator projectEvaluator=new DefaultProjectEvaluator(new BuildScriptCompiler(importsReader,scriptProcessorFactory,new DefaultProjectScriptMetaData()),new BuildScriptEvaluator());
  ClassGenerator classGenerator=new DefaultClassGenerator();
  ServiceRegistryFactory serviceRegistryFactory=new DefaultServiceRegistryFactory(new DefaultRepositoryHandlerFactory(resolverFactory,classGenerator),configurationContainerFactory,new DefaultPublishArtifactFactory(),dependencyFactory,projectEvaluator,classGenerator);
  InitScriptHandler initScriptHandler=new InitScriptHandler(new UserHomeInitScriptFinder(new DefaultInitScriptFinder()),new DefaultInitScriptProcessor(scriptProcessorFactory,new DefaultInitScriptMetaData()));
  DefaultGradle gradle=new DefaultGradle(startParameter,internalRepository,serviceRegistryFactory);
  gradle.addBuildListener(internalRepository);
  return new GradleLauncher(gradle,initScriptHandler,new SettingsHandler(settingsFinder,new PropertiesLoadingSettingsProcessor(new ScriptEvaluatingSettingsProcessor(new DefaultSettingsScriptMetaData(),scriptProcessorFactory,importsReader,new SettingsFactory(new DefaultProjectDescriptorRegistry()))),new BuildSourceBuilder(new DefaultGradleFactory(new LoggingConfigurer(){
    public void configure(    LogLevel logLevel){
    }
  }
,commandLine2StartParameterConverter),new DefaultCacheInvalidationStrategy())),new DefaultGradlePropertiesLoader(),new BuildLoader(new ProjectFactory(serviceRegistryFactory,startParameter.getBuildScriptSource())),new BuildConfigurer(new ProjectDependencies2TaskResolver()));
}
