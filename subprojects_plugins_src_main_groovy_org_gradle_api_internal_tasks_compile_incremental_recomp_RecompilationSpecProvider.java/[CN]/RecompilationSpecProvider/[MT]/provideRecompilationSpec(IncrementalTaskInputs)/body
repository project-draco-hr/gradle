{
  ClassDependencyInfo dependencyInfo=dependencyInfoProvider.provideInfo();
  PreviousCompilation previousCompilation=new PreviousCompilation(dependencyInfo,jarSnapshotCache);
  DefaultRecompilationSpec spec=new DefaultRecompilationSpec(dependencyInfo);
  JavaChangeProcessor javaChangeProcessor=new JavaChangeProcessor(dependencyInfo,sourceToNameConverter);
  JarChangeProcessor jarChangeProcessor=new JarChangeProcessor(fileOperations,jarSnapshotter,previousCompilation);
  InputChangeAction action=new InputChangeAction(spec,javaChangeProcessor,jarChangeProcessor);
  inputs.outOfDate(action);
  if (action.spec.fullRebuildCause != null) {
    return action.spec;
  }
  inputs.removed(action);
  return action.spec;
}
