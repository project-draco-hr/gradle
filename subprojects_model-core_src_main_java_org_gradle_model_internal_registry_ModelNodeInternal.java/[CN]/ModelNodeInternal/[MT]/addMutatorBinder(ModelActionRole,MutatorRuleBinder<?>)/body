{
  if (!canApply(role)) {
    throw new IllegalStateException(String.format("Cannot add %s rule '%s' for model element '%s' when element is in state %s.",role,mutator.getAction().getDescriptor(),getPath(),getState()));
  }
  if (mutators == null) {
    mutators=Maps.newEnumMap(ModelActionRole.class);
  }
  List<MutatorRuleBinder<?>> mutatorsForRole=mutators.get(role);
  if (mutatorsForRole == null) {
    mutatorsForRole=Lists.newLinkedList();
    mutators.put(role,mutatorsForRole);
  }
  mutatorsForRole.add(mutator);
}
