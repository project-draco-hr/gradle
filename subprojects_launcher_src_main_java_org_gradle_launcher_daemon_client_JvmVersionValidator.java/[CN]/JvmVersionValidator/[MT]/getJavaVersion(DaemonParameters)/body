{
  JavaVersion version=cachedResults.get(parameters.getEffectiveJvm());
  if (version != null) {
    return version;
  }
  ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  ExecHandleBuilder builder=new ExecHandleBuilder();
  builder.setWorkingDir(new File(".").getAbsolutePath());
  builder.setCommandLine(parameters.getEffectiveJvm().getJavaExecutable(),"-version");
  builder.setStandardOutput(new ByteArrayOutputStream());
  builder.setErrorOutput(outputStream);
  builder.build().start().waitForFinish().assertNormalExitValue();
  version=parseJavaVersionCommandOutput(new BufferedReader(new InputStreamReader(new ByteArrayInputStream(outputStream.toByteArray()))));
  cachedResults.put(parameters.getEffectiveJvm(),version);
  return version;
}
