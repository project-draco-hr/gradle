{
  ExcludeRule excludeRule=new DefaultExcludeRule(WrapUtil.toMap("other","org"));
  org.apache.ivy.core.module.descriptor.ExcludeRule ivyExcludeRule=HelperUtil.getTestExcludeRule("other");
  expectExcludeRuleConversion(excludeRule,ivyExcludeRule);
  ExternalDependency excludingBoth=new DefaultExternalModuleDependency("org.gradle","gradle-core","1.0",TEST_DEP_CONF);
  excludingBoth.exclude(TEST_EXCLUDE_RULE.getExcludeArgs());
  excludingBoth.exclude(excludeRule.getExcludeArgs());
  externalModuleDependencyDescriptorFactory.addDependencyDescriptor(TEST_CONF,moduleDescriptor,excludingBoth);
  assertDescriptorHasIvyExcludeRules(TEST_IVY_EXCLUDE_RULE,ivyExcludeRule);
  ExternalDependency excludingOne=new DefaultExternalModuleDependency("org.gradle","gradle-core","1.0",TEST_OTHER_DEP_CONF);
  excludingOne.exclude(excludeRule.getExcludeArgs());
  externalModuleDependencyDescriptorFactory.addDependencyDescriptor(TEST_CONF,moduleDescriptor,excludingOne);
  assertDescriptorHasIvyExcludeRules(ivyExcludeRule);
  ExternalDependency excludingNone=new DefaultExternalModuleDependency("org.gradle","gradle-core","1.0",TEST_OTHER_DEP_CONF);
  externalModuleDependencyDescriptorFactory.addDependencyDescriptor(TEST_CONF,moduleDescriptor,excludingNone);
  assertDescriptorHasIvyExcludeRules();
}
