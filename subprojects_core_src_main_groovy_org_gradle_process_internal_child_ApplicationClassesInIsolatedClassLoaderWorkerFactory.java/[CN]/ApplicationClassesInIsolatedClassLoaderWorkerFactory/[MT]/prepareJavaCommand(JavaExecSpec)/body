{
  execSpec.setMain(IsolatedGradleWorkerMain.class.getName());
  execSpec.classpath(classPathRegistry.getClassPath("WORKER_PROCESS").getAsFiles());
  Collection<URI> applicationClassPath=new DefaultClassPath(processBuilder.getApplicationClasspath()).getAsURIs();
  ByteArrayOutputStream bytes=new ByteArrayOutputStream();
  try {
    DataOutputStream outstr=new DataOutputStream(new EncodedStream.EncodedOutput(bytes));
    outstr.writeInt(applicationClassPath.size());
    for (    URI entry : applicationClassPath) {
      outstr.writeUTF(entry.toString());
    }
    GUtil.serialize(create(),outstr);
    outstr.flush();
  }
 catch (  IOException e) {
    throw new UncheckedIOException(e);
  }
  execSpec.setStandardInput(new ByteArrayInputStream(bytes.toByteArray()));
}
