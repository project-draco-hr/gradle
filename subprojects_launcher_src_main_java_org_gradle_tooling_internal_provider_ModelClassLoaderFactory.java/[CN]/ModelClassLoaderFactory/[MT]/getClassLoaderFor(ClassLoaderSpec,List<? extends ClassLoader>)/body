{
  if (spec.equals(ClassLoaderSpec.SYSTEM_CLASS_LOADER)) {
    return rootClassLoader;
  }
  if (spec instanceof MutableURLClassLoader.Spec) {
    MutableURLClassLoader.Spec clSpec=(MutableURLClassLoader.Spec)spec;
    if (parents.size() != 1) {
      throw new IllegalStateException("Expected exactly one parent ClassLoader");
    }
    return new MixInClassLoader(parents.get(0),clSpec.getClasspath());
  }
  return classLoaderFactory.createClassLoader(spec,parents);
}
