{
  ModuleVersionSelector requested=dependency.getRequested();
  for (  Versioned candidate : sortLatestFirst(versions)) {
    ModuleComponentIdentifier candidateIdentifier=DefaultModuleComponentIdentifier.newId(requested.getGroup(),requested.getName(),candidate.getVersion());
    ComponentSelectionInternal selection=new DefaultComponentSelection(dependency,candidateIdentifier);
    versionSelectionRules.apply(selection,moduleAccess);
switch (selection.getState()) {
case ACCEPTED:
      return candidateIdentifier;
case REJECTED:
    continue;
default :
  break;
}
if (versionMatcher.accept(requested.getVersion(),candidate.getVersion())) {
return candidateIdentifier;
}
}
return null;
}
