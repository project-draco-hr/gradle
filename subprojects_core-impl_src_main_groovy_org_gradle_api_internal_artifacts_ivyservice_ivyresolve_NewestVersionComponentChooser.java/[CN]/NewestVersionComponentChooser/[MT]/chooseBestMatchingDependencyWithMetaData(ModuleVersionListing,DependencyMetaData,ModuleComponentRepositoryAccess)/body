{
  for (  Versioned candidate : sortLatestFirst(versions)) {
    MutableModuleVersionMetaData metaData=resolveComponentMetaData(dependency,candidate,moduleAccess);
    ModuleComponentIdentifier candidateIdentifier=metaData.getComponentId();
    ModuleComponentSelector requestedComponentSelector=DefaultModuleComponentSelector.newSelector(dependency.getRequested().getGroup(),dependency.getRequested().getName(),dependency.getRequested().getVersion());
    VersionSelectionInternal selection=new DefaultVersionSelection(requestedComponentSelector,candidateIdentifier);
    versionSelectionRules.apply(selection);
switch (selection.getState()) {
case ACCEPTED:
      return candidateIdentifier;
case REJECTED:
    continue;
default :
  break;
}
if (versionMatcher.accept(dependency.getRequested().getVersion(),metaData)) {
return candidateIdentifier;
}
}
return null;
}
