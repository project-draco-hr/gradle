{
  EclipseModel eclipseModel=project.getExtensions().getByType(EclipseModel.class);
  EclipseClasspath classpath=eclipseModel.getClasspath();
  classpath.setProjectDependenciesOnly(projectDependenciesOnly);
  List<ClasspathEntry> entries=classpath.resolveDependencies();
  final List<DefaultEclipseExternalDependency> externalDependencies=new LinkedList<DefaultEclipseExternalDependency>();
  final List<DefaultEclipseProjectDependency> projectDependencies=new LinkedList<DefaultEclipseProjectDependency>();
  final List<DefaultEclipseSourceDirectory> sourceDirectories=new LinkedList<DefaultEclipseSourceDirectory>();
  for (  ClasspathEntry entry : entries) {
    if (entry instanceof Library) {
      AbstractLibrary library=(AbstractLibrary)entry;
      final File file=library.getLibrary().getFile();
      final File source=library.getSourcePath() == null ? null : library.getSourcePath().getFile();
      final File javadoc=library.getJavadocPath() == null ? null : library.getJavadocPath().getFile();
      externalDependencies.add(new DefaultEclipseExternalDependency(file,javadoc,source,library.getModuleVersion()));
    }
 else     if (entry instanceof ProjectDependency) {
      final ProjectDependency projectDependency=(ProjectDependency)entry;
      final String path=StringUtils.removeStart(projectDependency.getPath(),"/");
      projectDependencies.add(new DefaultEclipseProjectDependency(path,projectMapping.get(projectDependency.getGradlePath())));
    }
 else     if (entry instanceof SourceFolder) {
      String path=((SourceFolder)entry).getPath();
      sourceDirectories.add(new DefaultEclipseSourceDirectory(path,project.file(path)));
    }
  }
  DefaultEclipseProject eclipseProject=projectMapping.get(project.getPath());
  eclipseProject.setClasspath(externalDependencies);
  eclipseProject.setProjectDependencies(projectDependencies);
  eclipseProject.setSourceDirectories(sourceDirectories);
  List<DefaultEclipseLinkedResource> linkedResources=new LinkedList<DefaultEclipseLinkedResource>();
  for (  Link r : eclipseModel.getProject().getLinkedResources()) {
    linkedResources.add(new DefaultEclipseLinkedResource(r.getName(),r.getType(),r.getLocation(),r.getLocationUri()));
  }
  eclipseProject.setLinkedResources(linkedResources);
  List<DefaultEclipseTask> tasks=new ArrayList<DefaultEclipseTask>();
  for (  Task t : tasksFactory.getTasks(project)) {
    tasks.add(new DefaultEclipseTask(eclipseProject,t.getPath(),t.getName(),t.getDescription()));
  }
  eclipseProject.setTasks(tasks);
  for (  Project childProject : project.getChildProjects().values()) {
    populate(childProject);
  }
}
