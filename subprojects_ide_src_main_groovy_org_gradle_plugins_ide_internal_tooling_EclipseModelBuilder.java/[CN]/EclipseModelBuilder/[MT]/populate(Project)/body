{
  EclipseModel eclipseModel=project.getExtensions().getByType(EclipseModel.class);
  EclipseClasspath eclipseClasspath=eclipseModel.getClasspath();
  eclipseClasspath.setProjectDependenciesOnly(projectDependenciesOnly);
  List<ClasspathEntry> classpathEntries;
  if (eclipseClasspath.getFile() == null) {
    classpathEntries=eclipseClasspath.resolveDependencies();
  }
 else {
    Classpath classpath=new Classpath();
    eclipseClasspath.mergeXmlClasspath(classpath);
    classpathEntries=classpath.getEntries();
  }
  final List<DefaultEclipseExternalDependency> externalDependencies=new LinkedList<DefaultEclipseExternalDependency>();
  final List<DefaultEclipseProjectDependency> projectDependencies=new LinkedList<DefaultEclipseProjectDependency>();
  final List<DefaultEclipseSourceDirectory> sourceDirectories=new LinkedList<DefaultEclipseSourceDirectory>();
  for (  ClasspathEntry entry : classpathEntries) {
    if (entry instanceof Library) {
      AbstractLibrary library=(AbstractLibrary)entry;
      final File file=library.getLibrary().getFile();
      final File source=library.getSourcePath() == null ? null : library.getSourcePath().getFile();
      final File javadoc=library.getJavadocPath() == null ? null : library.getJavadocPath().getFile();
      DefaultEclipseExternalDependency dependency=new DefaultEclipseExternalDependency(file,javadoc,source,library.getModuleVersion(),library.isExported(),createAttributes(library));
      externalDependencies.add(dependency);
    }
 else     if (entry instanceof ProjectDependency) {
      final ProjectDependency projectDependency=(ProjectDependency)entry;
      final String path=StringUtils.removeStart(projectDependency.getPath(),"/");
      DefaultEclipseProject targetProject=projectMapping.get(projectDependency.getGradlePath());
      DefaultEclipseProjectDependency dependency;
      if (targetProject == null) {
        File projectDirectory=compositeProjectMapper.getProjectDirectory(projectDependency.getGradlePath());
        dependency=new DefaultEclipseProjectDependency(path,projectDirectory,projectDependency.isExported(),createAttributes(projectDependency));
      }
 else {
        dependency=new DefaultEclipseProjectDependency(path,targetProject,projectDependency.isExported(),createAttributes(projectDependency));
      }
      projectDependencies.add(dependency);
    }
 else     if (entry instanceof SourceFolder) {
      final SourceFolder sourceFolder=(SourceFolder)entry;
      String path=sourceFolder.getPath();
      List<String> excludes=sourceFolder.getExcludes();
      List<String> includes=sourceFolder.getIncludes();
      sourceDirectories.add(new DefaultEclipseSourceDirectory(path,sourceFolder.getDir(),excludes,includes,createAttributes(sourceFolder)));
    }
  }
  DefaultEclipseProject eclipseProject=projectMapping.get(project.getPath());
  eclipseProject.setClasspath(externalDependencies);
  eclipseProject.setProjectDependencies(projectDependencies);
  eclipseProject.setSourceDirectories(sourceDirectories);
  List<DefaultEclipseLinkedResource> linkedResources=new LinkedList<DefaultEclipseLinkedResource>();
  for (  Link r : eclipseModel.getProject().getLinkedResources()) {
    linkedResources.add(new DefaultEclipseLinkedResource(r.getName(),r.getType(),r.getLocation(),r.getLocationUri()));
  }
  eclipseProject.setLinkedResources(linkedResources);
  List<DefaultEclipseTask> tasks=new ArrayList<DefaultEclipseTask>();
  for (  Task t : tasksFactory.getTasks(project)) {
    tasks.add(new DefaultEclipseTask(eclipseProject,t.getPath(),t.getName(),t.getDescription()));
  }
  eclipseProject.setTasks(tasks);
  List<DefaultEclipseProjectNature> natures=new ArrayList<DefaultEclipseProjectNature>();
  for (  String n : eclipseModel.getProject().getNatures()) {
    natures.add(new DefaultEclipseProjectNature(n));
  }
  eclipseProject.setProjectNatures(natures);
  List<DefaultEclipseBuildCommand> buildCommands=new ArrayList<DefaultEclipseBuildCommand>();
  for (  BuildCommand b : eclipseModel.getProject().getBuildCommands()) {
    buildCommands.add(new DefaultEclipseBuildCommand(b.getName(),b.getArguments()));
  }
  eclipseProject.setBuildCommands(buildCommands);
  EclipseJdt jdt=eclipseModel.getJdt();
  if (jdt != null) {
    eclipseProject.setJavaSourceSettings(new DefaultEclipseJavaSourceSettings().setSourceLanguageLevel(jdt.getSourceCompatibility()).setTargetBytecodeVersion(jdt.getTargetCompatibility()).setJdk(DefaultInstalledJdk.current()));
  }
  for (  Project childProject : project.getChildProjects().values()) {
    populate(childProject);
  }
}
