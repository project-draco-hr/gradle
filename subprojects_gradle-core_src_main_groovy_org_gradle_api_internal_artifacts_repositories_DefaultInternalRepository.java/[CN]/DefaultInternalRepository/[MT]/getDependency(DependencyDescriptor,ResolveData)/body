{
  ModuleDescriptor moduleDescriptor=findProject(dd);
  if (moduleDescriptor == null) {
    return data.getCurrentResolvedModuleRevision();
  }
  IvyContext context=IvyContext.pushNewCopyContext();
  try {
    context.setDependencyDescriptor(dd);
    context.setResolveData(data);
    MetadataArtifactDownloadReport downloadReport=new MetadataArtifactDownloadReport(moduleDescriptor.getMetadataArtifact());
    downloadReport.setDownloadStatus(DownloadStatus.NO);
    downloadReport.setSearched(false);
    return new ResolvedModuleRevision(this,this,moduleDescriptor,downloadReport);
  }
  finally {
    IvyContext.popContext();
  }
}
