{
  ExcludeRule[] excludes=md.getAllExcludeRules();
  for (  ExcludeRule exclude : excludes) {
    writer.startElement("exclude");
    writer.attribute("org",exclude.getId().getModuleId().getOrganisation());
    writer.attribute("module",exclude.getId().getModuleId().getName());
    writer.attribute("artifact",exclude.getId().getName());
    writer.attribute("type",exclude.getId().getType());
    writer.attribute("ext",exclude.getId().getExt());
    String[] ruleConfs=exclude.getConfigurations();
    if (!Arrays.asList(ruleConfs).equals(Arrays.asList(md.getConfigurationsNames()))) {
      writer.attribute("conf",Joiner.on(',').join(ruleConfs));
    }
    writer.attribute("matcher",exclude.getMatcher().getName());
    writer.endElement();
  }
}
