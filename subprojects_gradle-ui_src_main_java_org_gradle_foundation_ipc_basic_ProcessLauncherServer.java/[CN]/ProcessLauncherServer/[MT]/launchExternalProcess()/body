{
  Thread thread=new Thread(new Runnable(){
    public void run(){
      ExecutionInfo executionInfo=new ExecutionInfo();
      protocol.getExecutionInfo(getPort(),executionInfo);
      ExternalProcess externalProcess=new ExternalProcess(executionInfo.workingDirectory,executionInfo.commandLineArguments);
      setExternalProcess(externalProcess);
      Iterator<String> iterator=executionInfo.environmentVariables.keySet().iterator();
      while (iterator.hasNext()) {
        String name=iterator.next();
        String value=executionInfo.environmentVariables.get(name);
        externalProcess.setEnvironmentVariable(name,value);
      }
      try {
        externalProcess.start();
      }
 catch (      Throwable e) {
        logger.error("Starting external process",e);
        protocol.clientExited(-1,e.getMessage());
        setExternalProcess(null);
        return;
      }
      int result=0;
      try {
        result=externalProcess.waitFor();
      }
 catch (      InterruptedException e) {
        logger.error("Waiting for external process",e);
      }
      setExternalProcess(null);
      protocol.clientExited(result,externalProcess.getOutput());
    }
  }
);
  thread.start();
}
