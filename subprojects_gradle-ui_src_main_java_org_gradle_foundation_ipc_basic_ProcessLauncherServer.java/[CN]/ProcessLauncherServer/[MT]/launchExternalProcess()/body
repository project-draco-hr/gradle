{
  Thread thread=new Thread(new Runnable(){
    public void run(){
      ExecutionInfo executionInfo=protocol.getExecutionInfo(getPort());
      ExecHandleBuilder builder=new ExecHandleBuilder();
      builder.execDirectory(executionInfo.getWorkingDirectory());
      builder.commandLine(executionInfo.getCommandLineArguments());
      builder.environment(executionInfo.getEnvironmentVariables());
      ByteArrayOutputStream output=new ByteArrayOutputStream();
      builder.standardOutput(output);
      builder.errorOutput(output);
      ExecHandle execHandle=builder.getExecHandle();
      setExternalProcess(execHandle);
      try {
        execHandle.start();
      }
 catch (      Throwable e) {
        logger.error("Starting external process",e);
        notifyClientExited(-1,e.getMessage());
        setExternalProcess(null);
        return;
      }
      execHandle.waitForFinish();
      setExternalProcess(null);
      executionInfo.processExecutionComplete();
      notifyClientExited(execHandle.getExitCode(),output.toString());
    }
  }
);
  thread.start();
}
