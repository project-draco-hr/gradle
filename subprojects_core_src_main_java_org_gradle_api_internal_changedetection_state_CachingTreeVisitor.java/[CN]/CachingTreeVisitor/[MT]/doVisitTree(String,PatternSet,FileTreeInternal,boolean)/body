{
  final ImmutableList.Builder<FileTreeElement> fileTreeElements=ImmutableList.builder();
  fileTree.visitTreeOrBackingFile(new FileVisitor(){
    @Override public void visitDir(    FileVisitDetails dirDetails){
      fileTreeElements.add(dirDetails);
    }
    @Override public void visitFile(    FileVisitDetails fileDetails){
      fileTreeElements.add(fileDetails);
    }
  }
);
  return new DefaultVisitedTree(absolutePath,patternSet,fileTreeElements.build(),shareable,nextId.incrementAndGet(),null);
}
