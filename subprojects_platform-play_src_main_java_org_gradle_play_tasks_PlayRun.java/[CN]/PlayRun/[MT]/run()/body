{
  ProgressLoggerFactory progressLoggerFactory=getServices().get(ProgressLoggerFactory.class);
  ProgressLogger progressLogger=progressLoggerFactory.newOperation(PlayRun.class).start("Start Play server","Starting Play");
  int httpPort=getHttpPort();
  PlayToolProvider toolProvider=((PlayToolChainInternal)getToolChain()).select(getTargetPlatform());
  FileCollection applicationJars=new SimpleFileCollection(applicationJar,assetsJar);
  applicationJars=applicationJars.plus(toolProvider.getPlayRuntimeDependencies());
  PlayRunSpec spec=new DefaultPlayRunSpec(applicationJars,getProject().getProjectDir(),getForkOptions(),httpPort);
  PlayApplicationRunner manager=toolProvider.newApplicationRunner(getWorkerProcessBuilderFactory(),spec);
  try {
    runnerToken=manager.start();
    progressLogger.completed();
    progressLogger=progressLoggerFactory.newOperation(PlayRun.class).start(String.format("Run Play App at http://localhost:%d/",httpPort),String.format("Running at http://localhost:%d/ (stop with ctrl+d)",httpPort));
    waitForCtrlD();
    runnerToken.stop();
  }
  finally {
    progressLogger.completed();
  }
}
