{
  ProgressLoggerFactory progressLoggerFactory=getServices().get(ProgressLoggerFactory.class);
  String deploymentId=getPath();
  PlayApplicationDeploymentHandle deploymentHandle=getDeploymentRegistry().get(PlayApplicationDeploymentHandle.class,deploymentId);
  if (deploymentHandle == null) {
    ProgressLogger progressLogger=progressLoggerFactory.newOperation(PlayRun.class).start("Start Play server","Starting Play");
    try {
      int httpPort=getHttpPort();
      PlayRunSpec spec=new DefaultPlayRunSpec(runtimeClasspath,changingClasspath,applicationJar,assetsJar,assetsDirs,getProject().getProjectDir(),getForkOptions(),httpPort);
      PlayApplicationRunnerToken runnerToken=playToolProvider.get(PlayApplicationRunner.class).start(spec);
      deploymentHandle=new PlayApplicationDeploymentHandle(deploymentId,runnerToken);
      getDeploymentRegistry().register(deploymentId,deploymentHandle);
    }
  finally {
      progressLogger.completed();
    }
  }
 else {
    deploymentHandle.reload();
  }
  ProgressLogger progressLogger=progressLoggerFactory.newOperation(PlayRun.class).start(String.format("Run Play App at http://localhost:%d/",httpPort),String.format("Running at http://localhost:%d/",httpPort));
  try {
    if (!getProject().getGradle().getStartParameter().isContinuous()) {
      waitForCtrlD();
    }
  }
  finally {
    progressLogger.completed();
  }
}
