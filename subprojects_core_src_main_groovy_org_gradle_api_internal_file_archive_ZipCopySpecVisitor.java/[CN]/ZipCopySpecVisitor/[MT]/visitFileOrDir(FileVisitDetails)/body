{
  try {
    final ZipEntry entry=new ZipEntry(getEntryPath(fileDetails));
    entry.setTime(fileDetails.getLastModified());
    entry.setUnixMode(getEntryMode(fileDetails));
    writeEntry(fileDetails,entry);
    zipOutStr.closeEntry();
  }
 catch (  Exception e) {
    throw new GradleException(String.format("Could not add %s to ZIP '%s'.",fileDetails,zipFile),e);
  }
}
