{
  LazyTaskExecution execution=new LazyTaskExecution();
  execution.inputFilesSnapshotId=dataInput.readLong();
  execution.outputFilesSnapshotId=dataInput.readLong();
  execution.setTaskClass(dataInput.readUTF());
  int outputFiles=dataInput.readInt();
  Set<String> files=new HashSet<String>();
  for (int j=0; j < outputFiles; j++) {
    files.add(dataInput.readUTF());
  }
  execution.setOutputFiles(files);
  int inputProperties=dataInput.readInt();
  if (inputProperties > 0) {
    byte[] serializedMap=new byte[inputProperties];
    dataInput.readFully(serializedMap);
    DefaultSerializer<Map> defaultSerializer=new DefaultSerializer<Map>(classLoader);
    Map<String,Object> map=defaultSerializer.read(new InputStreamBackedDecoder(new ByteArrayInputStream(serializedMap)));
    execution.setInputProperties(map);
  }
 else {
    execution.setInputProperties(new HashMap<String,Object>());
  }
  return execution;
}
