{
  dataOutput.writeLong(execution.inputFilesSnapshotId);
  dataOutput.writeLong(execution.outputFilesSnapshotId);
  dataOutput.writeUTF(execution.getTaskClass());
  dataOutput.writeInt(execution.getOutputFiles().size());
  for (  String outputFile : execution.getOutputFiles()) {
    dataOutput.writeUTF(outputFile);
  }
  if (execution.getInputProperties() == null) {
    dataOutput.writeInt(0);
  }
 else {
    DefaultSerializer<Map> defaultSerializer=new DefaultSerializer<Map>(classLoader);
    ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
    OutputStreamBackedEncoder encoder=new OutputStreamBackedEncoder(outputStream);
    defaultSerializer.write(encoder,execution.getInputProperties());
    encoder.flush();
    byte[] serializedMap=outputStream.toByteArray();
    dataOutput.writeInt(serializedMap.length);
    dataOutput.write(serializedMap);
  }
}
