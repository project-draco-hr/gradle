{
  if (execution.getCommand() instanceof Stop) {
    execution.getDaemonStateCoordinator().requestStop();
  }
 else {
    try {
      execution.proceed();
    }
  finally {
      if (execution.getCommand() instanceof BuildAndStop) {
        execution.getDaemonStateCoordinator().requestStop();
      }
    }
  }
}
