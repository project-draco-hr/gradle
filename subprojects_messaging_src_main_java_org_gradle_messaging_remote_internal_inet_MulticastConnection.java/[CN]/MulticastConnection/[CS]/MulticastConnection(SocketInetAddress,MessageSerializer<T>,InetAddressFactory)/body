{
  this.address=address;
  this.serializer=serializer;
  try {
    socket=new MulticastSocket(address.getPort());
    boolean bound=false;
    SocketException bindFailure=null;
    for (    NetworkInterface networkInterface : addressFactory.findMulticastInterfaces()) {
      try {
        socket.joinGroup(new InetSocketAddress(address.getAddress(),address.getPort()),networkInterface);
        LOGGER.debug("Joined multicast address {} on network interface {}.",address,networkInterface.getDisplayName());
        bound=true;
      }
 catch (      SocketException e) {
        LOGGER.debug("Failed to join multicast address {} on network interface {}.",address,networkInterface.getDisplayName());
        if (bindFailure == null) {
          bindFailure=e;
        }
      }
    }
    if (!bound) {
      throw bindFailure;
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(String.format("Could not create multicast socket for %s",address.getDisplayName()),e);
  }
  localAddress=new SocketInetAddress(socket.getInetAddress(),socket.getLocalPort());
}
