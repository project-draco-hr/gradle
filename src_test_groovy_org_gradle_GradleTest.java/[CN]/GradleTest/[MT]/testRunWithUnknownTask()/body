{
  expectedStartParams.setTaskNames(toList("unknown"));
  expectSettingsBuilt();
  context.checking(new Expectations(){
{
      one(buildBroadcaster).buildStarted(buildMock);
      one(buildBroadcaster).projectsLoaded(buildMock);
      one(buildBroadcaster).projectsEvaluated(buildMock);
      one(buildBroadcaster).buildFinished(with(any(BuildResult.class)));
      one(buildLoaderMock).load(expectedRootProjectDescriptor,buildMock,testGradleProperties);
      one(taskExecuterMock).addTaskExecutionGraphListener(with(notNullValue(TaskExecutionGraphListener.class)));
      one(buildConfigurerMock).process(expectedRootProject);
    }
  }
);
  BuildResult buildResult=gradle.run();
  assertThat(buildResult.getFailure(),notNullValue());
  assertThat(buildResult.getFailure().getClass(),equalTo((Object)UnknownTaskException.class));
}
