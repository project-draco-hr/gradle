{
  if (filePropertiesMap == null) {
    int unnamedPropertyCounter=0;
    SortedMap<String,FileCollection> filePropertiesMap=Maps.newTreeMap();
    for (    T propertySpec : fileProperties) {
      String propertyName=propertySpec.getPropertyName();
      if (propertyName == null) {
        propertyName="$" + (++unnamedPropertyCounter);
      }
      if (filePropertiesMap.containsKey(propertyName)) {
        throw new IllegalArgumentException(String.format("Multiple %s file properties with name '%s'",displayName,propertyName));
      }
      filePropertiesMap.put(propertyName,propertySpec.getPropertyFiles());
    }
    this.filePropertiesMap=filePropertiesMap;
  }
  return filePropertiesMap;
}
