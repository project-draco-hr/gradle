{
  SortedMap<String,FileCollection> filePropertiesMap=Maps.newTreeMap();
  while (fileProperties.hasNext()) {
    TaskFilePropertySpec propertySpec=fileProperties.next();
    String propertyName=propertySpec.getPropertyName();
    if (filePropertiesMap.containsKey(propertyName)) {
      throw new IllegalArgumentException(String.format("Multiple %s file properties with name '%s'",displayName,propertyName));
    }
    filePropertiesMap.put(propertyName,propertySpec.getPropertyFiles());
  }
  return ImmutableSortedMap.copyOf(filePropertiesMap);
}
