{
  SortedMap<String,TaskFilePropertySpec> filePropertiesMap=Maps.newTreeMap();
  while (fileProperties.hasNext()) {
    TaskFilePropertySpec propertySpec=fileProperties.next();
    String propertyName=propertySpec.getPropertyName();
    if (filePropertiesMap.containsKey(propertyName)) {
      throw new IllegalArgumentException(String.format("Multiple %s file properties with name '%s'",displayName,propertyName));
    }
    filePropertiesMap.put(propertyName,new ImmutableFilePropertySpec(propertyName,propertySpec.getPropertyFiles()));
  }
  return ImmutableSortedSet.copyOf(filePropertiesMap.values());
}
