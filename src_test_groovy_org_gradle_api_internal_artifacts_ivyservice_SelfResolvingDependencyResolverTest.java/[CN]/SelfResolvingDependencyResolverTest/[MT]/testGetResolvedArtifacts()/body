{
  context.checking(new Expectations(){
{
      one(delegate).resolve(configuration,ivy,moduleDescriptor);
      will(returnValue(resolvedConfiguration));
      allowing(configuration).getAllDependencies(SelfResolvingDependency.class);
      will(returnValue(toSet()));
    }
  }
);
  final ResolvedArtifact resolvedArtifact=context.mock(ResolvedArtifact.class);
  context.checking(new Expectations(){
{
      one(resolvedConfiguration).getResolvedArtifacts();
      will(returnValue(toSet(resolvedArtifact)));
    }
  }
);
  assertThat(resolver.resolve(this.configuration,ivy,moduleDescriptor).getResolvedArtifacts(),equalTo(toSet(resolvedArtifact)));
}
