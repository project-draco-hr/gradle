{
  context.checking(new Expectations(){
{
      one(serviceRegistryFactoryMock).createFor(with(any(DefaultGradle.class)));
      will(returnValue(gradleServiceRegistryMock));
      allowing(gradleServiceRegistryMock).get(ScriptHandler.class);
      will(returnValue(scriptHandlerMock));
      allowing(gradleServiceRegistryMock).get(ScriptClassLoaderProvider.class);
      will(returnValue(context.mock(ScriptClassLoaderProvider.class)));
      allowing(gradleServiceRegistryMock).get(ProjectRegistry.class);
      will(returnValue(projectRegistry));
      allowing(gradleServiceRegistryMock).get(PluginRegistry.class);
      will(returnValue(pluginRegistry));
      allowing(gradleServiceRegistryMock).get(TaskGraphExecuter.class);
      will(returnValue(taskExecuter));
      allowing(gradleServiceRegistryMock).get(ListenerManager.class);
      will(returnValue(listenerManager));
      allowing(gradleServiceRegistryMock).get(MultiParentClassLoader.class);
      will(returnValue(scriptClassLoaderMock));
      allowing(gradleServiceRegistryMock).get(GradleDistributionLocator.class);
      will(returnValue(gradleDistributionLocatorMock));
      allowing(gradleServiceRegistryMock).get(PluginContainer.class);
      will(returnValue(pluginContainer));
      allowing(gradleServiceRegistryMock).get(FileResolver.class);
      will(returnValue(fileResolverMock));
      allowing(gradleServiceRegistryMock).get(ScriptPluginFactory.class);
      will(returnValue(scriptPluginFactory));
      allowing(listenerManager).createAnonymousBroadcaster(BuildListener.class);
      will(returnValue(buildListenerBroadcast));
      allowing(listenerManager).createAnonymousBroadcaster(ProjectEvaluationListener.class);
      will(returnValue(projectEvaluationListenerBroadcast));
    }
  }
);
  gradle=new DefaultGradle(parent,parameter,serviceRegistryFactoryMock);
}
