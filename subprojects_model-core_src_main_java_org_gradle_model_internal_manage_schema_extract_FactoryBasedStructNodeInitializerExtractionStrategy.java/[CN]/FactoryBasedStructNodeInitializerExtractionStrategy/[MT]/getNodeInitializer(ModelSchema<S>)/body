{
  StructSchema<S> publicSchema=Cast.uncheckedCast(schema);
  InstanceFactory.ImplementationInfo<T> implementationInfo;
  ModelType<S> publicType=schema.getType();
  if (publicSchema instanceof ManagedImplSchema) {
    implementationInfo=instanceFactory.getManagedSubtypeImplementationInfo(publicType);
  }
 else {
    implementationInfo=instanceFactory.getImplementationInfo(publicType);
  }
  Set<ModelType<?>> internalViews=instanceFactory.getInternalViews(publicType);
  ModelType<? extends T> delegateType=implementationInfo.getDelegateType();
  StructBindings<S> bindings=bindingsStore.getBindings(publicSchema,getSchemas(internalViews),getSchema(delegateType));
  return new FactoryBasedStructNodeInitializer<T,S>(bindings,implementationInfo);
}
