{
  while (true) {
    InterHubMessage message=connection.receive();
    if (message == null) {
      return;
    }
    lock.lock();
    try {
      incomingQueue.queue(message);
    }
  finally {
      lock.unlock();
    }
  }
}
