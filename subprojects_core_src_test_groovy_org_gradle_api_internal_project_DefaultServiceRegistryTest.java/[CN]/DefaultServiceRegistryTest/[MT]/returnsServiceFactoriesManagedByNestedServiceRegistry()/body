{
  final ServiceRegistry nested=context.mock(ServiceRegistry.class);
  final Factory<Runnable> factory=context.mock(Factory.class);
  registry.add(nested);
  context.checking(new Expectations(){
{
      one(nested).getFactory(Runnable.class);
      will(returnValue(factory));
    }
  }
);
  assertThat(registry.getFactory(Runnable.class),sameInstance(factory));
}
