{
  JarSnapshot existing=jarSnapshotFeeder.changedJar(jarChangeDetails.getFile());
  if (jarChangeDetails.isAdded()) {
    return DefaultRebuildInfo.NOTHING_TO_REBUILD;
  }
  if (existing == null) {
    return DefaultRebuildInfo.FULL_REBUILD;
  }
  if (jarChangeDetails.isRemoved()) {
    return DefaultRebuildInfo.FULL_REBUILD;
  }
  if (jarChangeDetails.isModified()) {
    JarSnapshot snapshotNoDeps=jarSnapshotFeeder.newSnapshotWithoutDependents(jarArchive);
    final JarDependentsDelta delta=existing.getDependentsDelta(snapshotNoDeps);
    return new DefaultRebuildInfo(delta.getDependentClasses());
  }
  throw new IllegalArgumentException("Unknown input file details provided: " + jarChangeDetails);
}
