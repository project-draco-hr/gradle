{
  final SortedMap<Project,Set> foundTargets=new TreeMap<Project,Set>();
  ProjectAction action=new ProjectAction(){
    public void execute(    Project project){
      foundTargets.put(project,new TreeSet(project.getTasks().values()));
    }
  }
;
  if (recursive) {
    allprojects(action);
  }
 else {
    action.execute(this);
  }
  return foundTargets;
}
