{
  Integer methodId=methods.get(method);
  if (methodId == null) {
    methodId=methods.size();
    methods.put(method,methodId);
    encoder.writeSmallInt(methodId);
    encoder.writeString(method.getDeclaringClass().getName());
    encoder.writeString(method.getName());
    encoder.writeSmallInt(method.getParameterTypes().length);
    for (    Class<?> paramType : method.getParameterTypes()) {
      encoder.writeString(paramType.getName());
    }
  }
 else {
    encoder.writeSmallInt(methodId);
  }
}
