{
  Kernel32 kernel32=INSTANCE;
  Kernel32.StartupInfo startupInfo=new Kernel32.StartupInfo();
  Kernel32.ProcessInfo processInformation=new Kernel32.ProcessInfo();
  if (!kernel32.CreateProcessW(null,new WString(command),null,null,false,DETACHED_PROCESS,null,new WString(dir.getAbsolutePath()),startupInfo,processInformation)) {
    throw new IOException("Could not start process. Errno: " + kernel32.GetLastError());
  }
  kernel32.CloseHandle(processInformation.hProcess);
  kernel32.CloseHandle(processInformation.hThread);
}
