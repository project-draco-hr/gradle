{
  if (testExecutionRequest.getTestMethods().isEmpty()) {
    return Collections.emptyList();
  }
  List<Test> tasksToExecute=new ArrayList<Test>();
  final Collection<InternalTestMethod> testMethods=testExecutionRequest.getTestMethods();
  final Set<Project> allprojects=gradleInternal.getRootProject().getAllprojects();
  for (  Project project : allprojects) {
    final TaskCollection<Test> testTasks=project.getTasks().withType(Test.class);
    for (    Test testTask : testTasks) {
      configureTestMethodFilter(testTask,testMethods);
    }
    tasksToExecute.addAll(testTasks);
  }
  return tasksToExecute;
}
