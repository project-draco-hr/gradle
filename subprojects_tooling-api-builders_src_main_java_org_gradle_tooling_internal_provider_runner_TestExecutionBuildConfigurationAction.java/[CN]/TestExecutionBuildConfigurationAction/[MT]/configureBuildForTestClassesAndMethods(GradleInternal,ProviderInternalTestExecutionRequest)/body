{
  final Collection<String> explicitRequestedTestClassNames=testExecutionRequest.getExplicitRequestedTestClassNames(Collections.<String>emptyList());
  final Collection<InternalTestMethod> testMethods=testExecutionRequest.getTestMethods(Collections.<InternalTestMethod>emptyList());
  if (explicitRequestedTestClassNames.isEmpty() && testMethods.isEmpty()) {
    return Collections.emptyList();
  }
  List<Test> tasksToExecute=new ArrayList<Test>();
  final Set<Project> allprojects=gradle.getRootProject().getAllprojects();
  for (  Project project : allprojects) {
    final Collection<Test> testTasks=project.getTasks().withType(Test.class);
    for (    Test testTask : testTasks) {
      configureTestClassFilter(testTask,explicitRequestedTestClassNames);
      configureTestMethodFilter(testTask,testMethods);
    }
    tasksToExecute.addAll(testTasks);
  }
  return tasksToExecute;
}
