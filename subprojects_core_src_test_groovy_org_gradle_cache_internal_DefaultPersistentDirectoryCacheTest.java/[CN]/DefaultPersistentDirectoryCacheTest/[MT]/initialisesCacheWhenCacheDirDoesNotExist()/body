{
  TestFile emptyDir=tmpDir.getTestDirectory().file("dir");
  emptyDir.assertDoesNotExist();
  context.checking(new Expectations(){
{
      oneOf(action).execute(with(notNullValue(PersistentCache.class)));
    }
  }
);
  DefaultPersistentDirectoryCache cache=new DefaultPersistentDirectoryCache(emptyDir,"<display-name>",validator,properties,mode(LockMode.Shared),action,lockManager);
  cache.open();
  assertThat(loadProperties(emptyDir.file("cache.properties")),equalTo(properties));
}
