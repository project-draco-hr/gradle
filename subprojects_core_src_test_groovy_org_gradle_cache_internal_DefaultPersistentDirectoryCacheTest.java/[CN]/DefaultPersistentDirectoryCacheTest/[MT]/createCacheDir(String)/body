{
  TestFile dir=tmpDir.getTestDirectory();
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.putAll(this.properties);
  properties.putAll(GUtil.map((Object[])extraProps));
  DefaultPersistentDirectoryCache cache=new DefaultPersistentDirectoryCache(dir,"<display-name>",CacheUsage.ON,validator,properties,mode(LockMode.Shared),null,lockManager);
  cache.open();
  dir.file("some-file").touch();
  cache.close();
  return dir;
}
