{
  TestFile dir=tmpDir.getTestDirectory();
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.putAll(this.properties);
  properties.putAll(GUtil.map((Object[])extraProps));
  DefaultPersistentDirectoryCache cache=new DefaultPersistentDirectoryCache(dir,"<display-name>",validator,properties,mode(LockMode.Shared),null,lockManager);
  try {
    cache.open();
    dir.file("some-file").touch();
  }
  finally {
    cache.close();
  }
  return dir;
}
