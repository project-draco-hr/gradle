{
  LOGGER.debug("Resolving {}",configuration);
  IvyAdapter ivyAdapter=ivyFactory.create(configuration);
  DependencyToModuleResolver dependencyResolver=ivyAdapter.getDependencyToModuleResolver();
  dependencyResolver=new ClientModuleResolver(dependencyResolver);
  dependencyResolver=new ProjectDependencyResolver(projectModuleRegistry,dependencyResolver);
  DependencyToModuleVersionIdResolver idResolver=new LazyDependencyToModuleResolver(dependencyResolver,ivyAdapter.getResolveData().getSettings().getVersionMatcher());
  idResolver=new VersionForcingDependencyToModuleResolver(idResolver,configuration.getResolutionStrategy().getDependencyResolveRule());
  ModuleConflictResolver conflictResolver;
  if (configuration.getResolutionStrategy().getConflictResolution() instanceof StrictConflictResolution) {
    conflictResolver=new StrictConflictResolver();
  }
 else {
    conflictResolver=new LatestModuleConflictResolver();
  }
  ModuleConflictResolver actualResolver=new VersionSelectionReasonResolver(conflictResolver);
  DependencyGraphBuilder builder=new DependencyGraphBuilder(moduleDescriptorConverter,resolvedArtifactFactory,idResolver,actualResolver);
  ResolutionResultBuilder resultBuilder=new ResolutionResultBuilder();
  DefaultLenientConfiguration result=builder.resolve(configuration,ivyAdapter.getResolveData(),resultBuilder);
  return new ResolverResults(new DefaultResolvedConfiguration(result),resultBuilder.getResult());
}
