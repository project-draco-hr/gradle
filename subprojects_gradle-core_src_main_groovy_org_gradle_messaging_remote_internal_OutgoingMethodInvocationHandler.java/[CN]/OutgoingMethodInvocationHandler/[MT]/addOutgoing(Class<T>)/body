{
  ProxyDispatchAdapter<?> existing=outgoing.get(type);
  if (existing != null) {
    return type.cast(outgoing.get(type).getSource());
  }
  Dispatch<MethodInvocation> dispatch=new ThreadSafeDispatch<MethodInvocation>(new MethodInvocationMarshallingDispatch(connection.addOutgoingChannel(type.getName())));
  ProxyDispatchAdapter<T> adapter=new ProxyDispatchAdapter<T>(type,dispatch);
  outgoing.put(type,adapter);
  return adapter.getSource();
}
