{
  Clock clock=new Clock();
  Map<String,TestClassResult> results=testResultsProvider.getResults();
  for (  Map.Entry<String,TestClassResult> entry : results.entrySet()) {
    String className=entry.getKey();
    TestClassResult result=entry.getValue();
    File file=new File(testResultsDir,"TEST-" + className + ".xml");
    Writer output=null;
    try {
      output=new OutputStreamWriter(new BufferedOutputStream(new FileOutputStream(file)),"UTF-8");
      saxWriter.write(className,result,output);
    }
 catch (    IOException e) {
      throw new GradleException("Problems writing xml test results to file: " + file,e);
    }
 finally {
      IOUtils.closeQuietly(output);
    }
  }
  LOG.info("Finished generating test xml results (" + clock.getTime() + ")");
}
