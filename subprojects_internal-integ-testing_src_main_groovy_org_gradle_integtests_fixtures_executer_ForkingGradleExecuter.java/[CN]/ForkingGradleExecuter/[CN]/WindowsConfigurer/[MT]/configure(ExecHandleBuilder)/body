{
  String cmd;
  if (getExecutable() != null) {
    cmd=getExecutable().replace('/',File.separatorChar);
  }
 else {
    cmd="gradle";
  }
  builder.executable("cmd");
  List<String> allArgs=builder.getArgs();
  builder.setArgs(Arrays.asList("/c",cmd));
  builder.args(allArgs);
  String gradleHome=getDistribution().getGradleHomeDir().getAbsolutePath();
  Object path=builder.getEnvironment().get("PATH");
  if (path != null) {
    builder.environment("PATH",String.format("%s\\bin;%s",gradleHome,path));
  }
 else {
    path=builder.getEnvironment().get("Path");
    if (path != null) {
      builder.environment("Path",String.format("%s\\bin;%s",gradleHome,path));
    }
  }
  builder.environment("GRADLE_EXIT_CONSOLE","true");
}
