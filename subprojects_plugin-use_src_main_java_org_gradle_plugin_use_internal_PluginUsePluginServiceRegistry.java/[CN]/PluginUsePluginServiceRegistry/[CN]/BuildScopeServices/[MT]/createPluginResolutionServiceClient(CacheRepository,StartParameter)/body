{
  HttpClientHelper http=new HttpClientHelper(new DefaultHttpSettings(new PasswordCredentials()));
  HttpResourceAccessor accessor=new HttpResourceAccessor(http);
  PluginResolutionServiceClient httpClient=startParameter.isOffline() ? new OfflinePluginResolutionServiceClient() : new HttpPluginResolutionServiceClient(accessor);
  PersistentCache cache=cacheRepository.cache(CACHE_NAME).withDisplayName("Plugin Resolution Cache").withLockOptions(mode(FileLockManager.LockMode.None)).open();
  PluginResolutionServiceClient cachingClient=new CachingPluginResolutionServiceClient(httpClient,cache);
  return new DeprecationListeningPluginResolutionServiceClient(cachingClient);
}
