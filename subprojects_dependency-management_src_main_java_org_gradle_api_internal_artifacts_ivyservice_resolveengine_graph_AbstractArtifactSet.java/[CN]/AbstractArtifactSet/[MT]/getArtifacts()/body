{
  Set<ComponentArtifactMetaData> componentArtifacts=resolveComponentArtifacts();
  Set<ResolvedArtifact> resolvedArtifacts=new LinkedHashSet<ResolvedArtifact>(componentArtifacts.size());
  for (  ComponentArtifactMetaData artifact : componentArtifacts) {
    IvyArtifactName artifactName=artifact.getName();
    if (!selector.acceptArtifact(moduleVersionIdentifier.getModule(),artifactName)) {
      continue;
    }
    ResolvedArtifact resolvedArtifact=allResolvedArtifacts.get(artifact.getId());
    if (resolvedArtifact == null) {
      Factory<File> artifactSource=new LazyArtifactSource(artifact,moduleSource,artifactResolver);
      if (artifact instanceof Buildable) {
        resolvedArtifact=new DefaultBuildableArtifact(new DefaultResolvedModuleVersion(moduleVersionIdentifier),artifactName,artifactSource,(Buildable)artifact);
      }
 else {
        resolvedArtifact=new DefaultResolvedArtifact(new DefaultResolvedModuleVersion(moduleVersionIdentifier),artifactName,artifactSource);
      }
      allResolvedArtifacts.put(artifact.getId(),resolvedArtifact);
    }
    resolvedArtifacts.add(resolvedArtifact);
  }
  return resolvedArtifacts;
}
