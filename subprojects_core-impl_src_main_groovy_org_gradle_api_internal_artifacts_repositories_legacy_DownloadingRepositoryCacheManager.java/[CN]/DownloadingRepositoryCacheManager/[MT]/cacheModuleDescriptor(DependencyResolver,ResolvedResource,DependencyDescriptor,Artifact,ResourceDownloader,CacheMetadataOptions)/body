{
  if (!moduleArtifact.isMetadata()) {
    return null;
  }
  ArtifactResourceResolver artifactResourceResolver=new ArtifactResourceResolver(){
    public ResolvedResource resolve(    Artifact artifact){
      return resolvedResource;
    }
  }
;
  ArtifactDownloadReport report=download(moduleArtifact,artifactResourceResolver,downloader,new CacheDownloadOptions().setListener(options.getListener()).setForce(true));
  if (report.getDownloadStatus() == DownloadStatus.FAILED) {
    LOGGER.warn("problem while downloading module descriptor: {}: {} ({} ms)",resolvedResource.getResource(),report.getDownloadDetails(),report.getDownloadTimeMillis());
    return null;
  }
  ModuleDescriptor md=parseModuleDescriptor(resolver,moduleArtifact,options,report.getLocalFile(),resolvedResource.getResource());
  LOGGER.debug("\t{}: parsed downloaded md file for {}; parsed={}" + getName(),moduleArtifact.getModuleRevisionId(),md.getModuleRevisionId());
  MetadataArtifactDownloadReport madr=new MetadataArtifactDownloadReport(md.getMetadataArtifact());
  madr.setSearched(true);
  madr.setDownloadStatus(report.getDownloadStatus());
  madr.setDownloadDetails(report.getDownloadDetails());
  madr.setArtifactOrigin(report.getArtifactOrigin());
  madr.setDownloadTimeMillis(report.getDownloadTimeMillis());
  madr.setOriginalLocalFile(report.getLocalFile());
  madr.setSize(report.getSize());
  return new ResolvedModuleRevision(resolver,resolver,md,madr);
}
