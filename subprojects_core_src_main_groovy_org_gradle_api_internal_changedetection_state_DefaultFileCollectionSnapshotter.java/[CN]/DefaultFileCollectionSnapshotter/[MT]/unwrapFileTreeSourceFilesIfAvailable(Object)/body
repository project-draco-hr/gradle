{
  if (fileTree instanceof FileTreeWithSourceFile) {
    File sourceFile=((FileTreeWithSourceFile)fileTree).getSourceFile();
    if (sourceFile == null && fileTree instanceof FileSystemMirroringFileTree) {
      return new FileTreeAdapter((FileSystemMirroringFileTree)fileTree).getFiles();
    }
    return Collections.singleton(sourceFile);
  }
 else   if (fileTree instanceof FileTreeAdapter) {
    return unwrapFileTreeSourceFilesIfAvailable(((FileTreeAdapter)fileTree).getTree());
  }
 else   if (fileTree instanceof FilteredFileTree) {
    return unwrapFileTreeSourceFilesIfAvailable(((FilteredFileTree)fileTree).getOriginalFileTree());
  }
  return null;
}
