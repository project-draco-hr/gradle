{
  final List<FileVisitDetails> allFileVisitDetails=new LinkedList<FileVisitDetails>();
  DefaultFileCollectionResolveContext context=new DefaultFileCollectionResolveContext();
  context.add(input);
  List<FileTreeInternal> fileTrees=context.resolveAsFileTrees();
  for (  FileTreeInternal fileTree : fileTrees) {
    Set<File> fileTreeBackingFiles=unwrapFileTreeBackingFilesIfAvailable(fileTree);
    if (fileTreeBackingFiles != null) {
      for (      File fileTreeSourceFile : fileTreeBackingFiles) {
        allFileVisitDetails.add(new CachingFileVisitDetails(fileTreeSourceFile));
      }
    }
 else {
      fileTree.visit(new FileVisitor(){
        @Override public void visitDir(        FileVisitDetails dirDetails){
          allFileVisitDetails.add(dirDetails);
        }
        @Override public void visitFile(        FileVisitDetails fileDetails){
          allFileVisitDetails.add(fileDetails);
        }
      }
);
    }
  }
  return allFileVisitDetails;
}
