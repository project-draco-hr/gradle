{
  if (Boolean.getBoolean(DISABLE_OUTPUT)) {
    execution.proceed();
    return;
  }
  AsynchronousLogDispatcher dispatcher=new AsynchronousLogDispatcher(execution.getConnection());
  final LogLevel buildLogLevel=build.getParameters().getLogLevel();
  OutputEventListener listener=new OutputEventListener(){
    public void onOutput(    OutputEvent event){
      if (event.getLogLevel() != null && event.getLogLevel().compareTo(buildLogLevel) >= 0) {
        eventQueue.add(event);
      }
    }
  }
;
  LOGGER.debug(DaemonMessages.ABOUT_TO_START_RELAYING_LOGS);
  loggingOutput.addOutputEventListener(listener);
  try {
    LOGGER.info("{}{}). The daemon log file: {}",DaemonMessages.STARTED_RELAYING_LOGS,diagnostics.getPid(),diagnostics.getDaemonLog());
    dispatcher.start();
    execution.proceed();
  }
  finally {
    try {
      dispatcher.interrupt();
      dispatcher.join();
    }
 catch (    InterruptedException e) {
      dispatcher.interrupt();
    }
    loggingOutput.removeOutputEventListener(listener);
  }
}
