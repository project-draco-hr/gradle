{
  File tempFile=fileStore.getTempFile();
  resourceDownloader.download(artifact,artifactRef.getResource(),tempFile);
  File fileInFileStore=fileStore.move(artifact.getId(),tempFile).getFile();
  if (artifactRef.getResource() instanceof ExternalResource) {
    ExternalResource resource=(ExternalResource)artifactRef.getResource();
    ExternalResourceMetaData metaData=resource.getMetaData();
    artifactUrlCachedResolutionIndex.store(metaData.getLocation(),fileInFileStore,metaData);
  }
  return fileInFileStore;
}
