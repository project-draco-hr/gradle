{
  if (values.isEmpty()) {
    return values;
  }
  TreeMultimap<JavaPlatform,JvmBinarySpec> platformToBinary=TreeMultimap.create(JAVA_PLATFORM_COMPARATOR,JVM_BINARY_SPEC_COMPARATOR);
  for (  BinarySpec binarySpec : values) {
    if (binarySpec instanceof JarBinarySpec) {
      JarBinarySpec jvmSpec=(JarBinarySpec)binarySpec;
      if (jvmSpec.getTargetPlatform().getTargetCompatibility().compareTo(javaPlatform.getTargetCompatibility()) <= 0) {
        VariantsMetaData binaryVariants=DefaultVariantsMetaData.extractFrom(jvmSpec);
        Set<String> commonsDimensions=Sets.intersection(resolveDimensions,binaryVariants.getNonNullDimensions());
        boolean matching=VariantsMetaDataHelper.incompatibleDimensionTypes(variantsMetaData,binaryVariants,commonsDimensions).isEmpty();
        if (matching) {
          for (          String dimension : commonsDimensions) {
            if (!isPlatformDimension(dimension)) {
              String resolveValue=variantsMetaData.getValueAsString(dimension);
              String binaryValue=binaryVariants.getValueAsString(dimension);
              matching=com.google.common.base.Objects.equal(resolveValue,binaryValue);
              if (!matching) {
                break;
              }
            }
          }
        }
        if (matching) {
          platformToBinary.put(jvmSpec.getTargetPlatform(),jvmSpec);
        }
      }
    }
  }
  if (platformToBinary.isEmpty()) {
    return Collections.emptyList();
  }
  JavaPlatform first=platformToBinary.keySet().last();
  return platformToBinary.get(first);
}
