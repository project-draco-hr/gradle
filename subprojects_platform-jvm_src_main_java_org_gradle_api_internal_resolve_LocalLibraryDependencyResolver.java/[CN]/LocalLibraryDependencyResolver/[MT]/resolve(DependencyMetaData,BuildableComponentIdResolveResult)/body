{
  if (dependency.getSelector() instanceof LibraryComponentSelector) {
    LibraryComponentSelector selector=(LibraryComponentSelector)dependency.getSelector();
    final String selectorProjectPath=Strings.nullToEmpty(selector.getProjectPath());
    final String libraryName=Strings.nullToEmpty(selector.getLibraryName());
    final ProjectInternal project=projectLocator.locateProject(selectorProjectPath);
    LibraryResolutionResult resolutionResult=doResolve(project,libraryName);
    LibrarySpec selectedLibrary=resolutionResult.getSelectedLibrary();
    if (selectedLibrary != null) {
      DefaultTaskDependency buildDependencies=new DefaultTaskDependency();
      for (      BinarySpec spec : selectedLibrary.getBinaries().values()) {
        buildDependencies.add(spec.getBuildTask());
      }
      DefaultLibraryLocalComponentMetaData metaData=DefaultLibraryLocalComponentMetaData.newMetaData(selectorProjectPath,selectedLibrary.getName(),buildDependencies);
      result.resolved(metaData.toResolveMetaData());
    }
 else {
      String message=prettyErrorMessage(selector,resolutionResult);
      ModuleVersionResolveException failure=new ModuleVersionResolveException(selector,new LibraryResolveException(message));
      result.failed(failure);
    }
  }
}
