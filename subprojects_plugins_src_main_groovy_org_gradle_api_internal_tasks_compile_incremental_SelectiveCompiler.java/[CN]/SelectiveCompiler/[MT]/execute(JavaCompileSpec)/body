{
  Clock clock=new Clock();
  RecompilationSpec recompilationSpec=recompilationSpecProvider.provideRecompilationSpec(inputs,classDependencyInfo);
  if (recompilationSpec.isFullRebuildNeeded()) {
    LOG.lifecycle("Incremental java compilation not possible - full rebuild is needed due to a change to: {}. Analysis took {}.",recompilationSpec.getFullRebuildCause().getName(),clock.getTime());
    return cleaningCompiler.execute(spec);
  }
  incrementalCompilationInitilizer.initializeCompilation(spec,recompilationSpec.getClassNames());
  if (spec.getSource().isEmpty()) {
    LOG.lifecycle("None of the classes needs to compiled! Analysis took {}. ",clock.getTime());
    return new RecompilationNotNecessary();
  }
  try {
    return cleaningCompiler.getCompiler().execute(spec);
  }
  finally {
    LOG.lifecycle("Incremental compilation of {} classes completed in {}.",recompilationSpec.getClassNames().size(),clock.getTime());
  }
}
