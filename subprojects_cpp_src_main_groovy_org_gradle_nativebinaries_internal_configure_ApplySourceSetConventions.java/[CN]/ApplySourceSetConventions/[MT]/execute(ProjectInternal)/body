{
  ProjectSourceSet projectSourceSet=project.getExtensions().getByType(ProjectSourceSet.class);
  for (  FunctionalSourceSet functionalSourceSet : projectSourceSet) {
    for (    LanguageSourceSet languageSourceSet : functionalSourceSet) {
      if (languageSourceSet.getSource().getSrcDirs().isEmpty()) {
        languageSourceSet.getSource().srcDir(String.format("src/%s/%s",functionalSourceSet.getName(),languageSourceSet.getName()));
      }
    }
    for (    HeaderExportingSourceSet headerSourceSet : functionalSourceSet.withType(HeaderExportingSourceSet.class)) {
      if (headerSourceSet.getExportedHeaders().getSrcDirs().isEmpty()) {
        headerSourceSet.getExportedHeaders().srcDir(String.format("src/%s/headers",functionalSourceSet.getName()));
      }
      headerSourceSet.getImplicitHeaders().setSrcDirs(headerSourceSet.getSource().getSrcDirs());
      headerSourceSet.getImplicitHeaders().include("**/*.h");
    }
  }
}
