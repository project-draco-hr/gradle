{
  for (  ToolChainInternal toolChain : searchOrder) {
    if (toolChain.getAvailability().isAvailable() && toolChain.canTargetPlatform(targetPlatform)) {
      return toolChain;
    }
  }
  TreeFormatter failureMessage=new TreeFormatter();
  failureMessage.node(String.format("No tool chain is available to build for platform '%s'",targetPlatform.getName()));
  failureMessage.startChildren();
  for (  ToolChainInternal toolChain : searchOrder) {
    if (!toolChain.getAvailability().isAvailable()) {
      failureMessage.node(toolChain.getDisplayName());
      failureMessage.startChildren();
      toolChain.getAvailability().explain(failureMessage);
      failureMessage.endChildren();
    }
 else {
      failureMessage.node(String.format("%s cannot build for platform '%s'.",toolChain.getDisplayName(),targetPlatform.getName()));
    }
  }
  if (searchOrder.isEmpty()) {
    failureMessage.node("No tool chain plugin applied.");
  }
  failureMessage.endChildren();
  return new UnavailableToolChain(failureMessage.toString());
}
