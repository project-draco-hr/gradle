{
  OptionalAttributeXmlWriter xmlWriter=new OptionalAttributeXmlWriter(writer,"  ",IVY_FILE_ENCODING);
  xmlWriter.startElement("ivy-module").attribute("version","2.0");
  if (usesClassifier()) {
    xmlWriter.attribute("xmlns:m","http://ant.apache.org/ivy/maven");
  }
  xmlWriter.startElement("info").attribute("organisation",projectIdentity.getOrganisation()).attribute("module",projectIdentity.getModule()).attribute("branch",branch).attribute("revision",projectIdentity.getRevision()).attribute("status",status).attribute("publication",ivyDateFormat.format(new Date()));
  if (extraInfo != null) {
    for (    Map.Entry<NamespaceId,String> entry : extraInfo.entrySet()) {
      if (entry.getKey() != null) {
        try {
          xmlWriter.startElement(String.format("ns:%s",entry.getKey().getName())).attribute("xmlns:ns",entry.getKey().getNamespace()).characters(entry.getValue()).endElement();
        }
 catch (        Exception e) {
          throw new InvalidUserCodeException(String.format("Failed to add extra info element '%s'",entry.getKey().getName()),e);
        }
      }
    }
  }
  xmlWriter.endElement();
  writeConfigurations(xmlWriter);
  writePublications(xmlWriter);
  writeDependencies(xmlWriter);
  xmlWriter.endElement();
}
