{
  expectOptionsBuilt();
  context.checking(new Expectations(){
{
      final TestResult result=context.mock(TestResult.class);
      allowing(result).getResultType();
      will(returnValue(TestResult.ResultType.FAILURE));
      ignoring(result);
      final TestDescriptor testDescriptor=context.mock(TestDescriptor.class);
      allowing(testDescriptor).getName();
      will(returnValue("test"));
      allowing(testDescriptor).getParent();
      will(returnValue(null));
      ignoring(testDescriptor);
      one(testExecuterMock).execute(with(sameInstance(test)),with(notNullValue(TestListenerAdapter.class)));
      will(new Action(){
        public void describeTo(        Description description){
          description.appendText("fail tests");
        }
        public Object invoke(        Invocation invocation) throws Throwable {
          TestTest.this.test.getTestListenerBroadcaster().getSource().beforeSuite(testDescriptor);
          TestTest.this.test.getTestListenerBroadcaster().getSource().afterSuite(testDescriptor,result);
          return null;
        }
      }
);
      one(testFrameworkMock).report();
    }
  }
);
}
