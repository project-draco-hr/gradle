{
  stopping=true;
  if (consumers.isEmpty()) {
    maybeStop();
    return;
  }
  LOGGER.debug("Waiting for consumers to stop: {}",consumers);
  context.stopLater();
  for (  Object consumerId : consumers) {
    context.dispatchOutgoing(new ProducerStopped(id,consumerId));
  }
}
