{
  if (message instanceof RoutableMessage) {
    RoutableMessage routableMessage=(RoutableMessage)message;
    if (!consumers.contains(routableMessage.getDestination())) {
      throw new IllegalStateException(String.format("Message to unexpected destination dispatched: %s",message));
    }
    context.dispatchOutgoing(message);
  }
 else {
    throw new IllegalArgumentException(String.format("Unexpected outgoing message dispatched: %s",message));
  }
}
