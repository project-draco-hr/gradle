{
  final File file=tmpDir.getTestDirectory().file("report.txt");
  context.checking(new Expectations(){
{
      Sequence sequence=context.sequence("sequence");
      one(renderer).setOutputFile(file);
      inSequence(sequence);
      one(renderer).startProject(project);
      inSequence(sequence);
      one(generator).run();
      inSequence(sequence);
      one(renderer).completeProject(project);
      inSequence(sequence);
      one(renderer).complete();
      inSequence(sequence);
    }
  }
);
  task.setOutputFile(file);
  task.generate();
}
