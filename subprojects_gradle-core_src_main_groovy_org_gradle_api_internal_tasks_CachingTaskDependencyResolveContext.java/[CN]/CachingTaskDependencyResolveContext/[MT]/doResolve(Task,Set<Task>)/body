{
  while (!queue.isEmpty()) {
    Object dependency=queue.remove(0);
    if (dependency instanceof Task) {
      tasks.add((Task)dependency);
    }
 else     if (dependency instanceof TaskDependencyInternal) {
      TaskDependencyInternal taskDependency=(TaskDependencyInternal)dependency;
      taskDependency.resolve(this);
    }
 else     if (dependency instanceof TaskDependency) {
      TaskDependency taskDependency=(TaskDependency)dependency;
      tasks.addAll(taskDependency.getDependencies(task));
    }
 else     if (dependency instanceof Buildable) {
      Buildable buildable=(Buildable)dependency;
      queue.add(0,buildable.getBuildDependencies());
    }
 else {
      throw new IllegalArgumentException(String.format("Cannot resolve object of unknown type %s to a Task.",dependency.getClass().getSimpleName()));
    }
  }
}
