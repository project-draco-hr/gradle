{
  final ConsoleBackedProgressRenderer consoleChain=new ConsoleBackedProgressRenderer(new ProgressLogEventGenerator(new StyledTextOutputBackedRenderer(console.getMainArea()),true),console,new DefaultStatusBarFormatter(consoleMetaData),new TrueTimeProvider());
synchronized (lock) {
    this.console=consoleChain;
    if (stdout && stderr) {
      formatters.add(consoleChain);
      removeStandardOutputListener();
      removeStandardErrorListener();
    }
 else     if (stdout) {
      formatters.add(onNonError(consoleChain));
      removeStandardOutputListener();
    }
 else {
      formatters.add(onError(consoleChain));
      removeStandardErrorListener();
    }
    consoleChain.onOutput(new LogLevelChangeEvent(logLevel));
  }
  return this;
}
