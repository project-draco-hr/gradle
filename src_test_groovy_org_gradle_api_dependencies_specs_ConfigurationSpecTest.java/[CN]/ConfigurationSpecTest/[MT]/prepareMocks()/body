{
  final ConfigurationHolder configurationHolder=context.mock(ConfigurationHolder.class);
  final Configuration configurationMock3=createConfigurationMock(TEST_CONF3);
  final Configuration configurationMock1=createConfigurationMock(TEST_CONF1,configurationMock3);
  final Configuration configurationMock2=createConfigurationMock(TEST_CONF2);
  context.checking(new Expectations(){
{
      allowing(configurationHolder).getConfigurations();
      will(returnValue(WrapUtil.toSet(configurationMock1,configurationMock2)));
    }
  }
);
  return configurationHolder;
}
