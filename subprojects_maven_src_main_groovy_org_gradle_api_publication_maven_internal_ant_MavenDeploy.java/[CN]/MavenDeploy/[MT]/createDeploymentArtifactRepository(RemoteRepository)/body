{
  if (repository.getId().equals(repository.getUrl())) {
    repository.setId("remote");
  }
  ArtifactRepositoryLayout repositoryLayout=(ArtifactRepositoryLayout)lookup(ArtifactRepositoryLayout.ROLE,repository.getLayout());
  ArtifactRepositoryFactory repositoryFactory=null;
  try {
    repositoryFactory=getArtifactRepositoryFactory(repository);
    return repositoryFactory.createDeploymentArtifactRepository(repository.getId(),repository.getUrl(),repositoryLayout,uniqueVersion);
  }
  finally {
    releaseArtifactRepositoryFactory(repositoryFactory);
  }
}
