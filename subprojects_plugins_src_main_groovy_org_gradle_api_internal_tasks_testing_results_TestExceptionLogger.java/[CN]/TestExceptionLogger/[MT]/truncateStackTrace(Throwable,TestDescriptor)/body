{
  StackTraceElement[] stackTrace=exception.getStackTrace();
  int cutoff=-1;
  for (int i=0; i < stackTrace.length; i++) {
    StackTraceElement element=stackTrace[i];
    if (Objects.equal(element.getClassName(),descriptor.getClassName()) && Objects.equal(element.getMethodName(),descriptor.getName())) {
      cutoff=i;
      break;
    }
  }
  if (cutoff > -1) {
    List<StackTraceElement> elements=Arrays.asList(stackTrace);
    elements=elements.subList(0,cutoff + 1);
    exception.setStackTrace(elements.toArray(new StackTraceElement[elements.size()]));
  }
  if (exception.getCause() != null) {
    truncateStackTrace(exception.getCause(),descriptor);
  }
}
