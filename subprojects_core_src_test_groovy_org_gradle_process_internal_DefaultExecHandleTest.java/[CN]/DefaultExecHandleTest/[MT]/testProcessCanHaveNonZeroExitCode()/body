{
  DefaultExecHandle execHandle=new DefaultExecHandle("display-name",tmpDir.getDir(),Jvm.current().getJavaExecutable().getAbsolutePath(),Arrays.asList("-cp",System.getProperty("java.class.path"),BrokenApp.class.getName()),System.getenv(),new StreamsForwarder(),Collections.<ExecHandleListener>emptyList());
  ExecResult result=execHandle.start().waitForFinish();
  assertEquals(ExecHandleState.FAILED,execHandle.getState());
  assertEquals(72,result.getExitValue());
  try {
    result.assertNormalExitValue();
    fail();
  }
 catch (  ExecException e) {
    assertEquals("Display-name finished with (non-zero) exit value 72.",e.getMessage());
  }
}
