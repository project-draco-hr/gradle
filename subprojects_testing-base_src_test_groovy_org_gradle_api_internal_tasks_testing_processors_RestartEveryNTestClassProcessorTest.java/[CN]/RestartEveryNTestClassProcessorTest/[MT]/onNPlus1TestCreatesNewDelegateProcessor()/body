{
  context.checking(new Expectations(){
{
      oneOf(factory).create();
      will(returnValue(delegate));
      oneOf(delegate).startProcessing(resultProcessor);
      oneOf(delegate).processTestClass(test1);
      oneOf(delegate).processTestClass(test2);
      oneOf(delegate).stop();
      TestClassProcessor delegate2=context.mock(TestClassProcessor.class,"delegate2");
      oneOf(factory).create();
      will(returnValue(delegate2));
      oneOf(delegate2).startProcessing(resultProcessor);
      oneOf(delegate2).processTestClass(test3);
    }
  }
);
  processor.startProcessing(resultProcessor);
  processor.processTestClass(test1);
  processor.processTestClass(test2);
  processor.processTestClass(test3);
}
