{
  final FileSet testClassFileSet=new FileSet(testClassDirectory,null);
  if (!scanForTestClasses) {
    if (includePatterns.isEmpty()) {
      includePatterns.add("**/*Tests.class");
      includePatterns.add("**/*Test.class");
    }
    if (excludePatterns.isEmpty()) {
      excludePatterns.add("**/Abstract*.class");
    }
  }
  testClassFileSet.include(includePatterns);
  testClassFileSet.exclude(excludePatterns);
  testClassFileSet.visit(new FileVisitor(){
    public void visitDir(    FileVisitDetails dirDetails){
    }
    public void visitFile(    FileVisitDetails fileDetails){
      File file=fileDetails.getFile();
      if (file.getAbsolutePath().endsWith(".class")) {
        final String fileResourceName=fileDetails.getRelativePath().getPathString();
        if (scanForTestClasses) {
          testFrameworkInstance.processPossibleTestClass(file);
        }
 else {
          testFrameworkInstance.manualTestClass(fileResourceName);
        }
      }
    }
  }
);
}
