{
  IoActions.withResource(openJarFile(file),new ErroringAction<ZipInputStream>(){
    @Override protected void doExecute(    ZipInputStream inputStream) throws Exception {
      ZipEntry zipEntry=inputStream.getNextEntry();
      while (zipEntry != null) {
        String name=zipEntry.getName();
        if (name.startsWith(SERVICES_DIR_PREFIX) || seenPaths.add(name)) {
          processEntry(outputStream,inputStream,zipEntry,buffer,services);
        }
        zipEntry=inputStream.getNextEntry();
      }
    }
  }
);
}
