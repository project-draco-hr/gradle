{
  try {
    ModelType<? extends T> type=readType(ruleDefinition,context);
    if (context.hasProblems()) {
      return null;
    }
    ModelSchema<? extends T> schema=schemaStore.getSchema(type);
    TypeBuilderInternal<T> builder=typeBuilderFactory.create(schema);
    ruleDefinition.getRuleInvoker().invoke(builder);
    ModelType<? extends U> implModelType=determineImplementationType(type,builder);
    return createRegistration(ruleDefinition,type,implModelType,builder);
  }
 catch (  InvalidModelException e) {
    throw invalidModelRule(ruleDefinition,e);
  }
}
