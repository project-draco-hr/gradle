{
  testFile("settings.gradle").write("include('another')");
  testFile("gradle.properties").writelns("prop=value2","otherProp=value");
  TestFile buildFile=testFile("subdirectory/build.gradle");
  buildFile.writelns("createTask('do-stuff') {","assertThat(prop, equalTo('value'))","assertTrue(!project.hasProperty('otherProp'))","}");
  testFile("subdirectory/gradle.properties").write("prop=value");
  usingBuildFile(buildFile).withSearchUpwards().runTasks("do-stuff");
}
