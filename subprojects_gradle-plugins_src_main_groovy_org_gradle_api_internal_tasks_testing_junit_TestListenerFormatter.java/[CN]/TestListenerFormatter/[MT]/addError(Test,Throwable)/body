{
  TestDescriptorInternal testInternal;
  boolean synthesiseFailedTest;
synchronized (lock) {
    if (test == null) {
      testInternal=new DefaultTestDescriptor(idGenerator.generateId(),currentSuite.getClassName(),"initializationError");
      synthesiseFailedTest=true;
    }
 else {
      testInternal=executing.get(test);
      synthesiseFailedTest=false;
    }
  }
  if (synthesiseFailedTest) {
    resultProcessor.started(testInternal,new TestStartEvent(timeProvider.getCurrentTime()));
    resultProcessor.completed(testInternal.getId(),new TestCompleteEvent(timeProvider.getCurrentTime(),null,throwable));
  }
 else {
    resultProcessor.addFailure(testInternal.getId(),throwable);
  }
}
