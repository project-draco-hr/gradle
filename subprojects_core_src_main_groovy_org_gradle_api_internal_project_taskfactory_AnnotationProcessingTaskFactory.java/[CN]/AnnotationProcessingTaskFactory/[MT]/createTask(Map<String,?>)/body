{
  TaskInternal task=taskFactory.createTask(args);
  Class<? extends Task> type=task.getClass();
  List<Action<Task>> actions=actionsForType.get(type);
  if (actions == null) {
    actions=createActionsForType(type);
    actionsForType.put(type,actions);
  }
  for (  Action<Task> action : actions) {
    task.doFirst(action);
    if (action instanceof Validator) {
      Validator validator=(Validator)action;
      validator.addInputsAndOutputs(task);
    }
    if (action instanceof IncrementalTaskAction) {
      task.setIncrementalTask(true);
    }
  }
  return task;
}
