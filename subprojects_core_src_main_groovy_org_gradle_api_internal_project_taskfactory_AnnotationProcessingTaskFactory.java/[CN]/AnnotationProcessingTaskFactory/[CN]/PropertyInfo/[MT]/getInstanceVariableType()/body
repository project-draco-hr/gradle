{
  Class<?> currentType=type;
  while (!currentType.equals(Object.class)) {
    try {
      return currentType.getDeclaredField(propertyName).getType();
    }
 catch (    NoSuchFieldException e) {
      currentType=currentType.getSuperclass();
    }
  }
  return null;
}
