{
  return ImmutableSetMultimap.<ModelActionRole,ModelAction>builder().put(ModelActionRole.Discover,DirectNodeInputUsingModelAction.of(subject,descriptor,Arrays.<ModelReference<?>>asList(ModelReference.of(ModelSchemaStore.class),ModelReference.of(ManagedProxyFactory.class),ModelReference.of(ServiceRegistry.class)),new BiAction<MutableModelNode,List<ModelView<?>>>(){
    @Override public void execute(    MutableModelNode mutableModelNode,    List<ModelView<?>> modelViews){
      ModelSchemaStore schemaStore=ModelViews.getInstance(modelViews.get(0),ModelSchemaStore.class);
      ManagedProxyFactory proxyFactory=ModelViews.getInstance(modelViews.get(1),ManagedProxyFactory.class);
      ServiceRegistry serviceRegistry=ModelViews.getInstance(modelViews.get(2),ServiceRegistry.class);
      mutableModelNode.addProjection(new ManagedModelProjection<T>(schema,null,schemaStore,proxyFactory,serviceRegistry));
    }
  }
)).put(ModelActionRole.Create,DirectNodeInputUsingModelAction.of(subject,descriptor,Arrays.<ModelReference<?>>asList(ModelReference.of(NodeInitializerRegistry.class),ModelReference.of(ModelSchemaStore.class),ModelReference.of(ManagedProxyFactory.class),ModelReference.of(ServiceRegistry.class)),new BiAction<MutableModelNode,List<ModelView<?>>>(){
    @Override public void execute(    MutableModelNode modelNode,    List<ModelView<?>> modelViews){
      NodeInitializerRegistry nodeInitializerRegistry=ModelViews.getInstance(modelViews,0,NodeInitializerRegistry.class);
      ModelSchemaStore schemaStore=ModelViews.getInstance(modelViews,1,ModelSchemaStore.class);
      ManagedProxyFactory proxyFactory=ModelViews.getInstance(modelViews,2,ManagedProxyFactory.class);
      ServiceRegistry serviceRegistry=ModelViews.getInstance(modelViews,3,ServiceRegistry.class);
      addPropertyLinks(modelNode,nodeInitializerRegistry,schemaStore,proxyFactory,serviceRegistry,schema.getProperties());
    }
  }
)).build();
}
