{
  verifyConfigFailurePolicy();
  verifyPreserveOrder();
  verifyGroupByInstances();
  DeprecationLogger.whileDisabled(new Runnable(){
    @Override public void run(){
      options.setTestResources(testTask.getTestSrcDirs());
    }
  }
);
  List<File> suiteFiles=options.getSuites(testTask.getTemporaryDir());
  TestNGSpec spec=DeprecationLogger.whileDisabled(new Factory<TestNGSpec>(){
    @Override public TestNGSpec create(){
      return new TestNGSpec(options,filter);
    }
  }
);
  return new TestClassProcessorFactoryImpl(this.options.getOutputDirectory(),spec,suiteFiles);
}
