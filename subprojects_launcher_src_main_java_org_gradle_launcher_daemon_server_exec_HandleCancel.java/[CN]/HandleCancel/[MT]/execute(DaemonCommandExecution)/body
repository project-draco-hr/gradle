{
  execution.getConnection().onCancel(new Runnable(){
    public void run(){
      LOGGER.info("HandleCancel processing {}",execution.getCommand());
      execution.getDaemonStateControl().cancelBuild();
    }
  }
);
  try {
    try {
      execution.proceed();
    }
  finally {
      execution.getConnection().onCancel(null);
    }
  }
 catch (  Exception e) {
    throw UncheckedException.throwAsUncheckedException(e);
  }
}
