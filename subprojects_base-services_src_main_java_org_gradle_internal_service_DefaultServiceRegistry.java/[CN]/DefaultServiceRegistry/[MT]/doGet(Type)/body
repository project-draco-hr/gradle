{
synchronized (lock) {
    if (closed) {
      throw new IllegalStateException(String.format("Cannot locate service of type %s, as %s has been closed.",format(serviceType),displayName));
    }
    DefaultLookupContext context=new DefaultLookupContext();
    ServiceProvider provider=context.find(serviceType,allServices);
    if (provider != null) {
      return provider.get();
    }
    throw new UnknownServiceException(serviceType,String.format("No service of type %s available in %s.",format(serviceType),displayName));
  }
}
