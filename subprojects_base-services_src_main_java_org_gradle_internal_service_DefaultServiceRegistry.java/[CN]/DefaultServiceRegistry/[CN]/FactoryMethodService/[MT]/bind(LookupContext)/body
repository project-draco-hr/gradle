{
  paramProviders=new ServiceProvider[method.getGenericParameterTypes().length];
  for (int i=0; i < method.getGenericParameterTypes().length; i++) {
    Type paramType=method.getGenericParameterTypes()[i];
    try {
      if (paramType.equals(ServiceRegistry.class)) {
        paramProviders[i]=getThisAsProvider();
      }
 else {
        ServiceProvider paramProvider=context.find(paramType,allServices);
        if (paramProvider == null) {
          throw new ServiceCreationException(String.format("Cannot create service of type %s using %s.%s() as required service of type %s is not available.",format(method.getGenericReturnType()),method.getDeclaringClass().getSimpleName(),method.getName(),format(paramType)));
        }
        paramProviders[i]=paramProvider;
        paramProvider.requiredBy(this);
      }
    }
 catch (    ServiceValidationException e) {
      throw new ServiceCreationException(String.format("Cannot create service of type %s using %s.%s() as there is a problem with required service of type %s.",format(method.getGenericReturnType()),method.getDeclaringClass().getSimpleName(),method.getName(),format(paramType)),e);
    }
  }
}
