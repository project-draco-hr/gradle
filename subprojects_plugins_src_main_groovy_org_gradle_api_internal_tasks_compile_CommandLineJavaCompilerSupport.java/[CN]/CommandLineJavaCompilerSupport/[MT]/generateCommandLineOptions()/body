{
  List<String> options=new ArrayList<String>();
  if (sourceCompatibility != null && !JavaVersion.current().equals(JavaVersion.toVersion(sourceCompatibility))) {
    options.add("-source");
    options.add(sourceCompatibility);
  }
  if (targetCompatibility != null && !JavaVersion.current().equals(JavaVersion.toVersion(targetCompatibility))) {
    options.add("-target");
    options.add(targetCompatibility);
  }
  if (destinationDir != null) {
    options.add("-d");
    options.add(destinationDir.getPath());
  }
  if (compileOptions.isVerbose()) {
    options.add("-verbose");
  }
  if (compileOptions.isDeprecation()) {
    options.add("-deprecation");
  }
  if (!compileOptions.isWarnings()) {
    options.add("-nowarn");
  }
  if (!compileOptions.isDebug()) {
    options.add("-g:none");
  }
  if (compileOptions.getEncoding() != null) {
    options.add("-encoding");
    options.add(compileOptions.getEncoding());
  }
  if (compileOptions.getBootClasspath() != null) {
    options.add("-bootclasspath");
    options.add(compileOptions.getBootClasspath());
  }
  if (compileOptions.getExtensionDirs() != null) {
    options.add("-extdirs");
    options.add(compileOptions.getExtensionDirs());
  }
  if (classpath != null && classpath.iterator().hasNext()) {
    options.add("-classpath");
    options.add(toFileCollection(classpath).getAsPath());
  }
  if (compileOptions.getCompilerArgs() != null) {
    options.addAll(compileOptions.getCompilerArgs());
  }
  if (LOGGER.isInfoEnabled()) {
    LOGGER.info("Invoking Java compiler with options '{}'",Joiner.on(' ').join(options));
  }
  return options;
}
