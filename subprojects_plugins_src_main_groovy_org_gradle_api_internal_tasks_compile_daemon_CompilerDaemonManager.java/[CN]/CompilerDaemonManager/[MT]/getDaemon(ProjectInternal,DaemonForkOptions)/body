{
synchronized (lock) {
    if (clients.isEmpty()) {
      registerStopOnBuildFinished(project);
    }
    for (    CompilerDaemonClient client : clients) {
      if (client.isCompatibleWith(forkOptions) && client.isIdle()) {
        client.setIdle(false);
        return client;
      }
    }
  }
  CompilerDaemonClient client=compilerDaemonStarter.startDaemon(project,forkOptions).setIdle(false);
synchronized (lock) {
    clients.add(client);
  }
  return client;
}
