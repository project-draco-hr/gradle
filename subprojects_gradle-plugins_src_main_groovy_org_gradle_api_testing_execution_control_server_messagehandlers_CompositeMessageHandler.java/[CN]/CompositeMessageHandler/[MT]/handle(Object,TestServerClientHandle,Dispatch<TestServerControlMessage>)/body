{
  Class<?> messageClass=controlMessage.getClass();
  TestControlMessageHandler handler=handlers.get(messageClass);
  if (handler != null) {
    handler.handle(controlMessage,client,clientConnection);
  }
 else {
    QueueingPipeline pipeline=pipelineDispatcher.getPipeline();
    LOGGER.error("received unknown message of type {} on pipeline ",messageClass,pipeline.getName());
    clientConnection.dispatch(new StopForkActionMessage(pipeline.getId()));
  }
}
