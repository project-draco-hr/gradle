{
  return new TaskDependency(){
    public Set<? extends Task> getDependencies(    Task task){
      DefaultTaskDependency taskDependency=new DefaultTaskDependency();
      if (useDependedOn) {
        addTaskDependenciesFromProjectsIDependOn(taskName,taskDependency);
      }
 else {
        Project thisProject=task.getProject();
        addTaskDependenciesFromProjectsDependingOnMe(thisProject,taskName,taskDependency);
      }
      return taskDependency.getDependencies(task);
    }
  }
;
}
