{
  DefaultScriptHandlerFactory factory=new DefaultScriptHandlerFactory(getFactory(RepositoryHandler.class),get(ConfigurationContainerFactory.class),get(DependencyMetaDataProvider.class),get(DependencyFactory.class));
  ClassLoader parentClassLoader;
  if (project.getParent() != null) {
    parentClassLoader=project.getParent().getBuildscript().getClassLoader();
  }
 else {
    parentClassLoader=project.getGradle().getScriptClassLoader();
  }
  return factory.create(project.getBuildScriptSource(),parentClassLoader,project);
}
