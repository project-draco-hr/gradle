{
  Configuration selectedConfiguration=null;
  ConfigurationContainer dependencyConfigurations=getDependencyProject().getConfigurations();
  String declaredConfiguration=getTargetConfiguration().orNull();
  if (declaredConfiguration == null && clientAttributes != null && !clientAttributes.isEmpty()) {
    for (    Configuration dependencyConfiguration : dependencyConfigurations) {
      if (dependencyConfiguration.hasAttributes()) {
        Map<String,String> attributes=dependencyConfiguration.getAttributes();
        if (attributes.entrySet().containsAll(clientAttributes.entrySet())) {
          selectedConfiguration=dependencyConfiguration;
          break;
        }
      }
    }
  }
  if (selectedConfiguration == null) {
    selectedConfiguration=dependencyConfigurations.getByName(GUtil.elvis(declaredConfiguration,Dependency.DEFAULT_CONFIGURATION));
  }
  return selectedConfiguration;
}
