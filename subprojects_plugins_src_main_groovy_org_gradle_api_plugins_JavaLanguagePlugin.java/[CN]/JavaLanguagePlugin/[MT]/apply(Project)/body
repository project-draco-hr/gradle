{
  final JvmLanguagePlugin jvmLanguagePlugin=target.getPlugins().apply(JvmLanguagePlugin.class);
  BinaryContainer binaryContainer=target.getExtensions().getByType(BinaryContainer.class);
  binaryContainer.getJvm().all(new Action<ClassDirectoryBinary>(){
    public void execute(    final ClassDirectoryBinary binary){
      binary.getSource().withType(JavaSourceSet.class).all(new Action<JavaSourceSet>(){
        public void execute(        JavaSourceSet javaSourceSet){
          JavaCompile compileTask=(JavaCompile)binary.getCompileTask();
          if (compileTask == null) {
            compileTask=target.getTasks().add(binary.getTaskName("compile","java"),JavaCompile.class);
            jvmLanguagePlugin.configureCompileTask(compileTask,javaSourceSet,binary);
            binary.setCompileTask(compileTask);
            binary.getClassesTask().dependsOn(compileTask);
          }
        }
      }
);
    }
  }
);
}
