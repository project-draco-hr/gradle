{
  if (serviceType instanceof ParameterizedType) {
    ParameterizedType parameterizedType=(ParameterizedType)serviceType;
    if (parameterizedType.getRawType().equals(Factory.class)) {
      Type typeArg=parameterizedType.getActualTypeArguments()[0];
      if (typeArg instanceof Class) {
        return getFactory((Class)typeArg);
      }
      if (typeArg instanceof WildcardType) {
        WildcardType wildcardType=(WildcardType)typeArg;
        if (wildcardType.getLowerBounds().length == 1 && wildcardType.getUpperBounds().length == 1) {
          if (wildcardType.getLowerBounds()[0] instanceof Class && wildcardType.getUpperBounds()[0].equals(Object.class)) {
            return getFactory((Class<Object>)wildcardType.getLowerBounds()[0]);
          }
        }
        if (wildcardType.getLowerBounds().length == 0 && wildcardType.getUpperBounds().length == 1) {
          if (wildcardType.getUpperBounds()[0] instanceof Class) {
            return getFactory((Class<Object>)wildcardType.getUpperBounds()[0]);
          }
        }
      }
    }
  }
  if (serviceType instanceof Class) {
    return get((Class)serviceType);
  }
  throw new UnsupportedOperationException(String.format("Cannot locate service of type %s yet.",serviceType));
}
