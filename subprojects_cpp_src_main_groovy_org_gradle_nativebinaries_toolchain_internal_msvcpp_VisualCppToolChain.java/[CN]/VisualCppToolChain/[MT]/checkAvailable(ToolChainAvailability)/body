{
  if (!operatingSystem.isWindows()) {
    availability.unavailable("Not available on this operating system.");
    return;
  }
  if (installDir != null) {
    VisualStudioInstall install=new VisualStudioInstall(installDir);
    availability.mustExist("Visual Studio installation",install.getVisualStudioDir());
    availability.mustExist("Windows SDK",install.getWindowsSdkDir());
  }
 else {
    for (    ToolType key : ToolType.values()) {
      availability.mustExist(key.getToolName(),tools.locate(key));
    }
  }
}
