{
  if (!operatingSystem.isWindows()) {
    availability.unavailable("Not available on this operating system.");
    return;
  }
  if (installDir != null) {
    availability.mustExist("Visual Studio installation",visualStudioLocator.locateVisualStudio(installDir));
    availability.mustExist("Windows SDK",visualStudioLocator.locateWindowsSdk());
  }
 else {
    for (    ToolType key : ToolType.values()) {
      availability.mustExist(key.getToolName(),tools.locate(key));
    }
  }
}
