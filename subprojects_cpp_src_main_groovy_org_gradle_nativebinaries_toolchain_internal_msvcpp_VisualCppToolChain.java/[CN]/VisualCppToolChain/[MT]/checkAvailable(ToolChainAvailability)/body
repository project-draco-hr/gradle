{
  if (!operatingSystem.isWindows()) {
    availability.unavailable("Not available on this operating system.");
    return;
  }
  if (installDir != null) {
    VisualStudioLocation visualStudio=VisualStudioLocation.findByCandidate(installDir);
    availability.mustExist("Visual Studio installation",visualStudio.getVisualStudioDir());
    availability.mustExist("Windows SDK",visualStudio.getWindowsSdkDir());
  }
 else {
    for (    ToolType key : ToolType.values()) {
      availability.mustExist(key.getToolName(),tools.locate(key));
    }
  }
}
