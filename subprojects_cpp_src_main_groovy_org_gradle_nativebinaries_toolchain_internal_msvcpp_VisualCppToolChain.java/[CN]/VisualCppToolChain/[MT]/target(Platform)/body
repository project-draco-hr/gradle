{
  checkAvailable();
  checkPlatform(targetPlatform);
  VisualStudioInstall visualStudioInstall=locateVisualStudioInstall();
  WindowsSdk windowsSdk=null;
  if (windowsSdkLocator.locateWindowsSdks(windowsSdkDir)) {
    windowsSdk=(windowsSdkVersion != null) ? windowsSdkLocator.getSdk(windowsSdkVersion) : windowsSdkLocator.getDefaultSdk();
  }
  return new VisualCppPlatformToolChain(visualStudioInstall,windowsSdk,targetPlatform);
}
