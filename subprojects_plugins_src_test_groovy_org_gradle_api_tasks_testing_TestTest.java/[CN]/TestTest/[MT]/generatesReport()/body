{
  configureTask();
  expectTestsExecuted();
  final TestReporter testReporter=context.mock(TestReporter.class);
  test.setTestReporter(testReporter);
  context.checking(new Expectations(){
{
      one(testReporter).generateReport(with(any(TestResultsProvider.class)),with(equal(reportDir)));
    }
  }
);
  test.executeTests();
}
