{
  if (notation == null) {
    if (primitive) {
      throw new UnsupportedNotationException("Cannot convert null to a primitive type.");
    }
    return null;
  }
  if (notation instanceof CharSequence) {
    String s=notation.toString();
    if (String.class.equals(type)) {
      return s;
    }
    s=s.trim();
    if (type.isEnum()) {
      try {
        return Enum.valueOf(type,s);
      }
 catch (      IllegalArgumentException e) {
        throw new TypeConversionException(String.format("Cannot coerce string value '%s' to an enum value of type '%s' (valid case insensitive values: %s)",s,type.getName(),CollectionUtils.toStringList(Arrays.asList(type.getEnumConstants()))));
      }
    }
    try {
      if (Double.class.equals(type)) {
        return Double.valueOf(s);
      }
      if (Float.class.equals(type)) {
        return Float.valueOf(s);
      }
      if (Integer.class.equals(type)) {
        return Integer.valueOf(s);
      }
      if (Long.class.equals(type)) {
        return Long.valueOf(s);
      }
      if (Short.class.equals(type)) {
        return Short.valueOf(s);
      }
      if (Byte.class.equals(type)) {
        return Byte.valueOf(s);
      }
      if (BigDecimal.class.equals(type)) {
        return new BigDecimal(s);
      }
      if (BigInteger.class.equals(type)) {
        return new BigInteger(s);
      }
    }
 catch (    NumberFormatException e) {
      throw new TypeConversionException(String.format("Cannot coerce string value '%s' to type %s",s,getRequestedTypeName(type,primitive)));
    }
    if (Character.class.equals(type)) {
      if (s.length() != 1) {
        throw new TypeConversionException(String.format("Cannot coerce string value '%s' with length %d to type %s",s,s.length(),getRequestedTypeName(type,primitive)));
      }
      return s.charAt(0);
    }
    if (Boolean.class.equals(type)) {
      return "true".equals(s);
    }
  }
  throw new UnsupportedNotationException("Unsupported type");
}
