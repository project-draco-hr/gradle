{
  final TestFile zipFile=tmpDir.getDir().file("test.zip");
  context.checking(new Expectations(){
{
      allowing(copyAction).getArchivePath();
      will(returnValue(zipFile));
    }
  }
);
  visitor.startVisit(copyAction);
  visitor.visitSpec(copySpec);
  visitor.visitFile(file("dir/file1"));
  visitor.visitFile(file("file2"));
  visitor.endVisit();
  TestFile expandDir=tmpDir.getDir().file("expanded");
  zipFile.unzipTo(expandDir);
  expandDir.file("dir/file1").assertContents(equalTo("contents of dir/file1"));
  expandDir.file("file2").assertContents(equalTo("contents of file2"));
}
