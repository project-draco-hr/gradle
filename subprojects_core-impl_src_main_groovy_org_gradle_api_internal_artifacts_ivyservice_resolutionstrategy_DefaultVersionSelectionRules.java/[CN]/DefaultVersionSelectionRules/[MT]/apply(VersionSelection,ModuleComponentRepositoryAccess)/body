{
  for (  RuleAction<? super VersionSelection> rule : versionSelectionRules) {
    List<Object> inputs=Lists.newArrayList();
    for (    Class<?> inputType : rule.getInputTypes()) {
      if (inputType == ComponentMetadata.class) {
        MutableModuleVersionMetaData metaData=getMetaData(selection,moduleAccess);
        ComponentMetadataDetails componentMetadata=new ComponentMetadataDetailsAdapter(metaData);
        inputs.add(componentMetadata);
        continue;
      }
      if (inputType == IvyModuleDescriptor.class) {
        MutableModuleVersionMetaData metaData=getMetaData(selection,moduleAccess);
        if (metaData instanceof IvyModuleVersionMetaData) {
          IvyModuleVersionMetaData ivyMetadata=(IvyModuleVersionMetaData)metaData;
          inputs.add(new DefaultIvyModuleDescriptor(ivyMetadata.getExtraInfo(),ivyMetadata.getBranch(),ivyMetadata.getStatus()));
          continue;
        }
 else {
          return;
        }
      }
      throw new InvalidUserCodeException(String.format(UNSUPPORTED_PARAMETER_TYPE_ERROR,inputType.getName()));
    }
    try {
      rule.execute(selection,inputs);
    }
 catch (    Exception e) {
      throw new InvalidUserCodeException(USER_CODE_ERROR,e);
    }
  }
}
