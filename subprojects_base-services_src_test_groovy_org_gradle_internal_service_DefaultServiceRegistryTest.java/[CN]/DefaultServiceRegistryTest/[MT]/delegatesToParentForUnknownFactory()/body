{
  @SuppressWarnings("unchecked") final Factory<Map> factory=context.mock(Factory.class);
  final ServiceRegistry parent=context.mock(ServiceRegistry.class);
  TestRegistry registry=new TestRegistry(parent);
  context.checking(new Expectations(){
{
      one(parent).getFactory(Map.class);
      will(returnValue(factory));
    }
  }
);
  assertThat(registry.getFactory(Map.class),sameInstance((Object)factory));
}
