{
  int range=toPort - fromPort + 1;
  int curr=candidateCounter.getAndIncrement();
  int last=curr + range;
  while (curr < last) {
    int candidate=fromPort + curr % range;
    if (available(candidate)) {
      return candidate;
    }
    curr=candidateCounter.getAndIncrement();
  }
  throw new NoSuchElementException("Could not find an available port within port range");
}
