{
  if (methodParamClassLoader == null) {
    methodParamClassLoader=getClass().getClassLoader();
  }
  StatefulSerializer<Object[]> paramSerializer;
  if (this.paramSerializer != null) {
    paramSerializer=Serializers.stateful(this.paramSerializer);
  }
 else {
    paramSerializer=new JavaSerializer<Object[]>(methodParamClassLoader);
  }
  MessageSerializer<InterHubMessage> serializer=new InterHubMessageSerializer(new TypeSafeSerializer<MethodInvocation>(MethodInvocation.class,new MethodInvocationSerializer(methodParamClassLoader,paramSerializer)));
  connection=completion.create(serializer);
  hub.addConnection(connection);
  completion=null;
}
