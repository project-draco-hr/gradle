{
  Class<?> pluginClass=potentialPlugin.asClass();
  if (potentialPlugin.getType().equals(PotentialPlugin.Type.UNKNOWN)) {
    throw new IllegalArgumentException("'" + pluginClass.getName() + "' is neither a plugin or a rule source and cannot be applied.");
  }
 else   if (!isApplied(pluginClass)) {
    final Class<? extends Plugin<?>> asImperativeClass=potentialPlugin.asImperativeClass();
    if (asImperativeClass == null) {
      applicator.applyRules(pluginId,pluginClass);
      addPlugin(pluginId,pluginClass);
    }
 else {
      SingleMessageLogger.whileDisabled(new Runnable(){
        public void run(){
          if (pluginId == null) {
            pluginContainer.apply(asImperativeClass);
          }
 else {
            pluginContainer.apply(pluginId);
          }
        }
      }
);
    }
  }
}
