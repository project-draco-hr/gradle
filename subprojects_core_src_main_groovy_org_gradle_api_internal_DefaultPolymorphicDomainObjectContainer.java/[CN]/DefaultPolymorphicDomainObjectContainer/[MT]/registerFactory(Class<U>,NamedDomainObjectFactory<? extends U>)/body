{
  if (!getType().isAssignableFrom(type)) {
    throw new IllegalArgumentException(String.format("Cannot register a factory for type %s because " + "it is not a subtype of container element type %s.",type.getSimpleName(),getTypeDisplayName()));
  }
  factories.put(type,factory);
}
