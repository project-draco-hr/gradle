{
  GradleBuildOutcomeSetTransformer fromOutcomeTransformer=createOutcomeSetTransformer("source");
  ProjectOutcomes fromOutput=generateBuildOutput(sourceVersion,getSourceProjectDir());
  Set<BuildOutcome> fromOutcomes=fromOutcomeTransformer.transform(fromOutput);
  GradleBuildOutcomeSetTransformer toOutcomeTransformer=createOutcomeSetTransformer("target");
  ProjectOutcomes toOutput=generateBuildOutput(targetVersion,getTargetProjectDir());
  Set<BuildOutcome> toOutcomes=toOutcomeTransformer.transform(toOutput);
  BuildOutcomeAssociator archivesAssociator=new ByTypeAndNameBuildOutcomeAssociator<BuildOutcome>(GeneratedArchiveBuildOutcome.class);
  BuildOutcomeAssociator unknownAssociator=new ByTypeAndNameBuildOutcomeAssociator<BuildOutcome>(UnknownBuildOutcome.class);
  BuildOutcomeAssociator compositeAssociator=new CompositeBuildOutcomeAssociator(archivesAssociator,unknownAssociator);
  BuildComparisonSpecFactory specFactory=new BuildComparisonSpecFactory(compositeAssociator);
  BuildComparisonSpec comparisonSpec=specFactory.createSpec(fromOutcomes,toOutcomes);
  DefaultBuildOutcomeComparatorFactory comparatorFactory=new DefaultBuildOutcomeComparatorFactory();
  comparatorFactory.registerComparator(new GeneratedArchiveBuildOutcomeComparator());
  comparatorFactory.registerComparator(new UnknownBuildOutcomeComparator());
  BuildComparator buildComparator=new DefaultBuildComparator(comparatorFactory);
  BuildComparisonResult result=buildComparator.compareBuilds(comparisonSpec);
  writeReport(result);
}
