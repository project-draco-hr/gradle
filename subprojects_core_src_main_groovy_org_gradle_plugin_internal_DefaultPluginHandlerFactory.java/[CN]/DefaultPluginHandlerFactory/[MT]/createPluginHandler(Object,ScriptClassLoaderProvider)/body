{
  if (target instanceof PluginAware) {
    PluginHandlerInternal pluginHandler=new DefaultPluginHandler(instantiator,new PluginResolutionApplicator((PluginAware)target,parentClassLoader));
    addDefaultResolvers(pluginHandler,classLoaderProvider);
    return pluginHandler;
  }
 else {
    return new NonPluggableTargetPluginHandler(target);
  }
}
