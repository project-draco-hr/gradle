{
  Map<String,ClassDependents> dependents=new HashMap<String,ClassDependents>();
  Iterator output=FileUtils.iterateFiles(compiledClassesDir,new String[]{"class"},true);
  ClassNameProvider nameProvider=new ClassNameProvider(compiledClassesDir);
  while (output.hasNext()) {
    File classFile=(File)output.next();
    String className=nameProvider.provideName(classFile);
    if (!className.startsWith(packagePrefix)) {
      continue;
    }
    try {
      ClassAnalysis analysis=analyzer.getClassAnalysis(className,classFile);
      for (      String dependency : analysis.getClassDependencies()) {
        if (!dependency.equals(className) && dependency.startsWith(packagePrefix)) {
          populate(dependents,dependency,className);
        }
      }
      if (analysis.isDependencyToAll()) {
        dependents.put(className,ClassDependents.dependencyToAll());
      }
    }
 catch (    IOException e) {
      throw new RuntimeException("Problems extracting class dependency from " + classFile,e);
    }
  }
  return new ClassDependencyInfo((Map)dependents);
}
