{
  pipelinesLock.writeLock().lock();
  try {
    final Pipeline pipeline=pipelineFactory.createPipeline(this,getNextPipelineId(),pipelineConfig);
    pipelinesInfo.put(pipeline.getId(),pipeline);
    orderedPipelines.add(pipeline);
    notStopped.add(pipeline);
    return pipeline;
  }
  finally {
    pipelinesLock.writeLock().unlock();
  }
}
