{
  int handle=openKey(subkey);
  try {
    byte[] value=queryValueEx(handle,name);
    if (value == null) {
      throw new WindowsRegistryException("registry string " + subkey + "."+ name+ " not found");
    }
    return fromCString(value);
  }
  finally {
    closeKey(handle);
  }
}
