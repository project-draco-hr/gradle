{
  FileCollectionSnapshot lastExecutionOutputFiles;
  if (previousExecution == null || previousExecution.getOutputFilesSnapshot() == null) {
    lastExecutionOutputFiles=outputFilesSnapshotter.emptySnapshot();
  }
 else {
    lastExecutionOutputFiles=previousExecution.getOutputFilesSnapshot();
  }
  FileCollectionSnapshot newOutputFiles=lastExecutionOutputFiles.updateFrom(outputFilesBefore);
  FileCollectionSnapshot outputFilesAfter=createSnapshot(outputFilesSnapshotter,task.getOutputs().getFiles());
  currentExecution.setOutputFilesSnapshot(outputFilesAfter.applyAllChangesSince(outputFilesBefore,newOutputFiles));
}
