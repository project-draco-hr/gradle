{
  final String fieldSignature=ABSTRACT_DYNAMIC_OBJECT_TYPE.getDescriptor();
  visitor.visitField(Opcodes.ACC_PRIVATE,DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature,null,null);
  final Method getAsDynamicObject=DynamicObjectAware.class.getDeclaredMethod("getAsDynamicObject");
  if (extensible) {
    addGetter(HasConvention.class.getDeclaredMethod("getConvention"),new MethodCodeBody(){
      public void add(      MethodVisitor visitor) throws Exception {
        visitor.visitVarInsn(Opcodes.ALOAD,0);
        visitor.visitMethodInsn(Opcodes.INVOKEVIRTUAL,generatedType.getInternalName(),"getAsDynamicObject",Type.getMethodDescriptor(getAsDynamicObject),false);
        visitor.visitTypeInsn(Opcodes.CHECKCAST,EXTENSIBLE_DYNAMIC_OBJECT_HELPER_TYPE.getInternalName());
        visitor.visitMethodInsn(Opcodes.INVOKEVIRTUAL,EXTENSIBLE_DYNAMIC_OBJECT_HELPER_TYPE.getInternalName(),"getConvention",RETURN_CONVENTION,false);
      }
    }
);
    addGetter(ExtensionAware.class.getDeclaredMethod("getExtensions"),new MethodCodeBody(){
      public void add(      MethodVisitor visitor) throws Exception {
        visitor.visitVarInsn(Opcodes.ALOAD,0);
        visitor.visitMethodInsn(Opcodes.INVOKEVIRTUAL,generatedType.getInternalName(),"getConvention",RETURN_CONVENTION,false);
      }
    }
);
  }
  addGetter(getAsDynamicObject,new MethodCodeBody(){
    public void add(    MethodVisitor visitor){
      visitor.visitVarInsn(Opcodes.ALOAD,0);
      visitor.visitFieldInsn(Opcodes.GETFIELD,generatedType.getInternalName(),DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature);
      Label returnValue=new Label();
      visitor.visitInsn(Opcodes.DUP);
      visitor.visitJumpInsn(Opcodes.IFNONNULL,returnValue);
      visitor.visitInsn(Opcodes.POP);
      visitor.visitVarInsn(Opcodes.ALOAD,0);
      generateCreateDynamicObject(visitor);
      visitor.visitFieldInsn(Opcodes.PUTFIELD,generatedType.getInternalName(),DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature);
      visitor.visitVarInsn(Opcodes.ALOAD,0);
      visitor.visitFieldInsn(Opcodes.GETFIELD,generatedType.getInternalName(),DYNAMIC_OBJECT_HELPER_FIELD,fieldSignature);
      visitor.visitLabel(returnValue);
    }
  }
);
}
