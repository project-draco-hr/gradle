{
  if (result != null) {
    return result;
  }
  locateInstallsInRegistry();
  locateInstallInPath();
  if (candidate != null) {
    locateUserSpecifiedInstall(candidate);
  }
  defaultInstall=determineDefaultInstall();
  result=new ToolSearchResult(){
    public boolean isAvailable(){
      return defaultInstall != null;
    }
    public void explain(    TreeVisitor<? super String> visitor){
      visitor.node(String.format("%s could not be found.",VISUAL_STUDIO_DISPLAY_NAME));
    }
  }
;
  return result;
}
