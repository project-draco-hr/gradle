{
  try {
    List<String> valueNames=windowsRegistry.getValueNames(WindowsRegistry.Key.HKEY_LOCAL_MACHINE,REGISTRY_ROOTPATH);
    for (    String valueName : valueNames) {
      File installDir=new File(windowsRegistry.getStringValue(WindowsRegistry.Key.HKEY_LOCAL_MACHINE,REGISTRY_ROOTPATH,valueName));
      if (isVisualStudio(installDir)) {
        LOGGER.debug("Found Visual Studio {} at {}",valueName,installDir);
        addInstall(installDir,valueName,NAME_VISUALSTUDIO + " " + valueName);
      }
 else {
        LOGGER.debug("Ignoring candidate Visual Studio directory {} as it does not look like a Visual Studio installation.",installDir);
      }
    }
  }
 catch (  MissingRegistryEntryException e) {
  }
}
