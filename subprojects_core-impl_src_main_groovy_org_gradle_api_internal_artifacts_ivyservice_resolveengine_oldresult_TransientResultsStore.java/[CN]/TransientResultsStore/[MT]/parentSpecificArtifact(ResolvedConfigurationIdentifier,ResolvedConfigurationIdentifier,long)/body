{
  if (!visitedNodes.contains(parent)) {
    throw new IllegalArgumentException(String.format("Unexpected parent artifact id %s. Seen ids: %s",parent,visitedNodes));
  }
  if (!visitedNodes.contains(child)) {
    throw new IllegalArgumentException(String.format("Unexpected child artifact id %s. Seen ids: %s",parent,visitedNodes));
  }
  writeId(PARENT_ARTIFACT,child,parent);
  binaryStore.write(new BinaryStore.WriteAction(){
    public void write(    DataOutputStream output) throws IOException {
      output.writeLong(artifactId);
    }
  }
);
}
