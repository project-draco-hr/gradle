{
  if (!visitedNodes.contains(id)) {
    throw new IllegalArgumentException(String.format("Unexpected root id %s. Seen ids: %s",id,visitedNodes));
  }
  writeId(ROOT,id);
  LOG.debug("Flushing resolved configuration data in {}. Wrote root {}.",binaryStore,id);
  binaryData=binaryStore.done();
}
