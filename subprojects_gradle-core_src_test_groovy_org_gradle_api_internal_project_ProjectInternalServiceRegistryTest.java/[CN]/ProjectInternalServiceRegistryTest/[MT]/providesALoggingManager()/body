{
  final Factory<LoggingManagerInternal> loggingManagerFactory=context.mock(Factory.class);
  final LoggingManager loggingManager=context.mock(LoggingManagerInternal.class);
  context.checking(new Expectations(){
{
      allowing(parent).getFactory(LoggingManagerInternal.class);
      will(returnValue(loggingManagerFactory));
      one(loggingManagerFactory).create();
      will(returnValue(loggingManager));
    }
  }
);
  assertThat(registry.get(LoggingManager.class),sameInstance(loggingManager));
  assertThat(registry.get(LoggingManager.class),sameInstance(registry.get(LoggingManager.class)));
}
