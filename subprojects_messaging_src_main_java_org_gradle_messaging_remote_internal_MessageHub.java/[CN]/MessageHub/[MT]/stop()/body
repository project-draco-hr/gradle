{
  requestStop();
  CompositeStoppable stoppable=new CompositeStoppable();
  lock.lock();
  try {
    stoppable.add(outgoingUnicasts.values());
    stoppable.add(outgoingBroadcasts.values());
    stoppable.add(workers);
    stoppable.add(handlers);
    stoppable.add(connections);
    stoppable.add(router);
    stoppable.add(executors);
  }
  finally {
    outgoingUnicasts.clear();
    outgoingBroadcasts.clear();
    workers.clear();
    handlers.clear();
    lock.unlock();
  }
  stoppable.stop();
}
