{
  logger.info("Publishing to repository {}",artifactRepository);
  CustomDeployTask deployTask=createDeployTask();
  MavenSettingsSupplier mavenSettingsSupplier=new EmptyMavenSettingsSupplier();
  mavenSettingsSupplier.supply(deployTask);
  addRepository(deployTask,artifactRepository);
  addPomAndArtifact(deployTask,publication.getPomFile(),publication.getMainArtifact(),publication.getAdditionalArtifacts());
  execute(deployTask);
  mavenSettingsSupplier.done();
}
