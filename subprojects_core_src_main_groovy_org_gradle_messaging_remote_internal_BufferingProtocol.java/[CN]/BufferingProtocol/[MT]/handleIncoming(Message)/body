{
  remainingIncomingCredits--;
  if (remainingOutgoingCredits == 0) {
    queue.add(message);
  }
 else {
    remainingOutgoingCredits--;
    context.dispatchIncoming(message);
  }
  maybeGrantIncomingCredits();
}
