{
  lock.lock();
  try {
    if (!stopped.get()) {
      if (!handles.containsKey(handle.getId())) {
        handles.put(handle.getId(),handle);
      }
      buildSession.add(handles.get(handle.getId()));
    }
 else {
      throw new IllegalStateException("Cannot register a new DeploymentHandle after the registry has been stopped.");
    }
  }
  finally {
    lock.unlock();
  }
}
