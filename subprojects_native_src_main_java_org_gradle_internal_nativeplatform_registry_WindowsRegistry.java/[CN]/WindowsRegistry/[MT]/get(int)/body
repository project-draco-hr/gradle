{
switch (classId) {
case HKEY_CURRENT_USER:
    return new WindowsRegistryAccess(HKEY_CURRENT_USER,Preferences.userRoot());
case HKEY_LOCAL_MACHINE:
  return new WindowsRegistryAccess(HKEY_LOCAL_MACHINE,Preferences.systemRoot());
default :
throw new IllegalArgumentException("Unknown registry class.");
}
}
