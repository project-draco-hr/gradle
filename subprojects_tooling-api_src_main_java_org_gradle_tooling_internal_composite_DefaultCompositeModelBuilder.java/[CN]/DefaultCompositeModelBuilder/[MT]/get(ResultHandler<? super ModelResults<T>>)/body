{
  final ConsumerOperationParameters operationParameters=getConsumerOperationParameters();
  connection.run(new ConsumerAction<ModelResults<T>>(){
    public ConsumerOperationParameters getParameters(){
      return operationParameters;
    }
    public ModelResults<T> run(    ConsumerConnection connection){
      final Iterable<ModelResult<T>> models=connection.buildModels(modelType,operationParameters);
      return new ModelResults<T>(){
        @Override public Iterator<ModelResult<T>> iterator(){
          return models.iterator();
        }
      }
;
    }
  }
,new ResultHandlerAdapter<ModelResults<T>>(handler){
    @Override protected String connectionFailureMessage(    Throwable failure){
      String message=String.format("Could not fetch models of type '%s' using %s.",modelType.getSimpleName(),connection.getDisplayName());
      if (!(failure instanceof UnsupportedMethodException) && failure instanceof UnsupportedOperationException) {
        message+="\n" + Exceptions.INCOMPATIBLE_VERSION_HINT;
      }
      return message;
    }
  }
);
}
