{
  FilteringClassLoader classLoader=new FilteringClassLoader(parent);
  if (needJaxpImpl()) {
    ServiceLocator locator=new ServiceLocator(getSystemClassLoader());
    makeServiceVisible(locator,classLoader,SAXParserFactory.class);
    makeServiceVisible(locator,classLoader,DocumentBuilderFactory.class);
    makeServiceVisible(locator,classLoader,DatatypeFactory.class);
  }
  return classLoader;
}
