{
  if (details.isDirectory()) {
    RelativePath path=details.getRelativePath();
    if (!visitedDirs.contains(path)) {
      pendingDirs.put(path,details);
    }
  }
 else {
    maybeVisit(details.getRelativePath().getParent(),details.getCopySpec());
    getVisitor().visit(details);
  }
}
