{
  final TestClosure testClosure=context.mock(TestClosure.class);
  context.checking(new Expectations(){
{
      one(testClosure).call(scriptHandlerMock);
      one(scriptHandlerMock).getRepositories();
    }
  }
);
  Closure closure=HelperUtil.toClosure(testClosure);
  gradle.initscript(closure);
  assertThat(closure.getDelegate(),instanceOf(ScriptHandler.class));
  assertThat((ScriptHandler)closure.getDelegate(),equalTo(scriptHandlerMock));
}
