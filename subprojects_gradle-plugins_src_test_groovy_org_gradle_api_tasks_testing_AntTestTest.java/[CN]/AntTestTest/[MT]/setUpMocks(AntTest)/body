{
  test.setTestClassesDir(classesDir);
  test.setTestResultsDir(resultsDir);
  test.setTestReportDir(reportDir);
  test.setClasspath(classpathMock);
  test.setTestClassProcessor(testClassProcessorMock);
  test.setTestSrcDirs(Collections.<File>emptyList());
  context.checking(new Expectations(){
{
      one(testClassScannerFactoryMock).createTestClassScanner(test,testClassProcessorMock);
      will(returnValue(testClassScannerMock));
      one(testClassScannerMock).run();
      one(testClassProcessorMock).getTestClassFileNames();
      will(returnValue(OK_TEST_CLASS_NAMES));
      one(testFrameworkInstanceMock).execute(getProject(),test,OK_TEST_CLASS_NAMES,new ArrayList<String>());
    }
  }
);
}
