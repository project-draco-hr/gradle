{
  test.setTestClassesDir(classesDir);
  test.setTestResultsDir(resultsDir);
  test.setTestReportDir(reportDir);
  test.setClasspath(classpathMock);
  test.setTestSrcDirs(Collections.<File>emptyList());
  context.checking(new Expectations(){
{
      one(testClassScannerFactoryMock).createTestClassScanner(with(sameInstance(test)),with(notNullValue(TestClassProcessor.class)));
      will(returnValue(testClassScannerMock));
      one(testClassScannerMock).run();
    }
  }
);
}
