{
  final Transformer visitor=new AbstractScriptTransformer(){
    protected int getPhase(){
      return Phases.CANONICALIZATION;
    }
    @Override public void call(    SourceUnit source) throws CompilationFailedException {
      source.getAST().getStatementBlock().visit(new CodeVisitorSupport(){
        @Override public void visitMethodCallExpression(        MethodCallExpression call){
          call.setObjectExpression(new ClassExpression(ClassHelper.make(System.class)));
          call.setMethod(new ConstantExpression("setProperty"));
          ArgumentListExpression arguments=(ArgumentListExpression)call.getArguments();
          arguments.addExpression(new ConstantExpression(TEST_EXPECTED_SYSTEMPROP_KEY));
          arguments.addExpression(new ConstantExpression(TEST_EXPECTED_SYSTEMPROP_VALUE));
        }
      }
);
    }
  }
;
  CompileOperation<?> transformer=new CompileOperation<Boolean>(){
    @Override public String getId(){
      return "id";
    }
    @Override public Transformer getTransformer(){
      return visitor;
    }
    @Override public Boolean getExtractedData(){
      return true;
    }
    @Override public Serializer<Boolean> getDataSerializer(){
      return BaseSerializerFactory.BOOLEAN_SERIALIZER;
    }
  }
;
  ScriptSource source=scriptSource("transformMe()");
  scriptCompilationHandler.compileToDir(source,classLoader,scriptCacheDir,metadataCacheDir,transformer,classpathClosureName,expectedScriptClass,verifier);
  Script script=scriptCompilationHandler.loadFromDir(source,classLoader,scriptCacheDir,metadataCacheDir,transformer,expectedScriptClass,classLoaderId).loadClass().newInstance();
  evaluateScript(script);
}
