{
  ScriptSource source=new StringScriptSource("script.gradle","\n\nnew HHHHJSJSJ jsj");
  try {
    scriptCompilationHandler.compileToDir(source,classLoader,scriptCacheDir,metadataCacheDir,null,expectedScriptClass,verifier);
    fail();
  }
 catch (  ScriptCompilationException e) {
    assertThat(e.getScriptSource(),sameInstance(source));
    assertThat(e.getLineNumber(),equalTo(3));
    assertThat(e.getCause().getMessage(),containsLine(startsWith("script.gradle: 3: unexpected token: jsj")));
  }
  checkScriptCacheEmpty();
}
