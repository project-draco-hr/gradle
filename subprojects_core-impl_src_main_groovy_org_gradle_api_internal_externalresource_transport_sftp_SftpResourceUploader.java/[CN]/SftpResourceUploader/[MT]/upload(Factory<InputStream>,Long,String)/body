{
  URI uri=toUri(destination);
  SftpClient client=sftpClientFactory.createSftpClient(uri,credentials);
  String path=uri.getPath();
  OutputStream outputStream=null;
  try {
    ensureParentDirectoryExists(client,path);
    outputStream=client.write(uri.getPath());
    InputStream sourceStream=sourceFactory.create();
    try {
      IOUtils.copyLarge(sourceStream,outputStream);
      outputStream.flush();
    }
  finally {
      sourceStream.close();
    }
  }
  finally {
    if (outputStream != null) {
      outputStream.close();
    }
    sftpClientFactory.releaseSftpClient(client);
  }
}
