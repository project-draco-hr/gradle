{
  byte protocolVersion=input.readByte();
  if (protocolVersion != PROTOCOL_VERSION) {
    return new UnknownMessage(String.format("unknown protocol version %s",protocolVersion));
  }
  byte messageType=input.readByte();
switch (messageType) {
case LOOKUP_REQUEST:
    return readLookupRequest();
case CHANNEL_AVAILABLE:
  return readChannelAvailable();
case CHANNEL_UNAVAILABLE:
return readChannelUnavailable();
}
return new UnknownMessage(String.format("unknown message type %s",messageType));
}
