{
  List<String> allArgs=new ArrayList<String>();
  if (buildScript != null) {
    allArgs.add("--build-file");
    allArgs.add(buildScript.getAbsolutePath());
  }
  if (projectDir != null) {
    allArgs.add("--project-dir");
    allArgs.add(projectDir.getAbsolutePath());
  }
  for (  File initScript : initScripts) {
    allArgs.add("--init-script");
    allArgs.add(initScript.getAbsolutePath());
  }
  if (settingsFile != null) {
    allArgs.add("--settings-file");
    allArgs.add(settingsFile.getAbsolutePath());
  }
  if (quiet) {
    allArgs.add("--quiet");
  }
  if (taskList) {
    allArgs.add("tasks");
  }
  if (dependencyList) {
    allArgs.add("dependencies");
  }
  if (!searchUpwards) {
    boolean settingsFoundAboveInTestDir=false;
    TestFile dir=new TestFile(getWorkingDir());
    while (dir != null && getTestDirectoryProvider().getTestDirectory().isSelfOrDescendent(dir)) {
      if (dir.file("settings.gradle").isFile()) {
        settingsFoundAboveInTestDir=true;
        break;
      }
      dir=dir.getParentFile();
    }
    if (!settingsFoundAboveInTestDir) {
      allArgs.add("--no-search-upward");
    }
  }
  if (gradleUserHomeDir != null) {
    allArgs.add("--gradle-user-home");
    allArgs.add(gradleUserHomeDir.getAbsolutePath());
  }
  allArgs.add("-Dorg.gradle.daemon.idletimeout=" + daemonIdleTimeoutSecs * 1000);
  allArgs.add("-Dorg.gradle.daemon.registry.base=" + daemonBaseDir.getAbsolutePath());
  allArgs.addAll(args);
  allArgs.addAll(tasks);
  return allArgs;
}
