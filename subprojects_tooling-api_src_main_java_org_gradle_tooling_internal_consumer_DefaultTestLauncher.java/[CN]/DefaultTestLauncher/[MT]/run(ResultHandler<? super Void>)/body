{
  final ConsumerOperationParameters operationParameters=operationParamsBuilder.setParameters(connectionParameters).build();
  connection.run(new ConsumerAction<Void>(){
    public ConsumerOperationParameters getParameters(){
      return operationParameters;
    }
    public Void run(    ConsumerConnection connection){
      if (connection instanceof TestExecutionConsumerConnection) {
        Void sink=((TestExecutionConsumerConnection)connection).runTests(new TestExecutionRequest(operationDescriptors),getParameters());
        operationParameters.getBuildProgressListener().rethrowErrors();
        return sink;
      }
 else {
        throw new UnsupportedVersionException("TestLauncher API not supported by Gradle provider version");
      }
    }
  }
,new ResultHandlerAdapter(handler));
}
