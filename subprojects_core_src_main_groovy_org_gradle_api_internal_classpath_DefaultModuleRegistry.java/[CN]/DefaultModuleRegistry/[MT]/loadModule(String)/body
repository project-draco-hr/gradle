{
  File jarFile=findModuleJar(moduleName);
  if (jarFile != null) {
    Set<File> implementationClasspath=new LinkedHashSet<File>();
    implementationClasspath.add(jarFile);
    Properties properties=loadModuleProperties(moduleName,jarFile);
    return module(moduleName,properties,implementationClasspath);
  }
  String resourceName=String.format("%s-classpath.properties",moduleName);
  URL propertiesUrl=classLoader.getResource(resourceName);
  if (propertiesUrl != null) {
    Set<File> implementationClasspath=new LinkedHashSet<File>();
    findImplementationClasspath(moduleName,implementationClasspath);
    implementationClasspath.add(ClasspathUtil.getClasspathForResource(propertiesUrl,resourceName));
    Properties properties=GUtil.loadProperties(propertiesUrl);
    return module(moduleName,properties,implementationClasspath);
  }
  if (distDir == null) {
    throw new UnknownModuleException(String.format("Cannot locate classpath manifest for module '%s' in classpath.",moduleName));
  }
  throw new UnknownModuleException(String.format("Cannot locate JAR for module '%s' in distribution directory '%s'.",moduleName,distDir));
}
