{
  this.classLoader=classLoader;
  this.distDir=distDir;
  for (  URL url : ClasspathUtil.getClasspath(classLoader)) {
    if (url.getProtocol().equals("file")) {
      try {
        addClasspathEntry(new File(url.toURI()));
      }
 catch (      URISyntaxException e) {
        throw new UncheckedIOException(e);
      }
    }
  }
  if (classLoader == ClassLoader.getSystemClassLoader()) {
    for (    String value : System.getProperty("java.class.path").split(File.pathSeparator)) {
      addClasspathEntry(new File(value));
    }
  }
  if (distDir != null) {
    libDirs.add(new File(distDir,"lib"));
    libDirs.add(new File(distDir,"lib/plugins"));
  }
}
