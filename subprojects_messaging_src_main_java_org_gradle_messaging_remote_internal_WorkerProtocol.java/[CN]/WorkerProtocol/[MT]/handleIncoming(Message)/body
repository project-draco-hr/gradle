{
  if (message instanceof EndOfStreamEvent) {
    LOGGER.debug("Received worker stopped: {}",message);
    context.stopped();
  }
 else   if (message instanceof Request) {
    Request request=(Request)message;
    LOGGER.debug("Dispatching request to worker: {}",message);
    try {
      worker.dispatch(request.getPayload());
    }
  finally {
      context.dispatchOutgoing(new MessageCredits(1));
    }
  }
 else {
    throw new IllegalArgumentException(String.format("Unexpected incoming message received: %s",message));
  }
}
