{
  BaseSerializerFactory factory=new BaseSerializerFactory();
  Serializer<LogLevel> logLevelSerializer=factory.getSerializerFor(LogLevel.class);
  Serializer<Throwable> throwableSerializer=factory.getSerializerFor(Throwable.class);
  DefaultSerializerRegistry<Object> registry=new DefaultSerializerRegistry<Object>();
  registry.register(BuildEvent.class,new BuildEventSerializer());
  registry.register(Failure.class,new FailureSerializer(throwableSerializer));
  registry.register(LogEvent.class,new LogEventSerializer(logLevelSerializer,throwableSerializer));
  registry.register(StyledTextOutputEvent.class,new StyledTextOutputEventSerializer(logLevelSerializer,new ListSerializer<StyledTextOutputEvent.Span>(new SpanSerializer(factory.getSerializerFor(StyledTextOutput.Style.class)))));
  registry.register(ProgressStartEvent.class,new ProgressStartEventSerializer());
  registry.register(ProgressCompleteEvent.class,new ProgressCompleteEventSerializer());
  registry.register(ProgressEvent.class,new ProgressEventSerializer());
  registry.register(LogLevelChangeEvent.class,new LogLevelChangeEventSerializer(logLevelSerializer));
  registry.useJavaSerialization(Message.class);
  registry.useJavaSerialization(OutputEvent.class);
  return registry.build();
}
