{
  BaseSerializerFactory factory=new BaseSerializerFactory();
  DefaultSerializerRegistry<Object> registry=new DefaultSerializerRegistry<Object>();
  registry.register(BuildEvent.class,new BuildEventSerializer());
  Serializer<LogLevel> logLevelSerializer=factory.getSerializerFor(LogLevel.class);
  registry.register(LogEvent.class,new LogEventSerializer(logLevelSerializer,factory.getSerializerFor(Throwable.class)));
  registry.register(StyledTextOutputEvent.class,new StyledTextOutputEventSerializer(logLevelSerializer,new ListSerializer<StyledTextOutputEvent.Span>(new SpanSerializer(factory.getSerializerFor(StyledTextOutput.Style.class)))));
  registry.register(ProgressStartEvent.class,new ProgressStartEventSerializer());
  registry.register(ProgressCompleteEvent.class,new ProgressCompleteEventSerializer());
  registry.register(ProgressEvent.class,new ProgressEventSerializer());
  registry.useJavaSerialization(Message.class);
  registry.useJavaSerialization(OutputEvent.class);
  return registry.build();
}
