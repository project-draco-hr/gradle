{
  ForkOptions forkOptions=spec.getCompileOptions().getForkOptions();
  DaemonForkOptions daemonForkOptions=new DaemonForkOptions(forkOptions.getMemoryInitialSize(),forkOptions.getMemoryMaximumSize(),forkOptions.getJvmArgs(),Collections.<File>emptyList(),Collections.singleton("com.sun.tools.javac"));
  CompilerDaemon daemon=CompilerDaemonManager.getInstance().getDaemon(project,daemonForkOptions);
  CompileResult result=daemon.execute(delegate,spec);
  if (result.isSuccess()) {
    return result;
  }
  throw UncheckedException.throwAsUncheckedException(result.getException());
}
