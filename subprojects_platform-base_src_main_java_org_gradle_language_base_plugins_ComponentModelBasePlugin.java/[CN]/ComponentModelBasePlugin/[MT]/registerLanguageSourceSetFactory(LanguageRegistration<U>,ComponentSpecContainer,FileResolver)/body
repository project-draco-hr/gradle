{
  components.withType(ComponentSpecInternal.class).all(new Action<ComponentSpecInternal>(){
    public void execute(    final ComponentSpecInternal componentSpec){
      final FunctionalSourceSet functionalSourceSet=componentSpec.getSources();
      NamedDomainObjectFactory<U> namedDomainObjectFactory=new NamedDomainObjectFactory<U>(){
        public U create(        String name){
          Class<? extends U> sourceSetImplementation=languageRegistration.getSourceSetImplementation();
          return instantiator.newInstance(sourceSetImplementation,name,functionalSourceSet.getName(),fileResolver);
        }
      }
;
      functionalSourceSet.registerFactory(languageRegistration.getSourceSetType(),namedDomainObjectFactory);
    }
  }
);
}
