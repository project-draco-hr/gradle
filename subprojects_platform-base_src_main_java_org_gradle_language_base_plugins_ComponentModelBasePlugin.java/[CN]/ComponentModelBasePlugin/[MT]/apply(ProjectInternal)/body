{
  project.getPluginManager().apply(LanguageBasePlugin.class);
  final SimpleModelRuleDescriptor descriptor=new SimpleModelRuleDescriptor(ComponentModelBasePlugin.class.getName() + ".apply()");
  ModelReference<RuleAwarePolymorphicNamedEntityInstantiator<ComponentSpec>> componentTypeRegistryType=ModelReference.of(ModelPath.path("componentTypeRegistry"),new ModelType<RuleAwarePolymorphicNamedEntityInstantiator<ComponentSpec>>(){
  }
);
  modelRegistry.create(ModelCreators.unmanagedInstance(componentTypeRegistryType,Factories.constant(new DefaultRuleAwarePolymorphicNamedEntityInstantiator<ComponentSpec>(new DefaultPolymorphicNamedEntityInstantiator<ComponentSpec>(ComponentSpec.class,"this collection")))).descriptor(descriptor).ephemeral(true).build());
  ModelMapSchema<ComponentSpecContainer> schema=(ModelMapSchema<ComponentSpecContainer>)schemaStore.getSchema(ModelType.of(ComponentSpecContainer.class));
  ModelPath components=ModelPath.path("components");
  ModelCreator componentsCreator=ModelMapCreators.specialized(components,ComponentSpec.class,ComponentSpecContainer.class,schema.getManagedImpl().asSubclass(ComponentSpecContainer.class),componentTypeRegistryType,descriptor);
  modelRegistry.create(componentsCreator);
  modelRegistry.getRoot().applyToAllLinksTransitive(ModelActionRole.Defaults,DirectNodeModelAction.of(ModelReference.of(ComponentSpec.class),descriptor,ComponentSpecInitializer.action()));
}
