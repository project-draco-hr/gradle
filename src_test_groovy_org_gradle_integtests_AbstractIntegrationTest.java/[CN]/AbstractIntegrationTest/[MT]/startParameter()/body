{
  StartParameter parameter=new StartParameter();
  parameter.setGradleHomeDir(testFile("gradle-home"));
  testFile("gradle-home/gradle-imports").writelns("import org.gradle.api.*","import static org.junit.Assert.*","import static org.hamcrest.Matchers.*");
  testFile("gradle-home/plugin.properties").writelns("java=org.gradle.api.plugins.JavaPlugin","groovy=org.gradle.api.plugins.GroovyPlugin","war=org.gradle.api.plugins.WarPlugin","maven=org.gradle.api.plugins.MavenPlugin");
  parameter.setGradleUserHomeDir(testFile("user-home"));
  parameter.setSearchUpwards(false);
  parameter.setCacheUsage(CacheUsage.ON);
  parameter.setCurrentDir(getTestDir());
  return parameter;
}
