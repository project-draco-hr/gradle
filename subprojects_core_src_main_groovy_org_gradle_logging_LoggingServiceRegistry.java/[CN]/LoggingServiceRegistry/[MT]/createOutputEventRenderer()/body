{
  TerminalDetector terminalDetector;
  if (detectConsole) {
    StartParameter startParameter=new StartParameter();
    JnaBootPathConfigurer jnaConfigurer=new JnaBootPathConfigurer(startParameter.getGradleUserHomeDir());
    terminalDetector=new TerminalDetectorFactory().create(jnaConfigurer);
  }
 else {
    terminalDetector=new TerminalDetector(){
      public boolean isTerminal(      FileDescriptor fileDescriptor){
        return false;
      }
    }
;
  }
  return new OutputEventRenderer(terminalDetector).addStandardOutputAndError();
}
