{
  try {
    try {
      InputStream inputStream=new BufferedInputStream(Channels.newInputStream(socket));
      while (true) {
        Message message=Message.receive(inputStream,classLoader);
        if (message instanceof EndOfStream) {
          return;
        }
        MethodInvocation invocation=(MethodInvocation)message;
        try {
          broadcaster.dispatch(invocation);
        }
 catch (        Exception e) {
          if (exceptionListener != null) {
            exceptionListener.receiverThrewException(e);
          }
 else {
            throw e;
          }
        }
      }
    }
  finally {
      socket.close();
    }
  }
 catch (  Exception e) {
    LOGGER.warn("Could not handle remote event connection.",e);
  }
}
