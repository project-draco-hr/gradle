{
  if (compiler == null) {
    ProjectInternal projectInternal=(ProjectInternal)getProject();
    IsolatedAntBuilder antBuilder=getServices().get(IsolatedAntBuilder.class);
    Factory<AntBuilder> antBuilderFactory=getServices().getFactory(AntBuilder.class);
    CompilerDaemonFactory compilerDaemonFactory=getServices().get(CompilerDaemonManager.class);
    ScalaCompilerFactory scalaCompilerFactory=new ScalaCompilerFactory(projectInternal,antBuilder,antBuilderFactory,compilerDaemonFactory);
    Compiler<ScalaJavaJointCompileSpec> delegatingCompiler=new DelegatingScalaCompiler(scalaCompilerFactory);
    compiler=new CleaningScalaCompiler(delegatingCompiler,getOutputs());
  }
  return compiler;
}
