{
  if (value instanceof DefaultFileSnapshotter.FileCollectionSnapshotImpl) {
    encoder.writeByte((byte)1);
    DefaultFileSnapshotter.FileCollectionSnapshotImpl cached=(DefaultFileSnapshotter.FileCollectionSnapshotImpl)value;
    defaultSnapshotSerializer.write(encoder,cached);
  }
 else   if (value instanceof OutputFilesSnapshotter.OutputFilesSnapshot) {
    encoder.writeByte((byte)2);
    OutputFilesSnapshotter.OutputFilesSnapshot cached=(OutputFilesSnapshotter.OutputFilesSnapshot)value;
    outputSnapshotSerializer.write(encoder,cached);
  }
 else {
    throw new RuntimeException("Unable to write to file snapshot cache. Unexpected type to write: " + value);
  }
}
