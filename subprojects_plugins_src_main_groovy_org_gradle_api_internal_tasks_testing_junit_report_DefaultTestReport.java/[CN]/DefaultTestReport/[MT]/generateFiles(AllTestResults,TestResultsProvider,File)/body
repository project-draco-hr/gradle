{
  try {
    HtmlReportRenderer htmlRenderer=new HtmlReportRenderer();
    htmlRenderer.render(model,new ReportRenderer<AllTestResults,HtmlReportBuilder>(){
      @Override public void render(      AllTestResults model,      HtmlReportBuilder output) throws IOException {
        PackagePageRenderer packagePageRenderer=new PackagePageRenderer();
        ClassPageRenderer classPageRenderer=new ClassPageRenderer(resultsProvider);
        output.renderHtmlPage("index.html",model,new OverviewPageRenderer());
        for (        PackageTestResults packageResults : model.getPackages()) {
          output.renderHtmlPage(packageResults.getBaseUrl(),packageResults,packagePageRenderer);
          for (          ClassTestResults classResults : packageResults.getClasses()) {
            output.renderHtmlPage(classResults.getBaseUrl(),classResults,classPageRenderer);
          }
        }
      }
    }
,reportDir);
  }
 catch (  Exception e) {
    throw new GradleException(String.format("Could not generate test report to '%s'.",reportDir),e);
  }
}
