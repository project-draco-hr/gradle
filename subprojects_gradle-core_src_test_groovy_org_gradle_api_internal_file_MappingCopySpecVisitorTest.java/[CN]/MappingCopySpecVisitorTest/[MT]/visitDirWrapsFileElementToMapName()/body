{
  final Collector<FileVisitDetails> collector=expectSpecAndDirVisited();
  final CopyDestinationMapper mapper=context.mock(CopyDestinationMapper.class);
  final RelativePath specPath=new RelativePath(false,"spec");
  final RelativePath relativePath=new RelativePath(false,"file");
  context.checking(new Expectations(){
{
      allowing(spec).getDestinationMapper();
      will(returnValue(mapper));
      allowing(spec).getDestPath();
      will(returnValue(specPath));
      one(mapper).getPath(details);
      will(returnValue(relativePath));
    }
  }
);
  FileVisitDetails mappedDetails=collector.get();
  assertThat(mappedDetails.getRelativePath(),equalTo(new RelativePath(false,specPath,"file")));
}
