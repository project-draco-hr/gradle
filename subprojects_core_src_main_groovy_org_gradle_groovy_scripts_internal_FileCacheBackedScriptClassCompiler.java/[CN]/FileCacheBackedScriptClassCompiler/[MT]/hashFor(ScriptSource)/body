{
  File file=source.getResource().getFile();
  String hash;
  if (file != null && file.exists()) {
    CachingFileSnapshotter.FileInfo snapshot=snapshotter.snapshot(file);
    hash=new HashValue(snapshot.getHash()).asCompactString();
  }
 else {
    hash=HashUtil.createCompactMD5(source.getResource().getText());
  }
  return hash;
}
