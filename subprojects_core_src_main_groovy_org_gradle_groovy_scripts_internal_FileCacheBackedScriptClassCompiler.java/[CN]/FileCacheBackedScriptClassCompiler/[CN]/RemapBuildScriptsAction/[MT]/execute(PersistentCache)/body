{
  final PersistentCache cache=cacheRepository.cache(String.format("scripts/%s/%s",hash,dslId)).withProperties(cacheProperties).withValidator(validator).withDisplayName(String.format("%s generic class cache for %s",dslId,source.getDisplayName())).withInitializer(new ProgressReportingInitializer(progressLoggerFactory,new CompileToCrossBuildCacheAction(remapped,classLoader,operation,verifier,scriptBaseClass),"Compiling script into cache","Compiling " + source.getDisplayName() + " to cross build script cache")).open();
  cache.close();
  final File genericClassesDir=classesDir(cache);
  final File metadataDir=metadataDir(cache);
  remapClasses(genericClassesDir,classesDir(remappedClassesCache),remapped);
  copyMetadata(metadataDir,metadataDir(remappedClassesCache));
}
