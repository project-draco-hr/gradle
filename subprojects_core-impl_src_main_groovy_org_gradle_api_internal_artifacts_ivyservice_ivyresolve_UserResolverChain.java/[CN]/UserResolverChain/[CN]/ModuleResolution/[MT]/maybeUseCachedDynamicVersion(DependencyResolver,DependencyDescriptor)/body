{
  ModuleRevisionId originalId=original.getDependencyRevisionId();
  ModuleResolutionCache.CachedModuleResolution cachedModuleResolution=moduleResolutionCache.getCachedModuleResolution(resolver,originalId);
  if (cachedModuleResolution != null && cachedModuleResolution.isDynamicVersion()) {
    if (cachePolicy.mustRefreshDynamicVersion(cachedModuleResolution.getResolvedModule(),cachedModuleResolution.getAgeMillis())) {
      LOGGER.debug("Resolved revision in dynamic revision cache is expired: will perform fresh resolve of '{}'",originalId);
      return original;
    }
 else {
      LOGGER.debug("Found resolved revision in dynamic revision cache: Using '{}' for '{}'",cachedModuleResolution.getResolvedVersion(),originalId);
      return original.clone(cachedModuleResolution.getResolvedVersion());
    }
  }
  return original;
}
