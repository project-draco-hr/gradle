{
  DuplicatesStrategy strategy=determineStrategy(details);
  if (!visitedFiles.add(details.getRelativePath())) {
    if (strategy == DuplicatesStrategy.EXCLUDE) {
      return;
    }
    if (warnOnIncludeDuplicate) {
      DeprecationLogger.nagUserOfDeprecatedBehaviour(String.format("Including duplicate file %s",details.getRelativePath()));
    }
  }
  super.visitFile(details);
}
