{
  assertOperationStarted();
  assertHierarchyNotEmpty();
  Long last=hierarchy.getLast();
  if (id.getId() == last) {
    hierarchy.removeLast();
  }
 else {
    hierarchy.remove(id.getId());
  }
  long out=id.getId();
  id=null;
  return out;
}
