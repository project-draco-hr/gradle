{
  assertOperationStarted();
  assertHierarchyNotEmpty();
  Long last=hierarchy.getLast();
  OperationIdentifier currentOp=id;
  if (currentOp.getId() == last) {
    hierarchy.removeLast();
  }
 else {
    hierarchy.remove(currentOp.getId());
  }
  id=null;
  return currentOp;
}
