{
  if (!compileOptions.isIncremental()) {
    compile();
    return;
  }
  SingleMessageLogger.incubatingFeatureUsed("Incremental java compilation");
  DefaultJavaCompileSpec spec=createSpec();
  JarSnapshotCache jarSnapshotCache=getServices().get(JarSnapshotCache.class);
  ClassAnalysisCache classAnalysisCache=getServices().get(ClassAnalysisCache.class);
  IncrementalJavaCompilerFactory factory=new IncrementalJavaCompilerFactory(getProject(),getPath(),createCompiler(spec),source,jarSnapshotCache,classAnalysisCache);
  Compiler<JavaCompileSpec> compiler=factory.createCompiler(inputs);
  performCompilation(spec,compiler);
}
