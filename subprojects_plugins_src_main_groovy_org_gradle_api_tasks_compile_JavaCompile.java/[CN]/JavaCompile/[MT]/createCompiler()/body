{
  JavaCompilerFactory inProcessCompilerFactory=new InProcessJavaCompilerFactory();
  ProjectInternal projectInternal=(ProjectInternal)getProject();
  CompilerDaemonFactory compilerDaemonFactory=getServices().get(CompilerDaemonManager.class);
  JavaCompilerFactory defaultCompilerFactory=new DefaultJavaCompilerFactory(projectInternal.getRootProject().getProjectDir(),inProcessCompilerFactory,compilerDaemonFactory);
  DelegatingJavaCompiler javaCompiler=new DelegatingJavaCompiler(defaultCompilerFactory);
  return new CleaningJavaCompiler(javaCompiler,getAntBuilderFactory(),getOutputs());
}
