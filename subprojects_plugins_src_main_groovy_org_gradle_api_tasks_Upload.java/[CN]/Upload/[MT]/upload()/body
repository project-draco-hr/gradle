{
  getLogger().info("Publishing configuration: " + configuration);
  Module module=((ConfigurationInternal)configuration).getModule();
  Set<Configuration> configurationsToPublish=configuration.getHierarchy();
  ArtifactPublisher artifactPublisher=publicationServices.createArtifactPublisher();
  File descriptorDestination=isUploadDescriptor() ? getDescriptorDestination() : null;
  List<PublicationAwareRepository> publishRepositories=collect(repositories,Transformers.cast(PublicationAwareRepository.class));
  try {
    artifactPublisher.publish(publishRepositories,module,configurationsToPublish,descriptorDestination);
  }
 catch (  Exception e) {
    throw new PublishException(String.format("Could not publish configuration '%s'",configuration.getName()),e);
  }
}
