{
  context.checking(new Expectations(){
{
      Rule rule1=context.mock(Rule.class);
      Rule rule2=context.mock(Rule.class);
      List<String> defaultTasks=toList();
      allowing(project).getDefaultTasks();
      will(returnValue(defaultTasks));
      one(taskContainer).getAll();
      will(returnValue(toSet()));
      one(taskContainer).getRules();
      will(returnValue(toList(rule1,rule2)));
      Sequence sequence=context.sequence("seq");
      one(renderer).addDefaultTasks(defaultTasks);
      inSequence(sequence);
      one(renderer).completeTasks();
      inSequence(sequence);
      one(renderer).addRule(rule1);
      inSequence(sequence);
      one(renderer).addRule(rule2);
      inSequence(sequence);
    }
  }
);
  task.generate(project);
}
