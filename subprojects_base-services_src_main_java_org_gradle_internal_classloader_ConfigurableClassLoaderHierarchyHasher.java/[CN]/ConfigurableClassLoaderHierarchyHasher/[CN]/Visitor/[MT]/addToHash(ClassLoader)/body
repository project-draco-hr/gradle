{
  if (alreadyHashedLoaders.contains(cl)) {
    return true;
  }
  byte[] knownId=knownClassLoaders.get(cl);
  if (knownId != null) {
    hasher.putBytes(knownId);
    return true;
  }
  if (cl instanceof CachingClassLoader || cl instanceof MultiParentClassLoader) {
    return true;
  }
  if (cl instanceof HashedClassLoader) {
    hasher.putBytes(((HashedClassLoader)cl).getClassLoaderHash().asBytes());
    alreadyHashedLoaders.add(cl.getParent());
    return true;
  }
  hasher.putBytes(UNKNOWN);
  return false;
}
